import{k as ne,r as v,l as V,m as q,n as Z,p as X,q as oe,s as ee,u as le,v as ae,d as J,w as te,o as Y,c as d,e,x,t as r,y as K,z as A,A as T,B,f as U,C as ie,D as L,E as M,g as n,G as z,H as F,I as de,a as ue,J as Q,K as ce,L as pe,h as ge}from"./index-9zLQUj3m.js";const me=ne("dashboard",()=>{const R=v({events:0,actualities:0,photos:0,messages:0}),h=v({events:0,actualities:0,photos:0,messages:0}),g=v({newsletter:0,financing:0,training:0,publications:0,eventRegistrations:0}),m=v(!1),$=v(null),p=3e4,c=V(()=>{const w=(u,D)=>{if(D===0)return u>0?"+100%":"0%";const E=(u-D)/D*100;return`${E>=0?"+":""}${Math.round(E)}%`};return[{id:"events",label:"√âv√©nements",value:R.value.events.toString(),change:w(R.value.events,h.value.events),icon:"fas fa-calendar-alt",bgColor:"bg-gradient-to-br from-blue-100 to-blue-200",iconColor:"text-blue-600",badgeColor:R.value.events>=h.value.events?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"actualites",label:"Actualit√©s",value:R.value.actualities.toString(),change:w(R.value.actualities,h.value.actualities),icon:"fas fa-newspaper",bgColor:"bg-gradient-to-br from-indigo-100 to-indigo-200",iconColor:"text-indigo-600",badgeColor:R.value.actualities>=h.value.actualities?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"messages",label:"Messages",value:R.value.messages.toString(),change:w(R.value.messages,h.value.messages),icon:"fas fa-envelope",bgColor:"bg-gradient-to-br from-purple-100 to-purple-200",iconColor:"text-purple-600",badgeColor:R.value.messages>=h.value.messages?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"photos",label:"Photos",value:R.value.photos.toString(),change:w(R.value.photos,h.value.photos),icon:"fas fa-images",bgColor:"bg-gradient-to-br from-pink-100 to-pink-200",iconColor:"text-pink-600",badgeColor:R.value.photos>=h.value.photos?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}]}),_=V(()=>[{id:"overview",label:"Vue d'ensemble",icon:"fas fa-home",badge:null},{id:"events",label:"√âv√©nements",icon:"fas fa-calendar-alt",badge:null},{id:"event-registrations",label:"Inscriptions √âv√©nements",icon:"fas fa-user-check",badge:g.value.eventRegistrations>0?g.value.eventRegistrations.toString():null},{id:"actualites",label:"Actualit√©s",icon:"fas fa-newspaper",badge:null},{id:"gallery",label:"Galerie",icon:"fas fa-images",badge:null},{id:"newsletter",label:"Newsletter",icon:"fas fa-envelope",badge:g.value.newsletter>0?g.value.newsletter.toString():null},{id:"financing",label:"Demandes Financement",icon:"fas fa-hand-holding-usd",badge:g.value.financing>0?g.value.financing.toString():null},{id:"training",label:"Inscriptions Formation",icon:"fas fa-user-graduate",badge:g.value.training>0?g.value.training.toString():null},{id:"publications",label:"Demandes Publication",icon:"fas fa-file-alt",badge:g.value.publications>0?g.value.publications.toString():null}]),y=V(()=>$.value?Date.now()-$.value<p:!1),i=async(w=!1)=>{if(!(!w&&y.value&&R.value.events>0)&&!m.value)try{m.value=!0,h.value={...R.value};try{const u=await q.getEvents({limit:1e3});R.value.events=u.pagination?.total||u.data.length}catch(u){console.error("Erreur lors du chargement des √©v√©nements:",u)}try{const u=await Z.getActualities({limit:1e3});R.value.actualities=u.pagination?.total||u.data.length}catch(u){console.error("Erreur lors du chargement des actualit√©s:",u)}try{const u=await X.getPhotos({limit:1e3});R.value.photos=u.pagination?.total||u.data.length}catch(u){console.error("Erreur lors du chargement des photos:",u)}try{const u=await oe.getAllSubscribers({limit:1e3});R.value.messages=u.data.length}catch(u){console.error("Erreur lors du chargement des messages:",u)}$.value=Date.now()}catch(u){console.error("Erreur lors du chargement des stats:",u)}finally{m.value=!1}},f=async(w=!1)=>{if(!(!w&&y.value&&g.value.newsletter>=0))try{try{const u=await oe.getAllSubscribers({status:"active",limit:1e3});g.value.newsletter=u.data.length}catch(u){console.error("Erreur lors du chargement des newsletters:",u)}try{const u=await ee.getRequests({status:"submitted",limit:1e3}),D=await ee.getRequests({status:"under-review",limit:1e3});g.value.financing=u.data.length+D.data.length}catch(u){console.error("Erreur lors du chargement des demandes de financement:",u)}try{const u=await le.getRegistrations({status:"pending",limit:1e3});g.value.training=u.data.length}catch(u){console.error("Erreur lors du chargement des inscriptions aux formations:",u)}try{const u=await ae.getRequests({status:"pending",limit:1e3});g.value.publications=u.data.length}catch(u){console.error("Erreur lors du chargement des demandes de publication:",u)}try{const u=await q.getAllRegistrations({status:"pending",limit:1e3});g.value.eventRegistrations=u.data.length}catch(u){console.error("Erreur lors du chargement des inscriptions aux √©v√©nements:",u)}$.value||($.value=Date.now())}catch(u){console.error("Erreur lors du chargement des compteurs:",u)}};return{stats:R,previousStats:h,notificationCounts:g,isLoading:m,statsWithChange:c,menuItems:_,isCacheValid:y,loadOverviewStats:i,loadNotificationCounts:f,refreshAll:async()=>{await Promise.all([i(!0),f(!0)])},reset:()=>{R.value={events:0,actualities:0,photos:0,messages:0},h.value={events:0,actualities:0,photos:0,messages:0},g.value={newsletter:0,financing:0,training:0,publications:0,eventRegistrations:0},$.value=null}}}),ve={class:"space-y-6"},be={class:"flex items-center justify-between"},xe={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4"},fe={class:"flex items-center gap-2"},ye={key:1,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},he={class:"text-xl font-bold text-gray-900 mb-6"},we={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},$e=["min"],ke={key:0,class:"mt-3"},_e=["src"],Ce={key:1,class:"mt-3"},De=["src"],Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ae=["min"],Re={class:"flex items-center gap-3 mt-2"},je={class:"flex items-center gap-2 cursor-pointer"},Te={class:"flex gap-4"},Se=["disabled"],Pe={key:0,class:"fas fa-spinner fa-spin"},Ne=["disabled"],Fe={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Ve={key:0,class:"p-12 text-center"},Ie={key:1,class:"overflow-x-auto"},ze={class:"w-full"},Le={class:"divide-y divide-gray-200"},Me={class:"px-6 py-4"},Ue={class:"font-medium text-gray-900"},Ge={class:"text-sm text-gray-500 mt-1"},qe={class:"px-6 py-4 text-gray-600"},Oe={class:"text-xs text-gray-500"},Be={class:"px-6 py-4"},Je={class:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-700"},Ye={class:"px-6 py-4 text-gray-600"},He={class:"px-6 py-4"},We={class:"flex items-center justify-center gap-2"},Qe=["onClick","disabled"],Ke=["onClick","disabled"],Xe={key:0},Ze=J({__name:"DashboardEvents",setup(R){const h=te.useToast(),g=v(!1),m=v(null),$=v([]),p=v(!1),c=v(null),_=v(null),y=v(null),i=v({title:"",startDate:"",startTime:"",location:"",description:"",image:"",type:"conference",registrationRequired:!1,endDate:"",endTime:"",address:"",content:""}),f=async()=>{p.value=!0,c.value=null;try{console.log("üîÑ Chargement des √©v√©nements...");const t=await q.getEvents();console.log("‚úÖ R√©ponse re√ßue:",t),t&&t.data?(console.log(`üìä ${t.data.length} √©v√©nement(s) charg√©(s)`),$.value=t.data):(console.warn("‚ö†Ô∏è Aucune donn√©e dans la r√©ponse:",t),$.value=[],c.value="Aucune donn√©e re√ßue du serveur")}catch(t){console.error("‚ùå Erreur compl√®te lors du chargement:",t),console.error("D√©tails:",{message:t.message,status:t.status,errors:t.errors,stack:t.stack}),t.status===500?c.value="Erreur serveur. V√©rifiez que le backend est d√©marr√© et que la base de donn√©es est accessible.":t.status===404?c.value="Endpoint non trouv√©. V√©rifiez la configuration de l'API.":t.status===0||t.message?.includes("fetch")||t.message?.includes("Failed to fetch")?c.value="Impossible de se connecter au serveur. V√©rifiez que le backend est accessible.":c.value=t.message||(t.errors?JSON.stringify(t.errors):"Erreur lors du chargement des √©v√©nements"),$.value=[]}finally{p.value=!1}},P=t=>{const s=t.target;if(s&&s.files&&s.files[0]){_.value=s.files[0];const l=new FileReader;l.onload=o=>{y.value=o.target?.result},l.readAsDataURL(_.value)}},j=async()=>{p.value=!0,c.value=null;try{const t=i.value.startDate?.trim()||"",s=i.value.startTime?.trim()||"";if(!t){c.value="Veuillez entrer une date de d√©but",p.value=!1;return}if(!D(t)){c.value="Veuillez entrer une date de d√©but valide (format YYYY-MM-DD)",p.value=!1;return}if(!s){c.value="Veuillez entrer une heure de d√©but",p.value=!1;return}if(!E(s)){c.value="Veuillez entrer une heure de d√©but valide (format HH:MM)",p.value=!1;return}if(i.value.endDate&&i.value.endDate.trim()!==""){if(!D(i.value.endDate)){c.value="Veuillez entrer une date de fin valide",p.value=!1;return}const I=new Date(i.value.startDate);if(new Date(i.value.endDate)<I){c.value="La date de fin doit √™tre post√©rieure √† la date de d√©but",p.value=!1;return}}if(i.value.endTime&&i.value.endTime.trim()!==""){if(!E(i.value.endTime)){c.value="Veuillez entrer une heure de fin valide (format HH:MM)",p.value=!1;return}if(i.value.endDate===i.value.startDate){const I=i.value.startTime.split(":").map(Number),N=i.value.endTime.split(":").map(Number),H=I[0]*60+I[1];if(N[0]*60+N[1]<=H){c.value="L'heure de fin doit √™tre post√©rieure √† l'heure de d√©but",p.value=!1;return}}}const l=w(t),o=u(s),k={title:i.value.title.trim(),description:i.value.description.trim(),type:i.value.type,status:"upcoming",startDate:l,startTime:o,location:i.value.location.trim(),registrationRequired:i.value.registrationRequired,image:i.value.image||""};i.value.content&&i.value.content.trim()!==""&&(k.content=i.value.content.trim()),i.value.endDate&&i.value.endDate.trim()!==""&&(k.endDate=w(i.value.endDate)),i.value.endTime&&i.value.endTime.trim()!==""&&(k.endTime=u(i.value.endTime)),i.value.address&&i.value.address.trim()!==""&&(k.address=i.value.address.trim()),m.value?(await q.updateEvent(m.value.id,k,_.value||void 0),h.open({message:"‚úÖ √âv√©nement modifi√© avec succ√®s !",type:"success",position:"top-right",duration:5e3})):(await q.createEvent(k,_.value||void 0),h.open({message:"‚úÖ √âv√©nement cr√©√© et publi√© avec succ√®s !",type:"success",position:"top-right",duration:5e3})),await f(),b(),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(t){console.error("Erreur compl√®te:",t);let s="Erreur lors de la sauvegarde de l'√©v√©nement. V√©rifiez la console pour plus de d√©tails.";t.errors?(s=`Erreurs de validation: ${Object.values(t.errors).flat().join(", ")}`,c.value=s):t.message?(s=t.message,c.value=t.message):c.value=s,h.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{p.value=!1}},w=t=>{if(!t||typeof t!="string")return"";const s=t.trim();if(!s)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(s))return s;const l=new Date(s);if(isNaN(l.getTime())){const N=s.split("-");if(N.length===3){const H=parseInt(N[0],10),G=parseInt(N[1],10),O=parseInt(N[2],10);if(!isNaN(H)&&!isNaN(G)&&!isNaN(O)){const W=new Date(H,G-1,O);if(W.getFullYear()===H&&W.getMonth()===G-1&&W.getDate()===O)return`${H}-${String(G).padStart(2,"0")}-${String(O).padStart(2,"0")}`}}return""}const o=l.getFullYear(),k=String(l.getMonth()+1).padStart(2,"0"),I=String(l.getDate()).padStart(2,"0");return`${o}-${k}-${I}`}catch(l){return console.warn("Erreur lors de la normalisation de la date:",t,l),""}},u=t=>{if(!t||typeof t!="string")return"";const s=t.trim();if(!s)return"";try{if(/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(s)||/^([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/.test(s))return s.substring(0,5);const l=new Date(s);if(!isNaN(l.getTime())){const o=String(l.getHours()).padStart(2,"0"),k=String(l.getMinutes()).padStart(2,"0");return`${o}:${k}`}return""}catch(l){return console.warn("Erreur lors de la normalisation de l'heure:",t,l),""}},D=t=>{if(!t||typeof t!="string")return!1;const s=t.trim();if(!s)return!1;if(/^\d{4}-\d{2}-\d{2}$/.test(s)){const o=new Date(s);return!isNaN(o.getTime())}const l=new Date(s);return!isNaN(l.getTime())},E=t=>{if(!t||typeof t!="string")return!1;const s=t.trim();return s?/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(s):!1},S=t=>{try{m.value=t,i.value={title:t.title||"",startDate:w(t.startDate),startTime:u(t.startTime),location:t.location||"",description:t.description||"",image:t.image||"",type:t.type||"conference",registrationRequired:t.registrationRequired||!1,endDate:w(t.endDate),endTime:u(t.endTime),address:t.address||"",content:t.content||""},_.value=null,y.value=t.image||null,g.value=!0}catch(s){console.error("Erreur lors de l'√©dition de l'√©v√©nement:",s),c.value="Erreur lors du chargement des donn√©es de l'√©v√©nement"}},C=async t=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cet √©v√©nement ?")){p.value=!0,c.value=null;try{await q.deleteEvent(t),await f(),h.open({message:"‚úÖ √âv√©nement supprim√© avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(s){const l=s.message||"Erreur lors de la suppression de l'√©v√©nement";c.value=l,console.error("Erreur:",s),h.open({message:`‚ùå ${l}`,type:"error",position:"top-right",duration:6e3})}finally{p.value=!1}}},b=()=>{g.value=!1,m.value=null,_.value=null,y.value=null,i.value={title:"",startDate:"",startTime:"",location:"",description:"",image:"",type:"conference",registrationRequired:!1,endDate:"",endTime:"",address:"",content:""}},a=t=>t?new Date(t).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A";return Y(()=>{f()}),(t,s)=>(n(),d("div",ve,[e("div",be,[s[18]||(s[18]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion des √âv√©nements"),e("p",{class:"text-gray-600 mt-1"},"Cr√©ez et g√©rez les √©v√©nements du centre")],-1)),e("button",{onClick:s[0]||(s[0]=l=>{g.value=!0,m.value=null}),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...s[17]||(s[17]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nouvel √©v√©nement",-1)])])]),c.value?(n(),d("div",xe,[e("div",fe,[s[19]||(s[19]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(c.value),1)]),c.value.includes("serveur")||c.value.includes("connecter")?(n(),d("button",{key:0,onClick:f,class:"mt-3 text-sm text-red-600 hover:text-red-800 underline"}," R√©essayer ")):x("",!0)])):x("",!0),g.value?(n(),d("div",ye,[e("h3",he,r(m.value?"Modifier l'√©v√©nement":"Nouvel √©v√©nement"),1),e("form",{onSubmit:K(j,["prevent"]),class:"space-y-6",novalidate:""},[e("div",we,[e("div",null,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),A(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>i.value.title=l),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de l'√©v√©nement"},null,512),[[T,i.value.title]])]),e("div",null,[s[21]||(s[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de d√©but *",-1)),A(e("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>i.value.startDate=l),type:"date",required:"",min:new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[3]||(s[3]=l=>i.value.startDate=l.target.value)},null,40,$e),[[T,i.value.startDate]])]),e("div",null,[s[22]||(s[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Heure de d√©but *",-1)),A(e("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>i.value.startTime=l),type:"time",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[5]||(s[5]=l=>i.value.startTime=l.target.value)},null,544),[[T,i.value.startTime]])]),e("div",null,[s[24]||(s[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type *",-1)),A(e("select",{"onUpdate:modelValue":s[6]||(s[6]=l=>i.value.type=l),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...s[23]||(s[23]=[U('<option value="conference">Conf√©rence</option><option value="workshop">Atelier</option><option value="seminar">S√©minaire</option><option value="webinar">Webinaire</option><option value="other">Autre</option>',5)])],512),[[B,i.value.type]])]),e("div",null,[s[25]||(s[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Lieu *",-1)),A(e("input",{"onUpdate:modelValue":s[7]||(s[7]=l=>i.value.location=l),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Lieu de l'√©v√©nement"},null,512),[[T,i.value.location]])]),e("div",null,[s[27]||(s[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image",-1)),e("input",{onChange:s[8]||(s[8]=l=>P(l)),type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),s[28]||(s[28]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),y.value?(n(),d("div",ke,[e("img",{src:y.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,_e)])):m.value&&i.value.image?(n(),d("div",Ce,[e("img",{src:i.value.image,alt:"Image actuelle",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,De),s[26]||(s[26]=e("p",{class:"text-xs text-gray-500 mt-1"},"Image actuelle",-1))])):x("",!0)])]),e("div",null,[s[29]||(s[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description *",-1)),A(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=l=>i.value.description=l),required:"",rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Description de l'√©v√©nement..."},null,512),[[T,i.value.description]])]),e("div",null,[s[30]||(s[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contenu d√©taill√©",-1)),A(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=l=>i.value.content=l),rows:"6",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Contenu d√©taill√© de l'√©v√©nement..."},null,512),[[T,i.value.content]])]),e("div",Ee,[e("div",null,[s[31]||(s[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de fin",-1)),A(e("input",{"onUpdate:modelValue":s[11]||(s[11]=l=>i.value.endDate=l),type:"date",min:i.value.startDate||new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[12]||(s[12]=l=>i.value.endDate=l.target.value)},null,40,Ae),[[T,i.value.endDate]])]),e("div",null,[s[32]||(s[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Heure de fin",-1)),A(e("input",{"onUpdate:modelValue":s[13]||(s[13]=l=>i.value.endTime=l),type:"time",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[14]||(s[14]=l=>i.value.endTime=l.target.value)},null,544),[[T,i.value.endTime]])]),e("div",null,[s[33]||(s[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse compl√®te",-1)),A(e("input",{"onUpdate:modelValue":s[15]||(s[15]=l=>i.value.address=l),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Adresse compl√®te..."},null,512),[[T,i.value.address]])]),e("div",null,[s[35]||(s[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Inscription requise",-1)),e("div",Re,[e("label",je,[A(e("input",{"onUpdate:modelValue":s[16]||(s[16]=l=>i.value.registrationRequired=l),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[ie,i.value.registrationRequired]]),s[34]||(s[34]=e("span",{class:"text-sm text-gray-700"},"Oui",-1))])])])]),e("div",Te,[e("button",{type:"submit",disabled:p.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[p.value?(n(),d("i",Pe)):x("",!0),e("span",null,r(p.value?"Enregistrement...":m.value?"Modifier":"Cr√©er"),1)],8,Se),e("button",{type:"button",onClick:b,disabled:p.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,Ne)])],32)])):x("",!0),e("div",Fe,[p.value&&$.value.length===0?(n(),d("div",Ve,[...s[36]||(s[36]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des √©v√©nements...",-1)])])):(n(),d("div",Ie,[e("table",ze,[s[40]||(s[40]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Titre"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Type"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Lieu"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Le,[(n(!0),d(L,null,M($.value,l=>(n(),d("tr",{key:l.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Me,[e("div",Ue,r(l.title),1),e("div",Ge,r(l.description?.substring(0,50))+"...",1)]),e("td",qe,[e("div",null,r(a(l.startDate)),1),e("div",Oe,r(l.startTime),1)]),e("td",Be,[e("span",Je,r(l.type),1)]),e("td",Ye,r(l.location),1),e("td",He,[e("div",We,[e("button",{onClick:o=>S(l),disabled:p.value,class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50",title:"Modifier"},[...s[37]||(s[37]=[e("i",{class:"fas fa-edit"},null,-1)])],8,Qe),e("button",{onClick:o=>C(l.id),disabled:p.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...s[38]||(s[38]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Ke)])])]))),128)),$.value.length===0&&!p.value?(n(),d("tr",Xe,[...s[39]||(s[39]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"},[e("i",{class:"fas fa-calendar-times text-4xl mb-3 text-gray-300"}),e("p",null,"Aucun √©v√©nement pour le moment")],-1)])])):x("",!0)])])]))])]))}}),et={class:"space-y-6"},tt={class:"bg-gradient-to-r from-blue-600 via-indigo-600 to-blue-700 rounded-2xl shadow-xl overflow-hidden"},st={class:"p-4 sm:p-6 lg:p-8"},lt={class:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 lg:gap-6"},at={class:"flex items-center gap-2 sm:gap-4 flex-shrink-0"},ot={class:"bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 sm:px-4 border border-white/20"},rt={class:"text-xl sm:text-2xl font-bold text-white"},nt={class:"bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 sm:px-4 border border-white/20"},it={class:"text-xl sm:text-2xl font-bold text-yellow-300"},dt={class:"mt-4 sm:mt-6 flex flex-col sm:flex-row items-stretch sm:items-end gap-3"},ut={class:"flex-1 min-w-0"},ct={class:"relative"},pt=["value"],gt={class:"flex-1 min-w-0 sm:max-w-[200px]"},mt={class:"relative"},vt={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},bt={class:"flex items-center gap-2"},xt={key:1,class:"text-center py-12"},ft={key:2,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},yt={class:"overflow-x-auto"},ht={class:"w-full min-w-[800px]"},wt={class:"bg-white divide-y divide-gray-100"},$t={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},kt={class:"flex items-center gap-2 sm:gap-3 min-w-0"},_t={class:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold text-xs sm:text-sm shadow-md flex-shrink-0"},Ct={class:"min-w-0 flex-1"},Dt={class:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate text-sm sm:text-base"},Et={key:0,class:"text-xs text-gray-500 mt-0.5 truncate"},At={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 min-w-0"},Rt={class:"space-y-1"},jt={class:"flex items-center gap-1.5 sm:gap-2 text-gray-700 min-w-0"},Tt={class:"text-xs sm:text-sm truncate"},St={key:0,class:"flex items-center gap-1.5 sm:gap-2 text-gray-600"},Pt={class:"text-xs truncate"},Nt={key:1,class:"text-xs text-gray-400"},Ft={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 hidden md:table-cell min-w-0"},Vt={class:"flex items-center gap-1.5 sm:gap-2 min-w-0"},It={class:"text-xs sm:text-sm text-gray-700 truncate"},zt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 min-w-0"},Lt=["onMouseenter"],Mt={class:"inline-flex items-center gap-1.5 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 bg-blue-50 rounded-lg border border-blue-200 max-w-full cursor-help"},Ut={class:"text-xs sm:text-sm font-medium text-blue-700 truncate"},Gt={key:0,class:"absolute z-[100] bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-xl whitespace-normal max-w-xs text-center pointer-events-none",style:{"min-width":"150px"}},qt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Ot={class:"flex justify-center"},Bt={class:"hidden sm:inline"},Jt={class:"sm:hidden"},Yt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 hidden lg:table-cell"},Ht={class:"flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-600 whitespace-nowrap"},Wt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Qt={class:"flex items-center justify-center gap-1 sm:gap-1.5 flex-wrap"},Kt=["onClick","disabled"],Xt=["onClick","disabled"],Zt=["onClick"],es=["onClick","disabled"],ts={key:0},ss={class:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},ls={class:"p-6 border-b border-gray-200"},as={class:"flex items-center justify-between"},os={class:"p-6 space-y-4"},rs={class:"text-gray-900 font-semibold"},ns={class:"text-gray-900"},is={key:0},ds={class:"text-gray-900"},us={key:1},cs={class:"text-gray-900"},ps={key:2},gs={class:"text-gray-900"},ms={class:"text-gray-900"},vs={key:3},bs={class:"text-gray-900"},xs={class:"text-gray-900"},fs=J({__name:"DashboardEventRegistrations",setup(R){const h=te.useToast(),g=v([]),m=v([]),$=v(!1),p=v(!1),c=v(null),_=v(""),y=v(""),i=v(null),f=v(null),P=V(()=>g.value.filter(a=>a.status==="pending").length),j=async()=>{try{const a=await q.getEvents({limit:100});m.value=a.data}catch(a){console.error("Erreur lors du chargement des √©v√©nements:",a)}},w=async()=>{$.value=!0,c.value=null;try{const a=await q.getAllRegistrations({eventId:_.value||void 0,status:y.value||void 0,limit:100});g.value=a.data}catch(a){console.error("Erreur lors du chargement des inscriptions:",a),c.value=a.message||"Erreur lors du chargement des inscriptions",g.value=[]}finally{$.value=!1}},u=a=>a?m.value.find(s=>s.id==a)?.title||`√âv√©nement #${a}`:"N/A",D=(a,t)=>a?a.length<=t?a:a.substring(0,t)+"...":"-",E=async(a,t)=>{if(confirm(`√ätes-vous s√ªr de vouloir ${t==="confirmed"?"confirmer":"annuler"} cette inscription ?`)){p.value=!0,c.value=null;try{await q.updateRegistrationStatus(a,t),await w();const s={confirmed:"confirm√©e",cancelled:"annul√©e",pending:"mise en attente"};h.open({message:`‚úÖ Inscription ${s[t]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(s){console.error("Erreur lors de la mise √† jour:",s);const l=s.message||"Erreur lors de la mise √† jour";c.value=l,h.open({message:`‚ùå ${l}`,type:"error",position:"top-right",duration:6e3})}finally{p.value=!1}}},S=async a=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette inscription ?")){p.value=!0,c.value=null;try{await q.deleteRegistration(a),await w(),h.open({message:"‚úÖ Inscription supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t);const s=t.message||"Erreur lors de la suppression";c.value=s,h.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{p.value=!1}}},C=a=>{i.value=a},b=a=>{if(!a)return"-";try{const t=new Date(a);return isNaN(t.getTime())?a:t.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return a}};return Y(async()=>{await j(),await w()}),(a,t)=>(n(),d("div",et,[e("div",tt,[e("div",st,[e("div",lt,[t[7]||(t[7]=U('<div class="flex items-center gap-3 sm:gap-4 min-w-0 flex-1"><div class="w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg flex-shrink-0"><i class="fas fa-user-check text-white text-xl sm:text-2xl"></i></div><div class="min-w-0 flex-1"><h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-white mb-1 truncate">Inscriptions aux √âv√©nements</h2><p class="text-blue-100 text-xs sm:text-sm font-medium truncate">G√©rez et suivez toutes les inscriptions</p></div></div>',1)),e("div",at,[e("div",ot,[t[5]||(t[5]=e("div",{class:"text-xs text-blue-100 font-medium mb-0.5"},"Total",-1)),e("div",rt,r(g.value.length),1)]),e("div",nt,[t[6]||(t[6]=e("div",{class:"text-xs text-blue-100 font-medium mb-0.5"},"En attente",-1)),e("div",it,r(P.value),1)])])]),e("div",dt,[e("div",ut,[t[10]||(t[10]=e("label",{class:"block text-xs font-semibold text-blue-100 mb-2"},"Filtrer par √©v√©nement",-1)),e("div",ct,[t[9]||(t[9]=e("i",{class:"fas fa-calendar-alt absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-200 text-sm z-10"},null,-1)),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),onChange:w,class:"w-full pl-10 pr-4 py-2.5 bg-white/90 backdrop-blur-sm border border-white/30 rounded-xl text-gray-900 font-medium text-sm focus:ring-2 focus:ring-white/50 focus:border-white transition-all shadow-sm appearance-none"},[t[8]||(t[8]=e("option",{value:""},"Tous les √©v√©nements",-1)),(n(!0),d(L,null,M(m.value,s=>(n(),d("option",{key:s.id,value:s.id},r(D(s.title,30)),9,pt))),128))],544),[[B,_.value]])])]),e("div",gt,[t[13]||(t[13]=e("label",{class:"block text-xs font-semibold text-blue-100 mb-2"},"Filtrer par statut",-1)),e("div",mt,[t[12]||(t[12]=e("i",{class:"fas fa-filter absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-200 text-sm z-10"},null,-1)),A(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),onChange:w,class:"w-full pl-10 pr-4 py-2.5 bg-white/90 backdrop-blur-sm border border-white/30 rounded-xl text-gray-900 font-medium text-sm focus:ring-2 focus:ring-white/50 focus:border-white transition-all shadow-sm appearance-none"},[...t[11]||(t[11]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"pending"},"En attente",-1),e("option",{value:"confirmed"},"Confirm√©",-1),e("option",{value:"cancelled"},"Annul√©",-1)])],544),[[B,y.value]])])])])])]),c.value?(n(),d("div",vt,[e("div",bt,[t[14]||(t[14]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(c.value),1)])])):x("",!0),$.value?(n(),d("div",xt,[...t[15]||(t[15]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des inscriptions...",-1)])])):(n(),d("div",ft,[e("div",yt,[e("table",ht,[t[27]||(t[27]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-indigo-600"},[e("tr",null,[e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-user text-xs sm:text-sm"}),e("span",{class:"hidden sm:inline"},"Participant"),e("span",{class:"sm:hidden"},"Part.")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-envelope text-xs sm:text-sm"}),e("span",null,"Contact")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap hidden md:table-cell"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-building text-xs sm:text-sm"}),e("span",null,"Organisation")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-calendar-alt text-xs sm:text-sm"}),e("span",{class:"hidden lg:inline"},"√âv√©nement"),e("span",{class:"lg:hidden"},"√âv√©n.")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center justify-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-info-circle text-xs sm:text-sm"}),e("span",null,"Statut")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap hidden lg:table-cell"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-clock text-xs sm:text-sm"}),e("span",null,"Date")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center justify-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-cog text-xs sm:text-sm"}),e("span",{class:"hidden sm:inline"},"Actions")])])])],-1)),e("tbody",wt,[(n(!0),d(L,null,M(g.value,(s,l)=>(n(),d("tr",{key:s.id,class:z(["hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 transition-all duration-200 group",{"bg-gray-50/50":l%2===1}])},[e("td",$t,[e("div",kt,[e("div",_t,r((s.firstName?.[0]||"")+(s.lastName?.[0]||"")),1),e("div",Ct,[e("div",Dt,r(s.firstName)+" "+r(s.lastName),1),s.position?(n(),d("div",Et,r(s.position),1)):x("",!0)])])]),e("td",At,[e("div",Rt,[e("div",jt,[t[16]||(t[16]=e("i",{class:"fas fa-envelope text-xs text-gray-400 flex-shrink-0"},null,-1)),e("span",Tt,r(s.email),1)]),s.phone?(n(),d("div",St,[t[17]||(t[17]=e("i",{class:"fas fa-phone text-xs text-gray-400 flex-shrink-0"},null,-1)),e("span",Pt,r(s.phone),1)])):(n(),d("div",Nt,"-"))])]),e("td",Ft,[e("div",Vt,[t[18]||(t[18]=e("i",{class:"fas fa-building text-gray-400 text-xs sm:text-sm flex-shrink-0"},null,-1)),e("span",It,r(s.organization||"-"),1)])]),e("td",zt,[e("div",{class:"relative inline-block",onMouseenter:o=>f.value=s.eventId,onMouseleave:t[2]||(t[2]=o=>f.value=null)},[e("div",Mt,[t[19]||(t[19]=e("i",{class:"fas fa-calendar-alt text-blue-600 text-xs flex-shrink-0"},null,-1)),e("span",Ut,r(D(u(s.eventId),16)),1)]),f.value===s.eventId&&u(s.eventId).length>16?(n(),d("div",Gt,[F(r(u(s.eventId))+" ",1),t[20]||(t[20]=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1"},[e("div",{class:"border-4 border-transparent border-t-gray-900"})],-1))])):x("",!0)],40,Lt)]),e("td",qt,[e("div",Ot,[e("span",{class:z(["px-2 sm:px-3 py-1 sm:py-1.5 rounded-full text-xs font-bold shadow-sm inline-flex items-center gap-1 sm:gap-1.5 whitespace-nowrap",s.status==="confirmed"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":s.status==="cancelled"?"bg-gradient-to-r from-red-500 to-rose-500 text-white":"bg-gradient-to-r from-yellow-400 to-amber-500 text-white"])},[e("i",{class:z(["fas text-xs flex-shrink-0",s.status==="confirmed"?"fa-check-circle":s.status==="cancelled"?"fa-times-circle":"fa-clock"])},null,2),e("span",Bt,r(s.status==="confirmed"?"Confirm√©":s.status==="cancelled"?"Annul√©":"En attente"),1),e("span",Jt,r(s.status==="confirmed"?"OK":s.status==="cancelled"?"Ann.":"Att."),1)],2)])]),e("td",Yt,[e("div",Ht,[t[21]||(t[21]=e("i",{class:"fas fa-clock text-gray-400 text-xs flex-shrink-0"},null,-1)),e("span",null,r(b(s.createdAt)),1)])]),e("td",Wt,[e("div",Qt,[s.status!=="confirmed"?(n(),d("button",{key:0,onClick:o=>E(s.id,"confirmed"),disabled:p.value,class:"p-2 sm:p-2.5 text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Confirmer"},[...t[22]||(t[22]=[e("i",{class:"fas fa-check text-xs sm:text-sm"},null,-1)])],8,Kt)):x("",!0),s.status!=="cancelled"?(n(),d("button",{key:1,onClick:o=>E(s.id,"cancelled"),disabled:p.value,class:"p-2 sm:p-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Annuler"},[...t[23]||(t[23]=[e("i",{class:"fas fa-times text-xs sm:text-sm"},null,-1)])],8,Xt)):x("",!0),e("button",{onClick:o=>C(s),class:"p-2 sm:p-2.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-110 hover:shadow-md",title:"Voir les d√©tails"},[...t[24]||(t[24]=[e("i",{class:"fas fa-eye text-xs sm:text-sm"},null,-1)])],8,Zt),e("button",{onClick:o=>S(s.id),disabled:p.value,class:"p-2 sm:p-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Supprimer"},[...t[25]||(t[25]=[e("i",{class:"fas fa-trash text-xs sm:text-sm"},null,-1)])],8,es)])])],2))),128)),g.value.length===0?(n(),d("tr",ts,[...t[26]||(t[26]=[e("td",{colspan:"7",class:"px-6 py-16 text-center"},[e("div",{class:"flex flex-col items-center gap-3"},[e("div",{class:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center"},[e("i",{class:"fas fa-inbox text-2xl text-gray-400"})]),e("p",{class:"text-gray-500 font-medium"},"Aucune inscription trouv√©e"),e("p",{class:"text-sm text-gray-400"},"Les inscriptions appara√Ætront ici")])],-1)])])):x("",!0)])])])])),i.value?(n(),d("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[4]||(t[4]=K(s=>i.value=null,["self"]))},[e("div",ss,[e("div",ls,[e("div",as,[t[29]||(t[29]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de l'inscription",-1)),e("button",{onClick:t[3]||(t[3]=s=>i.value=null),class:"p-2 text-gray-400 hover:text-gray-600 rounded-lg transition-colors"},[...t[28]||(t[28]=[e("i",{class:"fas fa-times"},null,-1)])])])]),e("div",os,[e("div",null,[t[30]||(t[30]=e("label",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("p",rs,r(i.value.firstName)+" "+r(i.value.lastName),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("p",ns,r(i.value.email),1)]),i.value.phone?(n(),d("div",is,[t[32]||(t[32]=e("label",{class:"text-sm font-medium text-gray-600"},"T√©l√©phone",-1)),e("p",ds,r(i.value.phone),1)])):x("",!0),i.value.organization?(n(),d("div",us,[t[33]||(t[33]=e("label",{class:"text-sm font-medium text-gray-600"},"Organisation",-1)),e("p",cs,r(i.value.organization),1)])):x("",!0),i.value.position?(n(),d("div",ps,[t[34]||(t[34]=e("label",{class:"text-sm font-medium text-gray-600"},"Poste",-1)),e("p",gs,r(i.value.position),1)])):x("",!0),e("div",null,[t[35]||(t[35]=e("label",{class:"text-sm font-medium text-gray-600"},"√âv√©nement",-1)),e("p",ms,r(u(i.value.eventId)),1)]),e("div",null,[t[36]||(t[36]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("span",{class:z(["inline-block px-3 py-1 rounded-full text-xs font-semibold",i.value.status==="confirmed"?"bg-green-100 text-green-800":i.value.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},r(i.value.status==="confirmed"?"Confirm√©":i.value.status==="cancelled"?"Annul√©":"En attente"),3)]),i.value.notes?(n(),d("div",vs,[t[37]||(t[37]=e("label",{class:"text-sm font-medium text-gray-600"},"Notes",-1)),e("p",bs,r(i.value.notes),1)])):x("",!0),e("div",null,[t[38]||(t[38]=e("label",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("p",xs,r(b(i.value.createdAt)),1)])])])])):x("",!0)]))}}),ys={class:"space-y-6"},hs={class:"flex items-center justify-between"},ws={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4"},$s={class:"flex items-center gap-2"},ks={key:1,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},_s={class:"text-xl font-bold text-gray-900 mb-6"},Cs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ds={key:0,class:"mt-3"},Es=["src"],As={key:1,class:"mt-3"},Rs=["src"],js={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ts={key:0,class:"mt-3"},Ss=["src"],Ps={key:1,class:"mt-3"},Ns=["src"],Fs={class:"flex gap-4"},Vs=["disabled"],Is={key:0},zs={key:1},Ls=["disabled"],Ms={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Us={class:"overflow-x-auto"},Gs={class:"w-full"},qs={class:"divide-y divide-gray-200"},Os={key:0},Bs={class:"px-6 py-4"},Js={class:"font-medium text-gray-900"},Ys={class:"px-6 py-4"},Hs={class:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium"},Ws={class:"px-6 py-4 text-gray-600"},Qs={class:"px-6 py-4"},Ks={class:"flex items-center justify-center gap-2"},Xs=["onClick","disabled"],Zs=["onClick","disabled"],el={key:1},tl=J({__name:"DashboardActualites",setup(R){const h=v(!1),g=v(null),m=v([]),$=v(null),p=v(null),c=v(null),_=v(null),y=v(!1),i=v(null),f=v({title:"",category:"",publishDate:"",summary:"",content:"",image:"",author:"Admin",authorPhoto:"",readTime:5}),P=v(""),j=v(""),w=v(""),u=l=>{const o=l.target;if(o.files&&o.files[0]){$.value=o.files[0];const k=new FileReader;k.onload=I=>{p.value=I.target?.result},k.readAsDataURL($.value)}},D=l=>{const o=l.target;if(o.files&&o.files[0]){c.value=o.files[0];const k=new FileReader;k.onload=I=>{_.value=I.target?.result},k.readAsDataURL(c.value)}},E=async()=>{y.value=!0,i.value=null;try{console.log("üîÑ Chargement des actualit√©s...");const l=await Z.getActualities({limit:100});console.log("‚úÖ R√©ponse re√ßue:",l),l&&l.data?(console.log(`üìä ${l.data.length} actualit√©(s) charg√©e(s)`),m.value=l.data):(console.warn("‚ö†Ô∏è Aucune donn√©e dans la r√©ponse:",l),m.value=[],i.value="Aucune donn√©e re√ßue du serveur")}catch(l){console.error("‚ùå Erreur compl√®te lors du chargement:",l),console.error("D√©tails:",{message:l.message,status:l.status,errors:l.errors,stack:l.stack}),l.status===500?i.value="Erreur serveur. V√©rifiez que le backend est d√©marr√© et que la base de donn√©es est accessible.":l.status===404?i.value="Endpoint non trouv√©. V√©rifiez la configuration de l'API.":l.status===0||l.message?.includes("fetch")||l.message?.includes("Failed to fetch")?i.value="Impossible de se connecter au serveur. V√©rifiez que le backend est accessible.":i.value=l.message||(l.errors?JSON.stringify(l.errors):"Erreur lors du chargement des actualit√©s"),m.value=[]}finally{y.value=!1}},S=async()=>{y.value=!0,i.value=null;try{const l=P.value.split(`
`).map(N=>N.trim()).filter(N=>N.length>0),o=j.value.split(`
`).map(N=>N.trim()).filter(N=>N.length>0),k=w.value.split(",").map(N=>N.trim()).filter(N=>N.length>0),I={title:f.value.title.trim(),summary:f.value.summary.trim(),content:f.value.content.trim(),category:f.value.category.trim(),publishDate:f.value.publishDate,author:f.value.author.trim(),readTime:f.value.readTime,status:"published",learningPoints:l,keyPoints:o,tags:k};g.value?await Z.updateActuality(g.value.id,I,$.value||void 0,c.value||void 0):await Z.createActuality(I,$.value||void 0,c.value||void 0),await E(),t()}catch(l){if(console.error("Erreur lors de la sauvegarde:",l),i.value=l.message||"Erreur lors de la sauvegarde",l.errors){const o=Object.values(l.errors).flat().join(", ");i.value=`Erreurs de validation: ${o}`}}finally{y.value=!1}},C=l=>{if(!l||typeof l!="string")return"";const o=l.trim();if(!o)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(o))return o;const k=new Date(o);if(isNaN(k.getTime())){const G=o.split("-");if(G.length===3){const O=parseInt(G[0],10),W=parseInt(G[1],10),se=parseInt(G[2],10);if(!isNaN(O)&&!isNaN(W)&&!isNaN(se)){const re=new Date(O,W-1,se);if(re.getFullYear()===O&&re.getMonth()===W-1&&re.getDate()===se)return`${O}-${String(W).padStart(2,"0")}-${String(se).padStart(2,"0")}`}}return""}const I=k.getFullYear(),N=String(k.getMonth()+1).padStart(2,"0"),H=String(k.getDate()).padStart(2,"0");return`${I}-${N}-${H}`}catch(k){return console.warn("Erreur lors de la normalisation de la date:",l,k),""}},b=l=>{try{g.value=l,f.value={title:l.title||"",category:l.category||"",publishDate:C(l.publishDate),summary:l.summary||"",content:l.content||"",image:l.image||"",author:l.author||"Admin",authorPhoto:l.authorPhoto||"",readTime:l.readTime||5},P.value=l.learningPoints?l.learningPoints.join(`
`):"",j.value=l.keyPoints?l.keyPoints.join(`
`):"",w.value=l.tags?l.tags.join(", "):"",$.value=null,p.value=l.image||null,c.value=null,_.value=l.authorPhoto||null,h.value=!0}catch(o){console.error("Erreur lors de l'√©dition de l'actualit√©:",o),i.value="Erreur lors du chargement des donn√©es de l'actualit√©"}},a=async l=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette actualit√© ?")){y.value=!0,i.value=null;try{await Z.deleteActuality(l),await E()}catch(o){console.error("Erreur lors de la suppression:",o),i.value=o.message||"Erreur lors de la suppression"}finally{y.value=!1}}},t=()=>{h.value=!1,g.value=null,$.value=null,p.value=null,c.value=null,_.value=null,P.value="",j.value="",w.value="",f.value={title:"",category:"",publishDate:"",summary:"",content:"",image:"",author:"Admin",authorPhoto:"",readTime:5},i.value=null},s=l=>l?new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A";return Y(()=>{E()}),(l,o)=>(n(),d("div",ys,[e("div",hs,[o[11]||(o[11]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion des Actualit√©s"),e("p",{class:"text-gray-600 mt-1"},"Cr√©ez et g√©rez les actualit√©s du centre")],-1)),e("button",{onClick:o[0]||(o[0]=k=>{h.value=!0,g.value=null}),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...o[10]||(o[10]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nouvelle actualit√©",-1)])])]),i.value?(n(),d("div",ws,[e("div",$s,[o[12]||(o[12]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(i.value),1)]),i.value.includes("serveur")||i.value.includes("connecter")?(n(),d("button",{key:0,onClick:E,class:"mt-3 text-sm text-red-600 hover:text-red-800 underline"}," R√©essayer ")):x("",!0)])):x("",!0),h.value?(n(),d("div",ks,[e("h3",_s,r(g.value?"Modifier l'actualit√©":"Nouvelle actualit√©"),1),e("form",{onSubmit:K(S,["prevent"]),class:"space-y-6"},[e("div",Cs,[e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),A(e("input",{"onUpdate:modelValue":o[1]||(o[1]=k=>f.value.title=k),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de l'actualit√©"},null,512),[[T,f.value.title]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cat√©gorie *",-1)),A(e("select",{"onUpdate:modelValue":o[2]||(o[2]=k=>f.value.category=k),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...o[14]||(o[14]=[U('<option value="">S√©lectionnez...</option><option value="Recherche">Recherche</option><option value="Formation">Formation</option><option value="Partenariat">Partenariat</option><option value="√âv√©nement">√âv√©nement</option>',5)])],512),[[B,f.value.category]])]),e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image",-1)),e("input",{onChange:u,type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),o[18]||(o[18]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),p.value?(n(),d("div",Ds,[e("img",{src:p.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,Es)])):g.value&&f.value.image?(n(),d("div",As,[e("img",{src:f.value.image,alt:"Image actuelle",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,Rs),o[16]||(o[16]=e("p",{class:"text-xs text-gray-500 mt-1"},"Image actuelle",-1))])):x("",!0)]),e("div",null,[o[19]||(o[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de publication *",-1)),A(e("input",{"onUpdate:modelValue":o[3]||(o[3]=k=>f.value.publishDate=k),type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[T,f.value.publishDate]])])]),e("div",null,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"R√©sum√© *",-1)),A(e("textarea",{"onUpdate:modelValue":o[4]||(o[4]=k=>f.value.summary=k),required:"",rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"R√©sum√© de l'actualit√©..."},null,512),[[T,f.value.summary]])]),e("div",null,[o[21]||(o[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contenu *",-1)),A(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=k=>f.value.content=k),required:"",rows:"6",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Contenu complet de l'actualit√©..."},null,512),[[T,f.value.content]])]),e("div",null,[o[22]||(o[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ce que vous apprendrez",-1)),o[23]||(o[23]=e("p",{class:"text-xs text-gray-500 mb-2"},"Ajoutez un point par ligne",-1)),A(e("textarea",{"onUpdate:modelValue":o[6]||(o[6]=k=>P.value=k),rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:`Les derni√®res tendances en mati√®re de financement des PME
Comment pr√©parer un dossier de financement convaincant
Les diff√©rentes sources de financement disponibles
Les erreurs √† √©viter lors de la recherche de financement`},null,512),[[T,P.value]])]),e("div",null,[o[24]||(o[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Points cl√©s √† retenir",-1)),o[25]||(o[25]=e("p",{class:"text-xs text-gray-500 mb-2"},"Ajoutez un point par ligne",-1)),A(e("textarea",{"onUpdate:modelValue":o[7]||(o[7]=k=>j.value=k),rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:`Comprendre les m√©canismes de financement adapt√©s aux PME
Identifier les opportunit√©s de croissance et de d√©veloppement
Optimiser la gestion financi√®re de votre entreprise
Acc√©der aux ressources et programmes disponibles`},null,512),[[T,j.value]])]),e("div",null,[o[26]||(o[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mots-cl√©s (tags)",-1)),o[27]||(o[27]=e("p",{class:"text-xs text-gray-500 mb-2"},"S√©parez les tags par des virgules",-1)),A(e("input",{"onUpdate:modelValue":o[8]||(o[8]=k=>w.value=k),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Formation, PME, Financement, RDC"},null,512),[[T,w.value]])]),e("div",js,[e("div",null,[o[28]||(o[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Auteur *",-1)),A(e("input",{"onUpdate:modelValue":o[9]||(o[9]=k=>f.value.author=k),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Nom de l'auteur"},null,512),[[T,f.value.author]]),o[29]||(o[29]=e("p",{class:"text-xs text-gray-500 mt-1"},"Nom de la personne qui publie l'actualit√©",-1))]),e("div",null,[o[31]||(o[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Photo de l'auteur",-1)),e("input",{onChange:D,type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),o[32]||(o[32]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),_.value?(n(),d("div",Ts,[e("img",{src:_.value,alt:"Preview auteur",class:"w-24 h-24 object-cover rounded-full border border-gray-200"},null,8,Ss)])):g.value&&f.value.authorPhoto?(n(),d("div",Ps,[e("img",{src:f.value.authorPhoto,alt:"Photo auteur actuelle",class:"w-24 h-24 object-cover rounded-full border border-gray-200"},null,8,Ns),o[30]||(o[30]=e("p",{class:"text-xs text-gray-500 mt-1"},"Photo actuelle",-1))])):x("",!0)])]),e("div",Fs,[e("button",{type:"submit",disabled:y.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},[y.value?(n(),d("span",Is,"Enregistrement...")):(n(),d("span",zs,r(g.value?"Modifier":"Cr√©er"),1))],8,Vs),e("button",{type:"button",onClick:t,disabled:y.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,Ls)])],32)])):x("",!0),e("div",Ms,[e("div",Us,[e("table",Gs,[o[37]||(o[37]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Titre"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Cat√©gorie"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",qs,[y.value&&m.value.length===0?(n(),d("tr",Os,[...o[33]||(o[33]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Chargement... ",-1)])])):x("",!0),(n(!0),d(L,null,M(m.value,k=>(n(),d("tr",{key:k.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Bs,[e("div",Js,r(k.title),1)]),e("td",Ys,[e("span",Hs,r(k.category),1)]),e("td",Ws,r(s(k.publishDate)),1),e("td",Qs,[e("div",Ks,[e("button",{onClick:I=>b(k),disabled:y.value,class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...o[34]||(o[34]=[e("i",{class:"fas fa-edit"},null,-1)])],8,Xs),e("button",{onClick:I=>a(k.id),disabled:y.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...o[35]||(o[35]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Zs)])])]))),128)),!y.value&&m.value.length===0?(n(),d("tr",el,[...o[36]||(o[36]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Aucune actualit√© pour le moment ",-1)])])):x("",!0)])])])])]))}}),sl={class:"space-y-6"},ll={class:"flex items-center justify-between"},al={key:0,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},ol={key:0,class:"mt-3"},rl=["src"],nl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},il={class:"relative"},dl={id:"category-list"},ul=["value"],cl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pl={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},gl={class:"flex items-center gap-2"},ml={class:"flex gap-4"},vl=["disabled"],bl={key:0,class:"fas fa-spinner fa-spin"},xl=["disabled"],fl={key:1,class:"text-center py-12"},yl={key:2,class:"text-center py-12"},hl={class:"text-gray-600 mb-6"},wl={key:3,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},$l={class:"aspect-square overflow-hidden"},kl=["src","alt"],_l={class:"p-4"},Cl={class:"font-medium text-gray-900 mb-1"},Dl={class:"text-sm text-gray-500"},El={key:0,class:"text-xs text-gray-400 mt-1"},Al={class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"},Rl=["onClick","disabled"],jl={key:0,class:"col-span-full text-center py-12 text-gray-500"},Tl=J({__name:"DashboardGallery",setup(R){const h=te.useToast(),g=v(!1),m=v([]),$=v(null),p=v(null),c=v(!1),_=v(!1),y=v(null),i=v([]),f=v({title:"",description:"",category:"",date:new Date().toISOString().split("T")[0],author:"Admin"}),P=b=>{const a=b.target;if(a.files&&a.files[0]){const t=a.files[0];if(t.size>2*1024*1024){y.value="Le fichier est trop volumineux. Taille maximale: 2MB",a.value="";return}$.value=t,y.value=null;const s=new FileReader;s.onload=l=>{p.value=l.target?.result},s.readAsDataURL($.value)}},j=async()=>{c.value=!0,y.value=null;try{const b=await X.getPhotos({limit:100});m.value=b.data}catch(b){console.error("Erreur lors du chargement des photos:",b),y.value=b.message||"Erreur lors du chargement de la galerie",m.value=[]}finally{c.value=!1}},w=async()=>{try{const a=(await X.getCategories()).map(l=>l.name||l.id),t=["√âv√©nements","√âquipe","Installations","Collaborations","Formations","Conf√©rences","Ateliers","R√©unions","C√©r√©monies","Activit√©s","Projets","Partenariats"],s=new Set([...t,...a]);i.value=Array.from(s).sort(),i.value.length===0&&(i.value=t)}catch(b){console.error("Erreur lors du chargement des cat√©gories:",b),i.value=["√âv√©nements","√âquipe","Installations","Collaborations","Formations","Conf√©rences","Ateliers","R√©unions","C√©r√©monies","Activit√©s","Projets","Partenariats"]}},u=async()=>{if(!$.value){y.value="Veuillez s√©lectionner une image",h.open({message:"‚ö†Ô∏è Veuillez s√©lectionner une image",type:"warning",position:"top-right",duration:4e3});return}if(!f.value.title||!f.value.category){y.value="Veuillez remplir tous les champs obligatoires",h.open({message:"‚ö†Ô∏è Veuillez remplir tous les champs obligatoires",type:"warning",position:"top-right",duration:4e3});return}_.value=!0,y.value=null;try{const b=await X.uploadPhoto($.value,{title:f.value.title,description:f.value.description||"",category:f.value.category,date:f.value.date,author:f.value.author});m.value.unshift(b),C(),h.open({message:"‚úÖ Photo ajout√©e √† la galerie avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(b){console.error("Erreur lors de l'ajout de la photo:",b);const a=b.message||"Erreur lors de l'ajout de la photo";y.value=a,h.open({message:`‚ùå ${a}`,type:"error",position:"top-right",duration:6e3})}finally{_.value=!1}},D=async b=>{if(b&&confirm("√ätes-vous s√ªr de vouloir supprimer cette photo ?")){_.value=!0,y.value=null;try{await X.deletePhoto(b),m.value=m.value.filter(a=>a.id!==b),h.open({message:"‚úÖ Photo supprim√©e de la galerie avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(a){console.error("Erreur lors de la suppression de la photo:",a);const t=a.message||"Erreur lors de la suppression de la photo";y.value=t,h.open({message:`‚ùå ${t}`,type:"error",position:"top-right",duration:6e3})}finally{_.value=!1}}},E=b=>b&&X.getImageUrl(b)||"https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",S=b=>{if(!b)return"";try{const a=new Date(b);return isNaN(a.getTime())?b:a.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}catch{return b}},C=()=>{g.value=!1,$.value=null,p.value=null,y.value=null,f.value={title:"",description:"",category:"",date:new Date().toISOString().split("T")[0],author:"Admin"}};return Y(async()=>{await w(),await j()}),(b,a)=>(n(),d("div",sl,[e("div",ll,[a[8]||(a[8]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion de la Galerie"),e("p",{class:"text-gray-600 mt-1"},"Ajoutez et g√©rez les photos de la galerie")],-1)),e("button",{onClick:a[0]||(a[0]=t=>g.value=!0),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...a[7]||(a[7]=[e("i",{class:"fas fa-upload"},null,-1),e("span",null,"Ajouter des photos",-1)])])]),g.value?(n(),d("div",al,[a[18]||(a[18]=e("h3",{class:"text-xl font-bold text-gray-900 mb-6"},"Ajouter une photo",-1)),e("form",{onSubmit:K(u,["prevent"]),class:"space-y-6"},[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image *",-1)),e("input",{onChange:P,type:"file",accept:"image/*",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),a[10]||(a[10]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),p.value?(n(),d("div",ol,[e("img",{src:p.value,alt:"Preview",class:"w-48 h-48 object-cover rounded-lg border border-gray-200"},null,8,rl)])):x("",!0)]),e("div",nl,[e("div",null,[a[11]||(a[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),A(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>f.value.title=t),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de la photo"},null,512),[[T,f.value.title]])]),e("div",null,[a[12]||(a[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cat√©gorie *",-1)),e("div",il,[A(e("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>f.value.category=t),type:"text",list:"category-list",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Tapez ou s√©lectionnez une cat√©gorie...",required:""},null,512),[[T,f.value.category]]),e("datalist",dl,[(n(!0),d(L,null,M(i.value,t=>(n(),d("option",{key:t,value:t},r(t),9,ul))),128))])]),a[13]||(a[13]=e("p",{class:"text-xs text-gray-500 mt-1"},"Exemples: √âv√©nements, √âquipe, Installations, Collaborations, Formations, etc.",-1))])]),e("div",null,[a[14]||(a[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),A(e("textarea",{"onUpdate:modelValue":a[3]||(a[3]=t=>f.value.description=t),rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Description de la photo (optionnel)"},null,512),[[T,f.value.description]])]),e("div",cl,[e("div",null,[a[15]||(a[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date *",-1)),A(e("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>f.value.date=t),type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[T,f.value.date]])]),e("div",null,[a[16]||(a[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Auteur *",-1)),A(e("input",{"onUpdate:modelValue":a[5]||(a[5]=t=>f.value.author=t),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Nom de l'auteur"},null,512),[[T,f.value.author]])])]),y.value?(n(),d("div",pl,[e("div",gl,[a[17]||(a[17]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(y.value),1)])])):x("",!0),e("div",ml,[e("button",{type:"submit",disabled:_.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[_.value?(n(),d("i",bl)):x("",!0),e("span",null,r(_.value?"Ajout en cours...":"Ajouter"),1)],8,vl),e("button",{type:"button",onClick:C,disabled:_.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50"}," Annuler ",8,xl)])],32)])):x("",!0),c.value&&m.value.length===0?(n(),d("div",fl,[...a[19]||(a[19]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement de la galerie...",-1)])])):y.value&&m.value.length===0?(n(),d("div",yl,[a[20]||(a[20]=e("i",{class:"fas fa-exclamation-triangle text-4xl text-red-600 mb-4"},null,-1)),a[21]||(a[21]=e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Erreur",-1)),e("p",hl,r(y.value),1),e("button",{onClick:j,class:"bg-blue-500 hover:bg-blue-600 text-white font-medium px-6 py-3 rounded-lg transition-colors"}," R√©essayer ")])):(n(),d("div",wl,[(n(!0),d(L,null,M(m.value,t=>(n(),d("div",{key:t.id,class:"group relative bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300"},[e("div",$l,[e("img",{src:E(t.image),alt:t.title||"Photo",class:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:a[6]||(a[6]=s=>{s.target.src="https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"})},null,40,kl)]),e("div",_l,[e("h3",Cl,r(t.title||"Sans titre"),1),e("p",Dl,r(t.category||"Non cat√©goris√©"),1),t.date?(n(),d("p",El,r(S(t.date)),1)):x("",!0)]),e("div",Al,[e("button",{onClick:s=>D(t.id),class:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",disabled:_.value},[...a[22]||(a[22]=[e("i",{class:"fas fa-trash text-sm"},null,-1)])],8,Rl)])]))),128)),!c.value&&m.value.length===0?(n(),d("div",jl,[...a[23]||(a[23]=[e("i",{class:"fas fa-images text-4xl text-gray-300 mb-4"},null,-1),e("p",null,"Aucune photo dans la galerie",-1)])])):x("",!0)]))]))}}),Sl={class:"space-y-6"},Pl={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},Nl={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Fl={class:"flex items-center justify-between"},Vl={class:"text-2xl font-bold text-gray-900"},Il={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},zl={class:"flex items-center justify-between"},Ll={class:"text-2xl font-bold text-gray-900"},Ml={key:0,class:"text-center py-12"},Ul={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},Gl={class:"flex items-center gap-2"},ql={key:2,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Ol={class:"p-4 border-b border-gray-200 flex items-center justify-between"},Bl={class:"overflow-x-auto"},Jl={class:"w-full"},Yl={class:"divide-y divide-gray-200"},Hl={class:"px-6 py-4"},Wl={class:"font-medium text-gray-900"},Ql={class:"px-6 py-4 text-gray-600"},Kl={class:"px-6 py-4 text-center"},Xl={class:"px-6 py-4"},Zl={class:"flex items-center justify-center gap-2"},ea=["onClick"],ta={key:0},sa=J({__name:"DashboardNewsletter",setup(R){const h=v(""),g=v([]),m=v(!1),$=v(null),p=V(()=>h.value?g.value.filter(w=>w.email.toLowerCase().includes(h.value.toLowerCase())):g.value),c=V(()=>{const w=new Date,u=new Date(w.getFullYear(),w.getMonth(),1);return g.value.filter(D=>{const E=D.subscribedAt||D.createdAt;return E&&new Date(E)>=u}).length}),_=async()=>{m.value=!0,$.value=null;try{const w=await oe.getAllSubscribers({limit:100,search:h.value||void 0});g.value=w.data,console.log("üìß Newsletter Subscribers charg√©s:",g.value.length)}catch(w){console.error("Erreur lors du chargement des abonn√©s:",w),$.value=w.message||"Erreur lors du chargement des abonn√©s",g.value=[]}finally{m.value=!1}},y=async w=>{if(w&&confirm("√ätes-vous s√ªr de vouloir supprimer cet abonn√© ?"))try{await oe.deleteSubscriber(w),await _(),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(u){console.error("Erreur lors de la suppression:",u),alert("Erreur lors de la suppression: "+(u.message||"Erreur inconnue"))}},i=()=>{const w=g.value.map(S=>S.email).join(`
`),u=new Blob([w],{type:"text/csv"}),D=window.URL.createObjectURL(u),E=document.createElement("a");E.href=D,E.download="newsletter-subscribers.csv",E.click()},f=w=>w?new Date(w).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A",P=w=>({active:"Actif",unsubscribed:"D√©sabonn√©",pending:"En attente"})[w]||w,j=w=>({active:"bg-green-100 text-green-700",unsubscribed:"bg-red-100 text-red-700",pending:"bg-yellow-100 text-yellow-700"})[w]||"bg-gray-100 text-gray-700";return Y(()=>{_()}),(w,u)=>(n(),d("div",Sl,[u[12]||(u[12]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Abonn√©s Newsletter"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les abonnements √† la newsletter")],-1)),e("div",Pl,[e("div",Nl,[e("div",Fl,[e("div",null,[u[1]||(u[1]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total abonn√©s",-1)),e("p",Vl,r(g.value.length),1)]),u[2]||(u[2]=e("div",{class:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-users text-blue-600 text-xl"})],-1))])]),e("div",Il,[e("div",zl,[e("div",null,[u[3]||(u[3]=e("p",{class:"text-sm text-gray-600 mb-1"},"Ce mois",-1)),e("p",Ll,r(c.value),1)]),u[4]||(u[4]=e("div",{class:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-arrow-up text-green-600 text-xl"})],-1))])]),u[5]||(u[5]=U('<div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600 mb-1">Taux d&#39;ouverture</p><p class="text-2xl font-bold text-gray-900">42%</p></div><div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center"><i class="fas fa-chart-line text-purple-600 text-xl"></i></div></div></div>',1))]),m.value?(n(),d("div",Ml,[...u[6]||(u[6]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des abonn√©s...",-1)])])):$.value?(n(),d("div",Ul,[e("div",Gl,[u[7]||(u[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r($.value),1)])])):(n(),d("div",ql,[e("div",Ol,[A(e("input",{"onUpdate:modelValue":u[0]||(u[0]=D=>h.value=D),type:"text",placeholder:"Rechercher un email...",onInput:_,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[T,h.value]]),e("button",{onClick:i,class:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[...u[8]||(u[8]=[e("i",{class:"fas fa-download"},null,-1),e("span",null,"Exporter",-1)])])]),e("div",Bl,[e("table",Jl,[u[11]||(u[11]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Email"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date d'inscription"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Statut"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Yl,[(n(!0),d(L,null,M(p.value,D=>(n(),d("tr",{key:D.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Hl,[e("div",Wl,r(D.email),1)]),e("td",Ql,r(f(D.subscribedAt||D.createdAt)),1),e("td",Kl,[e("span",{class:z(["px-3 py-1 rounded-full text-xs font-medium",j(D.status)])},r(P(D.status)),3)]),e("td",Xl,[e("div",Zl,[e("button",{onClick:E=>y(D.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[...u[9]||(u[9]=[e("i",{class:"fas fa-trash"},null,-1)])],8,ea)])])]))),128)),p.value.length===0?(n(),d("tr",ta,[...u[10]||(u[10]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Aucun abonn√© trouv√© ",-1)])])):x("",!0)])])])]))]))}}),la={class:"space-y-6"},aa={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},oa={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ra={class:"text-2xl font-bold text-gray-900"},na={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ia={class:"text-2xl font-bold text-yellow-600"},da={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ua={class:"text-2xl font-bold text-green-600"},ca={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},pa={class:"text-2xl font-bold text-blue-600"},ga={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},ma={class:"flex items-center gap-2"},va={key:1,class:"text-center py-12"},ba={key:2,class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},xa={key:3,class:"space-y-4"},fa={class:"flex items-start justify-between mb-4"},ya={class:"flex-1"},ha={class:"flex items-center gap-3 mb-2"},wa={class:"text-lg font-bold text-gray-900"},$a={class:"text-gray-600 mb-1"},ka={class:"text-gray-600 mb-1"},_a={key:0,class:"text-gray-600 mb-1"},Ca={class:"text-gray-600"},Da={class:"flex gap-2"},Ea=["onClick","disabled"],Aa=["onClick","disabled"],Ra=["onClick"],ja=["onClick","disabled"],Ta={class:"bg-gray-50 rounded-lg p-4"},Sa={class:"text-sm text-gray-700"},Pa={class:"text-sm text-gray-700 mt-2"},Na={class:"text-sm text-gray-700 mt-2"},Fa={key:0,class:"text-center py-12 text-gray-500"},Va={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Ia={class:"flex items-center justify-between mb-6"},za={class:"space-y-4"},La={class:"text-gray-900"},Ma={class:"text-gray-600 text-sm"},Ua={key:0,class:"text-gray-600 text-sm"},Ga={class:"text-gray-900"},qa={class:"text-gray-600 text-sm"},Oa={class:"text-gray-900 font-semibold"},Ba={class:"text-gray-900 mt-2 whitespace-pre-wrap"},Ja={class:"text-gray-900"},Ya={class:"text-gray-900"},Ha=J({__name:"DashboardFinancing",setup(R){const h=te.useToast(),g=v(""),m=v(""),$=v([]),p=v(null),c=v(!1),_=v(null),y=v(!1),i=V(()=>{let a=$.value;if(m.value&&(a=a.filter(t=>t.status===m.value)),g.value){const t=g.value.toLowerCase();a=a.filter(s=>(s.contactFirstName+" "+s.contactLastName).toLowerCase().includes(t)||s.contactEmail.toLowerCase().includes(t)||s.companyName.toLowerCase().includes(t)||s.projectTitle.toLowerCase().includes(t))}return a}),f=V(()=>$.value.filter(a=>a.status==="submitted"||a.status==="under-review").length),P=V(()=>$.value.filter(a=>a.status==="approved"||a.status==="rejected").length),j=V(()=>$.value.filter(a=>{const t=new Date(a.createdAt||""),s=new Date;return s.setDate(s.getDate()-7),t>=s}).length),w=async()=>{c.value=!0,_.value=null;try{const a=await ee.getRequests({status:m.value||void 0,search:g.value||void 0,limit:100});$.value=a.data}catch(a){console.error("Erreur lors du chargement des demandes:",a),_.value=a.message||"Erreur lors du chargement des demandes",$.value=[]}finally{c.value=!1}},u=a=>{p.value=a},D=async a=>{if(a&&confirm("√ätes-vous s√ªr de vouloir supprimer cette demande ?")){y.value=!0,_.value=null;try{await ee.deleteRequest(a),await w(),h.open({message:"‚úÖ Demande de financement supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t);const s=t.message||"Erreur lors de la suppression";_.value=s,h.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{y.value=!1}}},E=async(a,t)=>{if(a.id){y.value=!0,_.value=null;try{await ee.updateRequestStatus(a.id,t),await w();const s={approved:"approuv√©e",rejected:"refus√©e","under-review":"mise en r√©vision","on-hold":"mise en attente"};h.open({message:`‚úÖ Demande ${s[t]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(s){console.error("Erreur lors de la mise √† jour:",s);const l=s.message||s.errors?.status?.[0]||"Erreur lors de la mise √† jour du statut";_.value=l,h.open({message:`‚ùå ${l}`,type:"error",position:"top-right",duration:6e3})}finally{y.value=!1}}},S=a=>({draft:"Brouillon",submitted:"Soumise","under-review":"En r√©vision",approved:"Approuv√©e",rejected:"Refus√©e","on-hold":"En attente"})[a]||a,C=a=>({draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700","under-review":"bg-blue-100 text-blue-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700","on-hold":"bg-orange-100 text-orange-700"})[a]||"bg-gray-100 text-gray-700",b=a=>a?new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return Y(()=>{w()}),(a,t)=>(n(),d("div",la,[t[29]||(t[29]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Demandes de Financement"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les demandes de financement re√ßues")],-1)),e("div",aa,[e("div",oa,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",ra,r($.value.length),1)]),e("div",na,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",ia,r(f.value),1)]),e("div",da,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"Trait√©es",-1)),e("p",ua,r(P.value),1)]),e("div",ca,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Nouvelles",-1)),e("p",pa,r(j.value),1)])]),_.value?(n(),d("div",ga,[e("div",ma,[t[8]||(t[8]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(_.value),1)])])):x("",!0),c.value?(n(),d("div",va,[...t[9]||(t[9]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des demandes...",-1)])])):(n(),d("div",ba,[A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),onChange:w,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[10]||(t[10]=[U('<option value="">Tous les statuts</option><option value="submitted">Soumise</option><option value="under-review">En r√©vision</option><option value="approved">Approuv√©e</option><option value="rejected">Refus√©e</option><option value="on-hold">En attente</option>',6)])],544),[[B,m.value]]),A(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),onInput:w,type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[T,g.value]])])),c.value?x("",!0):(n(),d("div",xa,[(n(!0),d(L,null,M(i.value,s=>(n(),d("div",{key:s.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",fa,[e("div",ya,[e("div",ha,[e("h3",wa,r(s.contactFirstName)+" "+r(s.contactLastName),1),e("span",{class:z(["px-3 py-1 rounded-full text-xs font-medium",C(s.status)])},r(S(s.status)),3)]),e("p",$a,[t[11]||(t[11]=e("i",{class:"fas fa-building mr-2"},null,-1)),F(r(s.companyName),1)]),e("p",ka,[t[12]||(t[12]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(r(s.contactEmail),1)]),s.contactPhone?(n(),d("p",_a,[t[13]||(t[13]=e("i",{class:"fas fa-phone mr-2"},null,-1)),F(r(s.contactPhone),1)])):x("",!0),e("p",Ca,[t[14]||(t[14]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(r(b(s.createdAt)),1)])]),e("div",Da,[s.status!=="approved"?(n(),d("button",{key:0,onClick:l=>E(s,"approved"),disabled:y.value,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Approuver"},[...t[15]||(t[15]=[e("i",{class:"fas fa-check"},null,-1)])],8,Ea)):x("",!0),s.status!=="rejected"?(n(),d("button",{key:1,onClick:l=>E(s,"rejected"),disabled:y.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Rejeter"},[...t[16]||(t[16]=[e("i",{class:"fas fa-times"},null,-1)])],8,Aa)):x("",!0),e("button",{onClick:l=>u(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Voir les d√©tails"},[...t[17]||(t[17]=[e("i",{class:"fas fa-eye"},null,-1)])],8,Ra),e("button",{onClick:l=>D(s.id),disabled:y.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...t[18]||(t[18]=[e("i",{class:"fas fa-trash"},null,-1)])],8,ja)])]),e("div",Ta,[e("p",Sa,[t[19]||(t[19]=e("strong",null,"Projet:",-1)),F(" "+r(s.projectTitle),1)]),e("p",Pa,[t[20]||(t[20]=e("strong",null,"Description:",-1)),F(" "+r(s.projectDescription?.substring(0,200))+r(s.projectDescription&&s.projectDescription.length>200?"...":""),1)]),e("p",Na,[t[21]||(t[21]=e("strong",null,"Montant demand√©:",-1)),F(" "+r(s.requestedAmount)+" "+r(s.currency),1)])])]))),128)),i.value.length===0?(n(),d("div",Fa," Aucune demande trouv√©e ")):x("",!0)])),p.value?(n(),d("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t[3]||(t[3]=K(s=>p.value=null,["self"]))},[e("div",Va,[e("div",Ia,[t[23]||(t[23]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de la demande",-1)),e("button",{onClick:t[2]||(t[2]=s=>p.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...t[22]||(t[22]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",za,[e("div",null,[t[24]||(t[24]=e("label",{class:"text-sm font-medium text-gray-600"},"Contact",-1)),e("p",La,r(p.value.contactFirstName)+" "+r(p.value.contactLastName),1),e("p",Ma,r(p.value.contactEmail),1),p.value.contactPhone?(n(),d("p",Ua,r(p.value.contactPhone),1)):x("",!0)]),e("div",null,[t[25]||(t[25]=e("label",{class:"text-sm font-medium text-gray-600"},"Entreprise",-1)),e("p",Ga,r(p.value.companyName),1),e("p",qa,r(p.value.address)+", "+r(p.value.city)+", "+r(p.value.country),1)]),e("div",null,[t[26]||(t[26]=e("label",{class:"text-sm font-medium text-gray-600"},"Projet",-1)),e("p",Oa,r(p.value.projectTitle),1),e("p",Ba,r(p.value.projectDescription),1)]),e("div",null,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Montant demand√©",-1)),e("p",Ja,r(p.value.requestedAmount)+" "+r(p.value.currency),1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Date",-1)),e("p",Ya,r(b(p.value.createdAt)),1)])])])])):x("",!0)]))}}),Wa={class:"space-y-6"},Qa={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},Ka={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Xa={class:"text-2xl font-bold text-gray-900"},Za={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},eo={class:"text-2xl font-bold text-yellow-600"},to={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},so={class:"text-2xl font-bold text-green-600"},lo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ao={class:"text-2xl font-bold text-blue-600"},oo={class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},ro={key:0,class:"text-center py-12"},no={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},io={class:"flex items-center gap-2"},uo={key:2,class:"space-y-4"},co={class:"flex items-start justify-between mb-4"},po={class:"flex-1"},go={class:"flex items-center gap-3 mb-2"},mo={class:"text-lg font-bold text-gray-900"},vo={class:"text-gray-600 mb-1"},bo={key:0,class:"text-gray-600 mb-1"},xo={class:"text-gray-600 mb-1"},fo={class:"text-gray-600"},yo={class:"flex gap-2"},ho=["onClick"],wo=["onClick"],$o=["onClick"],ko={key:0,class:"bg-gray-50 rounded-lg p-4"},_o={class:"text-sm text-gray-700"},Co={key:0,class:"text-center py-12 text-gray-500"},Do={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Eo={class:"flex items-center justify-between mb-6"},Ao={class:"space-y-4"},Ro={class:"text-gray-900"},jo={class:"text-gray-900"},To={key:0},So={class:"text-gray-900"},Po={class:"text-gray-900"},No={key:1},Fo={class:"text-gray-900 whitespace-pre-wrap"},Vo={class:"text-gray-900"},Io={class:"text-gray-900"},zo=J({__name:"DashboardTraining",setup(R){const h=v(""),g=v(""),m=v(""),$=v([]),p=v(null),c=v(!1),_=v(null),y=V(()=>{let a=$.value;if(g.value&&(a=a.filter(t=>t.status===g.value)),m.value&&(a=a.filter(t=>t.program===m.value)),h.value){const t=h.value.toLowerCase();a=a.filter(s=>s.name.toLowerCase().includes(t)||s.email.toLowerCase().includes(t))}return a}),i=V(()=>$.value.filter(a=>a.status==="pending").length),f=V(()=>$.value.filter(a=>a.status==="confirmed").length),P=V(()=>$.value.filter(a=>{const t=new Date(a.registrationDate||""),s=new Date;return s.setDate(s.getDate()-7),t>=s}).length),j=async()=>{c.value=!0,_.value=null;try{const a=await le.getRegistrations({status:g.value||void 0,program:m.value||void 0,search:h.value||void 0,limit:100});$.value=a.data,console.log("üìö Training Registrations charg√©es:",$.value.length)}catch(a){console.error("Erreur lors du chargement des inscriptions:",a),_.value=a.message||"Erreur lors du chargement des inscriptions",$.value=[]}finally{c.value=!1}},w=a=>{p.value=a},u=async a=>{if(!a.id)return;const t=a.status==="pending"?"confirmed":a.status;try{await le.updateRegistration(a.id,{status:t}),await j(),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(s){console.error("Erreur lors de la mise √† jour du statut:",s),alert("Erreur lors de la mise √† jour du statut: "+(s.message||"Erreur inconnue"))}},D=async a=>{if(a&&confirm("√ätes-vous s√ªr de vouloir supprimer cette inscription ?"))try{await le.deleteRegistration(a),await j(),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t),alert("Erreur lors de la suppression: "+(t.message||"Erreur inconnue"))}},E=a=>({pending:"En attente",confirmed:"Confirm√©e",cancelled:"Annul√©e",completed:"Termin√©e"})[a]||a,S=a=>({pending:"bg-yellow-100 text-yellow-700",confirmed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",completed:"bg-blue-100 text-blue-700"})[a]||"bg-gray-100 text-gray-700",C=a=>({training1:"Formation en Gestion d'Entreprise",training2:"Accompagnement Personnalis√©",training3:"Formation en Entrepreneuriat",training4:"R√©seautage et Partenariats"})[a]||a,b=a=>a?new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return de([g,m],()=>{j()}),Y(()=>{j()}),(a,t)=>(n(),d("div",Wa,[t[30]||(t[30]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Inscriptions aux Formations"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les inscriptions aux formations d'entrepreneurs")],-1)),e("div",Qa,[e("div",Ka,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",Xa,r($.value.length),1)]),e("div",Za,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",eo,r(i.value),1)]),e("div",to,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Confirm√©es",-1)),e("p",so,r(f.value),1)]),e("div",lo,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600 mb-1"},"Nouvelles",-1)),e("p",ao,r(P.value),1)])]),e("div",oo,[A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[9]||(t[9]=[U('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="confirmed">Confirm√©e</option><option value="cancelled">Annul√©e</option><option value="completed">Termin√©e</option>',5)])],512),[[B,g.value]]),A(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[10]||(t[10]=[U('<option value="">Tous les programmes</option><option value="training1">Formation en Gestion d&#39;Entreprise</option><option value="training2">Accompagnement Personnalis√©</option><option value="training3">Formation en Entrepreneuriat</option><option value="training4">R√©seautage et Partenariats</option>',5)])],512),[[B,m.value]]),A(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>h.value=s),type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[T,h.value]])]),c.value?(n(),d("div",ro,[...t[11]||(t[11]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des inscriptions...",-1)])])):_.value?(n(),d("div",no,[e("div",io,[t[12]||(t[12]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(_.value),1)])])):(n(),d("div",uo,[(n(!0),d(L,null,M(y.value,s=>(n(),d("div",{key:s.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",co,[e("div",po,[e("div",go,[e("h3",mo,r(s.name),1),e("span",{class:z(["px-3 py-1 rounded-full text-xs font-medium",S(s.status)])},r(E(s.status)),3)]),e("p",vo,[t[13]||(t[13]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(r(s.email),1)]),s.phone?(n(),d("p",bo,[t[14]||(t[14]=e("i",{class:"fas fa-phone mr-2"},null,-1)),F(r(s.phone),1)])):x("",!0),e("p",xo,[t[15]||(t[15]=e("i",{class:"fas fa-graduation-cap mr-2"},null,-1)),F(r(C(s.program)),1)]),e("p",fo,[t[16]||(t[16]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(r(b(s.registrationDate)),1)])]),e("div",yo,[e("button",{onClick:l=>w(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[...t[17]||(t[17]=[e("i",{class:"fas fa-eye"},null,-1)])],8,ho),e("button",{onClick:l=>u(s),class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"},[...t[18]||(t[18]=[e("i",{class:"fas fa-check"},null,-1)])],8,wo),e("button",{onClick:l=>D(s.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[...t[19]||(t[19]=[e("i",{class:"fas fa-trash"},null,-1)])],8,$o)])]),s.message?(n(),d("div",ko,[e("p",_o,[t[20]||(t[20]=e("strong",null,"Message:",-1)),F(" "+r(s.message),1)])])):x("",!0)]))),128)),y.value.length===0?(n(),d("div",Co," Aucune inscription trouv√©e ")):x("",!0)])),p.value?(n(),d("div",{key:3,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t[4]||(t[4]=K(s=>p.value=null,["self"]))},[e("div",Do,[e("div",Eo,[t[22]||(t[22]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de l'inscription",-1)),e("button",{onClick:t[3]||(t[3]=s=>p.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...t[21]||(t[21]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",Ao,[e("div",null,[t[23]||(t[23]=e("label",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("p",Ro,r(p.value.name),1)]),e("div",null,[t[24]||(t[24]=e("label",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("p",jo,r(p.value.email),1)]),p.value.phone?(n(),d("div",To,[t[25]||(t[25]=e("label",{class:"text-sm font-medium text-gray-600"},"T√©l√©phone",-1)),e("p",So,r(p.value.phone),1)])):x("",!0),e("div",null,[t[26]||(t[26]=e("label",{class:"text-sm font-medium text-gray-600"},"Programme",-1)),e("p",Po,r(C(p.value.program)),1)]),p.value.message?(n(),d("div",No,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Message",-1)),e("p",Fo,r(p.value.message),1)])):x("",!0),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("p",Vo,r(b(p.value.registrationDate)),1)]),e("div",null,[t[29]||(t[29]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("p",Io,r(E(p.value.status)),1)])])])])):x("",!0)]))}}),Lo={class:"space-y-6"},Mo={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},Uo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Go={class:"text-2xl font-bold text-gray-900"},qo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Oo={class:"text-2xl font-bold text-yellow-600"},Bo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Jo={class:"text-2xl font-bold text-green-600"},Yo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Ho={class:"text-2xl font-bold text-blue-600"},Wo={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},Qo={class:"flex items-center gap-2"},Ko={key:1,class:"text-center py-12"},Xo={key:2,class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},Zo={key:3,class:"space-y-4"},er={class:"flex items-start justify-between mb-4"},tr={class:"flex-1"},sr={class:"flex items-center gap-3 mb-2"},lr={class:"text-lg font-bold text-gray-900"},ar={class:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium"},or={class:"text-gray-600 mb-1"},rr={class:"text-gray-600 mb-1"},nr={key:0,class:"text-gray-600 mb-1"},ir={class:"text-gray-600"},dr={class:"flex gap-2"},ur=["onClick","disabled"],cr=["onClick","disabled"],pr=["onClick","disabled"],gr=["onClick"],mr=["onClick","disabled"],vr={class:"bg-gray-50 rounded-lg p-4"},br={class:"text-sm text-gray-700 mb-2"},xr={class:"text-sm text-gray-700 mb-2"},fr={class:"text-sm text-gray-700 mb-2"},yr={class:"flex gap-2 mt-3 pt-3 border-t border-gray-200"},hr=["href"],wr={key:1,class:"text-xs text-gray-500"},$r={key:0,class:"text-center py-12 text-gray-500"},kr={class:"bg-white rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto"},_r={class:"flex items-center justify-between mb-6"},Cr={class:"space-y-4"},Dr={class:"text-gray-900 font-semibold"},Er={class:"text-gray-900"},Ar={class:"text-gray-900"},Rr={class:"text-gray-900"},jr={class:"text-gray-900 whitespace-pre-wrap"},Tr={key:0},Sr={class:"text-gray-900"},Pr={class:"text-gray-900"},Nr={class:"text-gray-600 text-sm"},Fr={key:0,class:"text-gray-600 text-sm"},Vr={key:1,class:"text-gray-600 text-sm"},Ir={key:1},zr={class:"text-gray-900 whitespace-pre-wrap"},Lr={class:"text-gray-900"},Mr={class:"text-gray-900"},Ur={class:"border-t border-gray-200 pt-4 mt-4"},Gr={class:"space-y-3"},qr=["href"],Or={key:1,class:"text-sm text-gray-500"},Br={key:0},Jr=["src","alt"],Yr=["href"],Hr={key:1,class:"text-sm text-gray-500"},Wr=J({__name:"DashboardPublications",setup(R){const h=te.useToast(),g=v(""),m=v(""),$=v(""),p=v([]),c=v(null),_=v(!1),y=v(null),i=v(!1),f=V(()=>{let s=p.value;if(m.value&&(s=s.filter(l=>l.status===m.value)),$.value&&(s=s.filter(l=>l.type===$.value)),g.value){const l=g.value.toLowerCase();s=s.filter(o=>o.name.toLowerCase().includes(l)||o.email.toLowerCase().includes(l)||o.title.toLowerCase().includes(l))}return s}),P=V(()=>p.value.filter(s=>s.status==="pending").length),j=V(()=>p.value.filter(s=>s.status==="accepted").length),w=V(()=>p.value.filter(s=>s.status==="published").length),u=async()=>{_.value=!0,y.value=null;try{const s=await ae.getRequests({status:m.value||void 0,type:$.value||void 0,search:g.value||void 0,limit:100});p.value=s.data}catch(s){console.error("Erreur lors du chargement des demandes:",s),y.value=s.message||"Erreur lors du chargement des demandes",p.value=[]}finally{_.value=!1}},D=s=>{c.value=s},E=async(s,l)=>{if(s.id){i.value=!0,y.value=null;try{await ae.updateRequestStatus(s.id,l),await u();const o={accepted:"accept√©e",rejected:"refus√©e",published:"publi√©e"};h.open({message:`‚úÖ Demande ${o[l]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(o){console.error("Erreur lors de la mise √† jour:",o);const k=o.message||o.errors?.status?.[0]||"Erreur lors de la mise √† jour du statut";y.value=k,h.open({message:`‚ùå ${k}`,type:"error",position:"top-right",duration:6e3})}finally{i.value=!1}}},S=async s=>{if(s&&confirm("√ätes-vous s√ªr de vouloir supprimer cette demande ?")){i.value=!0,y.value=null;try{await ae.deleteRequest(s),await u(),h.open({message:"‚úÖ Demande de publication supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(l){console.error("Erreur lors de la suppression:",l);const o=l.message||"Erreur lors de la suppression";y.value=o,h.open({message:`‚ùå ${o}`,type:"error",position:"top-right",duration:6e3})}finally{i.value=!1}}},C=s=>({pending:"En attente","under-review":"En r√©vision",accepted:"Accept√©e",rejected:"Refus√©e",published:"Publi√©e"})[s]||s,b=s=>({pending:"bg-yellow-100 text-yellow-700","under-review":"bg-blue-100 text-blue-700",accepted:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",published:"bg-purple-100 text-purple-700"})[s]||"bg-gray-100 text-gray-700",a=s=>({article:"Article","research-paper":"Document de recherche",book:"Livre",report:"Rapport",other:"Autre"})[s]||s,t=s=>s?new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return Y(()=>{u()}),(s,l)=>(n(),d("div",Lo,[l[44]||(l[44]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Demandes de Publication"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les demandes de publication d'articles")],-1)),e("div",Mo,[e("div",Uo,[l[6]||(l[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",Go,r(p.value.length),1)]),e("div",qo,[l[7]||(l[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",Oo,r(P.value),1)]),e("div",Bo,[l[8]||(l[8]=e("p",{class:"text-sm text-gray-600 mb-1"},"Accept√©es",-1)),e("p",Jo,r(j.value),1)]),e("div",Yo,[l[9]||(l[9]=e("p",{class:"text-sm text-gray-600 mb-1"},"Publi√©es",-1)),e("p",Ho,r(w.value),1)])]),y.value?(n(),d("div",Wo,[e("div",Qo,[l[10]||(l[10]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,r(y.value),1)])])):x("",!0),_.value?(n(),d("div",Ko,[...l[11]||(l[11]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des demandes...",-1)])])):(n(),d("div",Xo,[A(e("select",{"onUpdate:modelValue":l[0]||(l[0]=o=>m.value=o),onChange:u,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...l[12]||(l[12]=[U('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="under-review">En r√©vision</option><option value="accepted">Accept√©e</option><option value="rejected">Refus√©e</option><option value="published">Publi√©e</option>',6)])],544),[[B,m.value]]),A(e("select",{"onUpdate:modelValue":l[1]||(l[1]=o=>$.value=o),onChange:u,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...l[13]||(l[13]=[U('<option value="">Tous les types</option><option value="article">Article</option><option value="research-paper">Document de recherche</option><option value="book">Livre</option><option value="report">Rapport</option><option value="other">Autre</option>',6)])],544),[[B,$.value]]),A(e("input",{"onUpdate:modelValue":l[2]||(l[2]=o=>g.value=o),onInput:u,type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[T,g.value]])])),_.value?x("",!0):(n(),d("div",Zo,[(n(!0),d(L,null,M(f.value,o=>(n(),d("div",{key:o.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",er,[e("div",tr,[e("div",sr,[e("h3",lr,r(o.title),1),e("span",{class:z(["px-3 py-1 rounded-full text-xs font-medium",b(o.status)])},r(C(o.status)),3),e("span",ar,r(a(o.type)),1)]),e("p",or,[l[14]||(l[14]=e("i",{class:"fas fa-user mr-2"},null,-1)),F(r(o.name),1)]),e("p",rr,[l[15]||(l[15]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(r(o.email),1)]),o.institution?(n(),d("p",nr,[l[16]||(l[16]=e("i",{class:"fas fa-university mr-2"},null,-1)),F(r(o.institution),1)])):x("",!0),e("p",ir,[l[17]||(l[17]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(r(t(o.submissionDate)),1)])]),e("div",dr,[o.status!=="accepted"?(n(),d("button",{key:0,onClick:k=>E(o,"accepted"),disabled:i.value,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Accepter"},[...l[18]||(l[18]=[e("i",{class:"fas fa-check"},null,-1)])],8,ur)):x("",!0),o.status!=="rejected"?(n(),d("button",{key:1,onClick:k=>E(o,"rejected"),disabled:i.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Rejeter"},[...l[19]||(l[19]=[e("i",{class:"fas fa-times"},null,-1)])],8,cr)):x("",!0),o.status==="accepted"?(n(),d("button",{key:2,onClick:k=>E(o,"published"),disabled:i.value,class:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors disabled:opacity-50",title:"Publier"},[...l[20]||(l[20]=[e("i",{class:"fas fa-check-double"},null,-1)])],8,pr)):x("",!0),e("button",{onClick:k=>D(o),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Voir les d√©tails"},[...l[21]||(l[21]=[e("i",{class:"fas fa-eye"},null,-1)])],8,gr),e("button",{onClick:k=>S(o.id),disabled:i.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...l[22]||(l[22]=[e("i",{class:"fas fa-trash"},null,-1)])],8,mr)])]),e("div",vr,[e("p",br,[l[23]||(l[23]=e("strong",null,"Auteurs:",-1)),F(" "+r(o.authors),1)]),e("p",xr,[l[24]||(l[24]=e("strong",null,"Domaines:",-1)),F(" "+r(o.domains.join(", ")),1)]),e("p",fr,[l[25]||(l[25]=e("strong",null,"R√©sum√©:",-1)),F(" "+r(o.abstract?.substring(0,200))+r(o.abstract&&o.abstract.length>200?"...":""),1)]),e("div",yr,[o.documentFileUrl||o.document_file_url?(n(),d("a",{key:0,href:o.documentFileUrl||o.document_file_url,target:"_blank",class:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 transition-colors"},[...l[26]||(l[26]=[e("i",{class:"fas fa-file-pdf"},null,-1),e("span",null,"T√©l√©charger le document",-1)])],8,hr)):(n(),d("span",wr,"Aucun document"))])])]))),128)),f.value.length===0?(n(),d("div",$r," Aucune demande trouv√©e ")):x("",!0)])),c.value?(n(),d("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:l[5]||(l[5]=K(o=>c.value=null,["self"]))},[e("div",kr,[e("div",_r,[l[28]||(l[28]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de la demande",-1)),e("button",{onClick:l[3]||(l[3]=o=>c.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...l[27]||(l[27]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",Cr,[e("div",null,[l[29]||(l[29]=e("label",{class:"text-sm font-medium text-gray-600"},"Titre du travail",-1)),e("p",Dr,r(c.value.title),1)]),e("div",null,[l[30]||(l[30]=e("label",{class:"text-sm font-medium text-gray-600"},"Auteurs",-1)),e("p",Er,r(c.value.authors),1)]),e("div",null,[l[31]||(l[31]=e("label",{class:"text-sm font-medium text-gray-600"},"Type",-1)),e("p",Ar,r(a(c.value.type)),1)]),e("div",null,[l[32]||(l[32]=e("label",{class:"text-sm font-medium text-gray-600"},"Domaines de recherche",-1)),e("p",Rr,r(c.value.domains.join(", ")),1)]),e("div",null,[l[33]||(l[33]=e("label",{class:"text-sm font-medium text-gray-600"},"R√©sum√©",-1)),e("p",jr,r(c.value.abstract),1)]),c.value.keywords?(n(),d("div",Tr,[l[34]||(l[34]=e("label",{class:"text-sm font-medium text-gray-600"},"Mots-cl√©s",-1)),e("p",Sr,r(c.value.keywords),1)])):x("",!0),e("div",null,[l[35]||(l[35]=e("label",{class:"text-sm font-medium text-gray-600"},"Auteur principal",-1)),e("p",Pr,r(c.value.name),1),e("p",Nr,r(c.value.email),1),c.value.institution?(n(),d("p",Fr,r(c.value.institution),1)):x("",!0),c.value.position?(n(),d("p",Vr,r(c.value.position),1)):x("",!0)]),c.value.message?(n(),d("div",Ir,[l[36]||(l[36]=e("label",{class:"text-sm font-medium text-gray-600"},"Message compl√©mentaire",-1)),e("p",zr,r(c.value.message),1)])):x("",!0),e("div",null,[l[37]||(l[37]=e("label",{class:"text-sm font-medium text-gray-600"},"Date de soumission",-1)),e("p",Lr,r(t(c.value.submissionDate)),1)]),e("div",null,[l[38]||(l[38]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("p",Mr,r(C(c.value.status)),1)]),e("div",Ur,[l[43]||(l[43]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Fichiers",-1)),e("div",Gr,[e("div",null,[l[40]||(l[40]=e("label",{class:"text-sm font-medium text-gray-600 mb-2 block"},"Document (PDF/Word)",-1)),c.value.documentFileUrl||c.value.document_file_url?(n(),d("a",{key:0,href:c.value.documentFileUrl||c.value.document_file_url,target:"_blank",class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors"},[...l[39]||(l[39]=[e("i",{class:"fas fa-file-pdf"},null,-1),e("span",null,"T√©l√©charger le document",-1),e("i",{class:"fas fa-external-link-alt text-xs"},null,-1)])],8,qr)):(n(),d("p",Or,"Aucun document disponible"))]),e("div",null,[l[42]||(l[42]=e("label",{class:"text-sm font-medium text-gray-600 mb-2 block"},"Image du document",-1)),c.value.documentImageUrl||c.value.document_image_url?(n(),d("div",Br,[e("img",{src:c.value.documentImageUrl||c.value.document_image_url,alt:c.value.title,class:"max-w-md rounded-lg border border-gray-200 mb-2",onError:l[4]||(l[4]=o=>o.target.style.display="none")},null,40,Jr),e("a",{href:c.value.documentImageUrl||c.value.document_image_url,target:"_blank",class:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-600 text-white rounded-lg text-xs font-medium hover:bg-gray-700 transition-colors"},[...l[41]||(l[41]=[e("i",{class:"fas fa-download"},null,-1),e("span",null,"T√©l√©charger l'image",-1)])],8,Yr)])):(n(),d("p",Hr,"Aucune image disponible"))])])])])])])):x("",!0)]))}}),Qr={class:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50/20"},Kr={class:"flex"},Xr={class:"h-full flex flex-col overflow-y-auto custom-scrollbar"},Zr={class:"flex-1 p-4 space-y-1"},en=["onClick"],tn={key:0,class:"absolute left-0 top-0 bottom-0 w-1 bg-white rounded-r-full"},sn={class:"font-semibold text-sm tracking-wide flex-1 text-left"},ln={class:"flex-1 ml-0 lg:ml-72 transition-all duration-500"},an={class:"sticky top-0 bg-white/80 backdrop-blur-xl border-b border-slate-200/80 shadow-sm z-30"},on={class:"px-4 sm:px-6 lg:px-8 py-5"},rn={class:"flex items-center justify-between"},nn={class:"flex items-center gap-4"},dn={class:"text-2xl font-bold text-slate-900 tracking-tight"},un={key:0,class:"p-4 sm:p-6 lg:p-8"},cn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8"},pn={class:"relative"},gn={class:"flex items-center justify-between mb-4"},mn={class:"text-3xl font-bold text-slate-900 mb-1.5 tracking-tight"},vn={class:"text-sm font-medium text-slate-600"},bn={class:"bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 mb-8"},xn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},fn=["onClick"],yn={class:"w-12 h-12 rounded-xl bg-blue-100 group-hover:bg-blue-600 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-3"},hn={class:"font-semibold text-slate-900 group-hover:text-blue-600 transition-colors"},wn={class:"p-4 sm:p-6 lg:p-8"},$n=J({__name:"DashboardView",setup(R){pe();const h=me(),g=v(!1),m=v("overview"),$=V(()=>h.menuItems),p=V(()=>h.statsWithChange),c=v([{id:"1",label:"Nouvel √©v√©nement",icon:"fas fa-plus-circle",section:"events"},{id:"2",label:"Nouvelle actualit√©",icon:"fas fa-plus-circle",section:"actualites"},{id:"3",label:"Ajouter photo",icon:"fas fa-plus-circle",section:"gallery"},{id:"4",label:"Voir messages",icon:"fas fa-envelope",section:"newsletter"}]),_=()=>{const S=$.value.find(C=>C.id===m.value);return S?S.label:"Dashboard"},y=async()=>{try{await ce.logout()}catch(S){console.error("Erreur lors de la d√©connexion:",S)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("user"),window.location.href="/"}},i=()=>{window.innerWidth>=1024?g.value=!0:g.value=!1},f=S=>{const C=S.target;window.innerWidth<1024&&g.value&&!C.closest("aside")&&!C.closest("button")&&(g.value=!1)},P=()=>h.loadOverviewStats(),j=()=>h.loadNotificationCounts(),w=()=>h.refreshAll();let u=null;const D=()=>{w()},E=()=>{h.loadOverviewStats(!0)};return Y(async()=>{i(),window.addEventListener("resize",i),document.addEventListener("click",f),await Promise.all([P(),j()]),window.addEventListener("dashboard:update-notifications",D),window.addEventListener("dashboard:update-stats",E),u=window.setInterval(()=>{h.isCacheValid||w()},3e4)}),ue(()=>{window.removeEventListener("resize",i),document.removeEventListener("click",f),window.removeEventListener("dashboard:update-notifications",D),window.removeEventListener("dashboard:update-stats",E),u&&clearInterval(u)}),(S,C)=>(n(),d("div",Qr,[e("div",Kr,[e("aside",{class:z(["fixed left-0 top-0 h-screen w-72 bg-gradient-to-b from-white to-slate-50/50 backdrop-blur-2xl border-r border-slate-200/80 shadow-2xl shadow-slate-900/5 z-40 transition-all duration-500 ease-out",{"-translate-x-full lg:translate-x-0":!g.value,"translate-x-0":g.value}])},[e("div",Xr,[C[4]||(C[4]=U('<div class="p-6 pb-4 border-b border-slate-200/60 bg-gradient-to-r from-blue-600/5 to-indigo-600/5" data-v-c4ddb5bd><div class="flex items-center gap-3 mb-2" data-v-c4ddb5bd><div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-500/30" data-v-c4ddb5bd><i class="fas fa-chart-line text-white text-lg" data-v-c4ddb5bd></i></div><div data-v-c4ddb5bd><h2 class="text-xl font-bold text-slate-900 tracking-tight" data-v-c4ddb5bd>Dashboard</h2><p class="text-xs text-slate-500 font-medium" data-v-c4ddb5bd>CReFF-PME</p></div></div></div>',1)),e("nav",Zr,[(n(!0),d(L,null,M($.value,b=>(n(),d("button",{key:b.id,onClick:a=>{m.value=b.id,g.value=!1},class:"w-full group relative"},[e("div",{class:z(["flex items-center gap-3 px-4 py-3.5 rounded-xl transition-all duration-300 relative overflow-hidden",m.value===b.id?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/40 scale-[1.02]":"text-slate-700 hover:bg-slate-100/80 hover:text-blue-600 hover:translate-x-1"])},[m.value===b.id?(n(),d("div",tn)):x("",!0),e("div",{class:z(["w-5 h-5 flex items-center justify-center transition-transform duration-300",m.value===b.id?"scale-110":"group-hover:scale-110"])},[e("i",{class:z([b.icon,"text-base"])},null,2)],2),e("span",sn,r(b.label),1),b.badge?(n(),d("span",{key:1,class:z(["ml-auto px-2.5 py-1 rounded-full text-xs font-bold min-w-[24px] text-center transition-all duration-300",m.value===b.id?"bg-white/20 text-white backdrop-blur-sm":"bg-red-500 text-white shadow-md shadow-red-500/30 group-hover:scale-110"])},r(b.badge),3)):x("",!0)],2)],8,en))),128))]),e("div",{class:"p-4 pt-2 border-t border-slate-200/60 bg-gradient-to-t from-slate-50/50 to-transparent"},[C[3]||(C[3]=U('<div class="mb-3 px-4" data-v-c4ddb5bd><div class="flex items-center gap-3 p-3 rounded-xl bg-slate-100/60 border border-slate-200/60" data-v-c4ddb5bd><div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-md" data-v-c4ddb5bd><i class="fas fa-user text-white text-sm" data-v-c4ddb5bd></i></div><div class="flex-1 min-w-0" data-v-c4ddb5bd><p class="text-sm font-semibold text-slate-900 truncate" data-v-c4ddb5bd>Administrateur</p><p class="text-xs text-slate-500 truncate" data-v-c4ddb5bd>creff.pme.uk@gmail.com</p></div></div></div>',1)),e("button",{onClick:y,class:"w-full flex items-center gap-3 px-4 py-3.5 rounded-xl text-slate-700 hover:bg-red-50 hover:text-red-600 transition-all duration-300 group border border-transparent hover:border-red-200"},[...C[2]||(C[2]=[e("div",{class:"w-5 h-5 flex items-center justify-center"},[e("i",{class:"fas fa-sign-out-alt text-base group-hover:translate-x-0.5 transition-transform"})],-1),e("span",{class:"font-semibold text-sm"},"D√©connexion",-1)])])])])],2),g.value?(n(),d("div",{key:0,onClick:C[0]||(C[0]=b=>g.value=!1),class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-30 lg:hidden transition-opacity duration-300"})):x("",!0),e("main",ln,[e("header",an,[e("div",on,[e("div",rn,[e("div",nn,[e("button",{onClick:C[1]||(C[1]=b=>g.value=!g.value),class:"lg:hidden p-2.5 rounded-xl text-slate-700 hover:bg-slate-100 transition-all duration-200 hover:scale-105"},[...C[5]||(C[5]=[e("i",{class:"fas fa-bars text-lg"},null,-1)])]),e("div",null,[e("h1",dn,r(_()),1),C[6]||(C[6]=e("p",{class:"text-sm text-slate-500 mt-0.5"},"Gestion et administration",-1))])]),C[7]||(C[7]=U('<div class="flex items-center gap-4" data-v-c4ddb5bd><button class="relative p-2.5 rounded-xl text-slate-600 hover:bg-slate-100 transition-all duration-200 hover:scale-105" data-v-c4ddb5bd><i class="fas fa-bell text-lg" data-v-c4ddb5bd></i><span class="absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white" data-v-c4ddb5bd></span></button><div class="hidden sm:flex items-center gap-3 px-4 py-2 rounded-xl bg-slate-50 border border-slate-200/60" data-v-c4ddb5bd><div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center" data-v-c4ddb5bd><i class="fas fa-user text-white text-xs" data-v-c4ddb5bd></i></div><div data-v-c4ddb5bd><p class="text-sm font-semibold text-slate-900" data-v-c4ddb5bd>Admin</p><p class="text-xs text-slate-500" data-v-c4ddb5bd>En ligne</p></div></div></div>',1))])])]),m.value==="overview"?(n(),d("div",un,[e("div",cn,[(n(!0),d(L,null,M(p.value,b=>(n(),d("div",{key:b.id,class:"group relative bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 hover:shadow-xl hover:shadow-slate-900/10 hover:-translate-y-1 transition-all duration-300 overflow-hidden"},[C[8]||(C[8]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-transparent to-blue-50/0 group-hover:to-blue-50/30 transition-all duration-300 pointer-events-none"},null,-1)),e("div",pn,[e("div",gn,[e("div",{class:z(["w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transition-transform duration-300 group-hover:scale-110 group-hover:rotate-3",b.bgColor])},[e("i",{class:z([b.icon,b.iconColor,"text-2xl"])},null,2)],2),e("span",{class:z(["text-xs font-bold px-2.5 py-1 rounded-full shadow-sm",b.badgeColor])},r(b.change),3)]),e("h3",mn,r(b.value),1),e("p",vn,r(b.label),1)])]))),128))]),e("div",bn,[C[9]||(C[9]=e("div",{class:"flex items-center gap-2 mb-6"},[e("div",{class:"w-1 h-6 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full"}),e("h3",{class:"text-xl font-bold text-slate-900"},"Actions rapides")],-1)),e("div",xn,[(n(!0),d(L,null,M(c.value,b=>(n(),d("button",{key:b.id,onClick:a=>m.value=b.section,class:"group flex items-center gap-4 p-5 rounded-xl border-2 border-slate-200 hover:border-blue-500 hover:bg-gradient-to-br hover:from-blue-50 hover:to-indigo-50 transition-all duration-300 hover:shadow-lg hover:shadow-blue-500/10 hover:-translate-y-0.5"},[e("div",yn,[e("i",{class:z([b.icon,"text-blue-600 group-hover:text-white text-lg transition-colors"])},null,2)]),e("span",hn,r(b.label),1)],8,fn))),128))])])])):x("",!0),e("div",wn,[m.value==="events"?(n(),Q(Ze,{key:0})):x("",!0),m.value==="event-registrations"?(n(),Q(fs,{key:1})):x("",!0),m.value==="actualites"?(n(),Q(tl,{key:2})):x("",!0),m.value==="gallery"?(n(),Q(Tl,{key:3})):x("",!0),m.value==="newsletter"?(n(),Q(sa,{key:4})):x("",!0),m.value==="financing"?(n(),Q(Ha,{key:5})):x("",!0),m.value==="training"?(n(),Q(zo,{key:6})):x("",!0),m.value==="publications"?(n(),Q(Wr,{key:7})):x("",!0)])])])]))}}),_n=ge($n,[["__scopeId","data-v-c4ddb5bd"]]);export{_n as default};
