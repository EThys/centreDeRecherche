import{E as ie,r as b,G as V,q,H as Z,I as X,J as ae,K as ee,L as se,d as J,M as re,o as Y,c as d,e,k as f,t as o,w as K,l as j,v as S,m as B,C as U,O as de,F as L,i as M,A as r,x as I,g as F,P as ue,a as ce,f as pe,Q as W,R as ge,z as ve,B as me}from"./index-JV3vICfI.js";import{t as le}from"./training-registration.service-CBkPYwVH.js";const be=ie("dashboard",()=>{const T=b({events:0,actualities:0,photos:0,messages:0}),h=b({events:0,actualities:0,photos:0,messages:0}),c=b({newsletter:0,financing:0,training:0,publications:0,eventRegistrations:0}),v=b(!1),m=b(null),u=3e4,x=V(()=>{const w=(g,C)=>{if(C===0)return g>0?"+100%":"0%";const E=(g-C)/C*100;return`${E>=0?"+":""}${Math.round(E)}%`};return[{id:"events",label:"√âv√©nements",value:T.value.events.toString(),change:w(T.value.events,h.value.events),icon:"fas fa-calendar-alt",bgColor:"bg-gradient-to-br from-blue-100 to-blue-200",iconColor:"text-blue-600",badgeColor:T.value.events>=h.value.events?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"actualites",label:"Actualit√©s",value:T.value.actualities.toString(),change:w(T.value.actualities,h.value.actualities),icon:"fas fa-newspaper",bgColor:"bg-gradient-to-br from-indigo-100 to-indigo-200",iconColor:"text-indigo-600",badgeColor:T.value.actualities>=h.value.actualities?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"messages",label:"Messages",value:T.value.messages.toString(),change:w(T.value.messages,h.value.messages),icon:"fas fa-envelope",bgColor:"bg-gradient-to-br from-purple-100 to-purple-200",iconColor:"text-purple-600",badgeColor:T.value.messages>=h.value.messages?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"photos",label:"Photos",value:T.value.photos.toString(),change:w(T.value.photos,h.value.photos),icon:"fas fa-images",bgColor:"bg-gradient-to-br from-pink-100 to-pink-200",iconColor:"text-pink-600",badgeColor:T.value.photos>=h.value.photos?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}]}),k=V(()=>[{id:"overview",label:"Vue d'ensemble",icon:"fas fa-home",badge:null},{id:"events",label:"√âv√©nements",icon:"fas fa-calendar-alt",badge:null},{id:"event-registrations",label:"Inscriptions √âv√©nements",icon:"fas fa-user-check",badge:c.value.eventRegistrations>0?c.value.eventRegistrations.toString():null},{id:"actualites",label:"Actualit√©s",icon:"fas fa-newspaper",badge:null},{id:"gallery",label:"Galerie",icon:"fas fa-images",badge:null},{id:"newsletter",label:"Newsletter",icon:"fas fa-envelope",badge:c.value.newsletter>0?c.value.newsletter.toString():null},{id:"financing",label:"Demandes Financement",icon:"fas fa-hand-holding-usd",badge:c.value.financing>0?c.value.financing.toString():null},{id:"training",label:"Inscriptions Formation",icon:"fas fa-user-graduate",badge:c.value.training>0?c.value.training.toString():null},{id:"publications",label:"Demandes Publication",icon:"fas fa-file-alt",badge:c.value.publications>0?c.value.publications.toString():null}]),$=V(()=>m.value?Date.now()-m.value<u:!1),i=async(w=!1)=>{if(!(!w&&$.value&&T.value.events>0)&&!v.value)try{v.value=!0,h.value={...T.value};const[g,C,E,R]=await Promise.allSettled([q.getEvents({limit:1e3}),Z.getActualities({limit:1e3}),X.getPhotos({limit:1e3}),ae.getAllSubscribers({limit:1e3})]);g.status==="fulfilled"?T.value.events=g.value.pagination?.total||g.value.data.length:console.error("Erreur lors du chargement des √©v√©nements:",g.reason),C.status==="fulfilled"?T.value.actualities=C.value.pagination?.total||C.value.data.length:console.error("Erreur lors du chargement des actualit√©s:",C.reason),E.status==="fulfilled"?T.value.photos=E.value.pagination?.total||E.value.data.length:console.error("Erreur lors du chargement des photos:",E.reason),R.status==="fulfilled"?T.value.messages=R.value.data.length:R.status==="rejected"&&console.error("Erreur lors du chargement des messages:",R.reason),m.value=Date.now()}catch(g){console.error("Erreur lors du chargement des stats:",g)}finally{v.value=!1}},y=async(w=!1)=>{if(!(!w&&$.value&&c.value.newsletter>=0))try{const[g,C,E,R,D,p]=await Promise.allSettled([ae.getAllSubscribers({status:"active",limit:1e3}),ee.getRequests({status:"submitted",limit:1e3}),ee.getRequests({status:"under-review",limit:1e3}),le.getRegistrations({status:"pending",limit:1e3}),se.getRequests({status:"pending",limit:1e3}),q.getAllRegistrations({status:"pending",limit:1e3})]);if(g.status==="fulfilled"?c.value.newsletter=g.value.data.length:g.status==="rejected"&&console.error("Erreur lors du chargement des newsletters:",g.reason),C.status==="fulfilled"&&E.status==="fulfilled")c.value.financing=C.value.data.length+E.value.data.length;else{const a=C.status==="rejected"?C.reason:E.status==="rejected"?E.reason:"Erreur inconnue";console.error("Erreur lors du chargement des demandes de financement:",a)}R.status==="fulfilled"?c.value.training=R.value.data.length:R.status==="rejected"&&console.error("Erreur lors du chargement des inscriptions aux formations:",R.reason),D.status==="fulfilled"?c.value.publications=D.value.data.length:D.status==="rejected"&&console.error("Erreur lors du chargement des demandes de publication:",D.reason),p.status==="fulfilled"?c.value.eventRegistrations=p.value.data.length:console.error("Erreur lors du chargement des inscriptions aux √©v√©nements:",p.reason),m.value||(m.value=Date.now())}catch(g){console.error("Erreur lors du chargement des compteurs:",g)}};return{stats:T,previousStats:h,notificationCounts:c,isLoading:v,statsWithChange:x,menuItems:k,isCacheValid:$,loadOverviewStats:i,loadNotificationCounts:y,refreshAll:async()=>{await Promise.all([i(!0),y(!0)])},reset:()=>{T.value={events:0,actualities:0,photos:0,messages:0},h.value={events:0,actualities:0,photos:0,messages:0},c.value={newsletter:0,financing:0,training:0,publications:0,eventRegistrations:0},m.value=null}}}),xe={class:"space-y-6"},fe={class:"flex items-center justify-between"},ye={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4"},he={class:"flex items-center gap-2"},we={key:1,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},$e={class:"text-xl font-bold text-gray-900 mb-6"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_e=["min"],Ce={key:0,class:"mt-3"},De=["src"],Ee={key:1,class:"mt-3"},Ae=["src"],Re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},je=["min"],Te={class:"flex items-center gap-3 mt-2"},Se={class:"flex items-center gap-2 cursor-pointer"},Pe={class:"flex gap-4"},Ne=["disabled"],Fe={key:0,class:"fas fa-spinner fa-spin"},Ve=["disabled"],ze={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Ie={key:0,class:"p-12 text-center"},Le={key:1,class:"overflow-x-auto"},Me={class:"w-full"},Ue={class:"divide-y divide-gray-200"},Ge={class:"px-6 py-4"},qe={class:"font-medium text-gray-900"},Oe={class:"text-sm text-gray-500 mt-1"},Be={class:"px-6 py-4 text-gray-600"},Je={class:"text-xs text-gray-500"},Ye={class:"px-6 py-4"},He={class:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-700"},Qe={class:"px-6 py-4 text-gray-600"},We={class:"px-6 py-4"},Ke={class:"flex items-center justify-center gap-2"},Xe=["onClick","disabled"],Ze=["onClick","disabled"],et={key:0},tt=J({__name:"DashboardEvents",setup(T){const h=re.useToast(),c=b(!1),v=b(null),m=b([]),u=b(!1),x=b(null),k=b(null),$=b(null),i=b({title:"",startDate:"",startTime:"",location:"",description:"",image:"",type:"conference",registrationRequired:!1,endDate:"",endTime:"",address:"",content:""}),y=async()=>{u.value=!0,x.value=null;try{console.log("üîÑ Chargement des √©v√©nements...");const s=await q.getEvents();console.log("‚úÖ R√©ponse re√ßue:",s),s&&s.data?(console.log(`üìä ${s.data.length} √©v√©nement(s) charg√©(s)`),m.value=s.data):(console.warn("‚ö†Ô∏è Aucune donn√©e dans la r√©ponse:",s),m.value=[],x.value="Aucune donn√©e re√ßue du serveur")}catch(s){console.error("‚ùå Erreur compl√®te lors du chargement:",s),console.error("D√©tails:",{message:s.message,status:s.status,errors:s.errors,stack:s.stack}),s.status===500?x.value="Erreur serveur. V√©rifiez que le backend est d√©marr√© et que la base de donn√©es est accessible.":s.status===404?x.value="Endpoint non trouv√©. V√©rifiez la configuration de l'API.":s.status===0||s.message?.includes("fetch")||s.message?.includes("Failed to fetch")?x.value="Impossible de se connecter au serveur. V√©rifiez que le backend est accessible.":x.value=s.message||(s.errors?JSON.stringify(s.errors):"Erreur lors du chargement des √©v√©nements"),m.value=[]}finally{u.value=!1}},P=s=>{const t=s.target;if(t.files&&t.files[0]){k.value=t.files[0];const l=new FileReader;l.onload=n=>{$.value=n.target?.result},l.readAsDataURL(k.value)}},A=async()=>{u.value=!0,x.value=null;try{const s=i.value.startDate?.trim()||"",t=i.value.startTime?.trim()||"";if(!s){x.value="Veuillez entrer une date de d√©but",u.value=!1;return}if(!C(s)){x.value="Veuillez entrer une date de d√©but valide (format YYYY-MM-DD)",u.value=!1;return}if(!t){x.value="Veuillez entrer une heure de d√©but",u.value=!1;return}if(!E(t)){x.value="Veuillez entrer une heure de d√©but valide (format HH:MM)",u.value=!1;return}if(i.value.endDate&&i.value.endDate.trim()!==""){if(!C(i.value.endDate)){x.value="Veuillez entrer une date de fin valide",u.value=!1;return}const z=new Date(i.value.startDate);if(new Date(i.value.endDate)<z){x.value="La date de fin doit √™tre post√©rieure √† la date de d√©but",u.value=!1;return}}if(i.value.endTime&&i.value.endTime.trim()!==""){if(!E(i.value.endTime)){x.value="Veuillez entrer une heure de fin valide (format HH:MM)",u.value=!1;return}if(i.value.endDate===i.value.startDate){const z=i.value.startTime.split(":").map(Number),N=i.value.endTime.split(":").map(Number),H=z[0]*60+z[1];if(N[0]*60+N[1]<=H){x.value="L'heure de fin doit √™tre post√©rieure √† l'heure de d√©but",u.value=!1;return}}}const l=w(s),n=g(t),_={title:i.value.title.trim(),description:i.value.description.trim(),type:i.value.type,status:"upcoming",image:i.value.image||"",startDate:l,startTime:n,location:i.value.location.trim(),registrationRequired:i.value.registrationRequired};i.value.content&&i.value.content.trim()!==""&&(_.content=i.value.content.trim()),i.value.endDate&&i.value.endDate.trim()!==""&&(_.endDate=w(i.value.endDate)),i.value.endTime&&i.value.endTime.trim()!==""&&(_.endTime=g(i.value.endTime)),i.value.address&&i.value.address.trim()!==""&&(_.address=i.value.address.trim()),v.value?(await q.updateEvent(v.value.id,_,k.value||void 0),h.open({message:"‚úÖ √âv√©nement modifi√© avec succ√®s !",type:"success",position:"top-right",duration:5e3})):(await q.createEvent(_,k.value||void 0),h.open({message:"‚úÖ √âv√©nement cr√©√© et publi√© avec succ√®s !",type:"success",position:"top-right",duration:5e3})),await y(),p(),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(s){console.error("Erreur compl√®te:",s);let t="Erreur lors de la sauvegarde de l'√©v√©nement. V√©rifiez la console pour plus de d√©tails.";s.errors?(t=`Erreurs de validation: ${Object.values(s.errors).flat().join(", ")}`,x.value=t):s.message?(t=s.message,x.value=s.message):x.value=t,h.open({message:`‚ùå ${t}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}},w=s=>{if(!s||typeof s!="string")return"";const t=s.trim();if(!t)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const l=new Date(t);if(isNaN(l.getTime())){const N=t.split("-");if(N.length===3){const H=parseInt(N[0],10),G=parseInt(N[1],10),O=parseInt(N[2],10);if(!isNaN(H)&&!isNaN(G)&&!isNaN(O)){const Q=new Date(H,G-1,O);if(Q.getFullYear()===H&&Q.getMonth()===G-1&&Q.getDate()===O)return`${H}-${String(G).padStart(2,"0")}-${String(O).padStart(2,"0")}`}}return""}const n=l.getFullYear(),_=String(l.getMonth()+1).padStart(2,"0"),z=String(l.getDate()).padStart(2,"0");return`${n}-${_}-${z}`}catch(l){return console.warn("Erreur lors de la normalisation de la date:",s,l),""}},g=s=>{if(!s||typeof s!="string")return"";const t=s.trim();if(!t)return"";try{if(/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(t)||/^([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/.test(t))return t.substring(0,5);const l=new Date(t);if(!isNaN(l.getTime())){const n=String(l.getHours()).padStart(2,"0"),_=String(l.getMinutes()).padStart(2,"0");return`${n}:${_}`}return""}catch(l){return console.warn("Erreur lors de la normalisation de l'heure:",s,l),""}},C=s=>{if(!s||typeof s!="string")return!1;const t=s.trim();if(!t)return!1;if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const n=new Date(t);return!isNaN(n.getTime())}const l=new Date(t);return!isNaN(l.getTime())},E=s=>{if(!s||typeof s!="string")return!1;const t=s.trim();return t?/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(t):!1},R=s=>{try{v.value=s,i.value={title:s.title||"",startDate:w(s.startDate),startTime:g(s.startTime),location:s.location||"",description:s.description||"",image:s.image||"",type:s.type||"conference",registrationRequired:s.registrationRequired||!1,endDate:w(s.endDate),endTime:g(s.endTime),address:s.address||"",content:s.content||""},k.value=null,$.value=s.image||null,c.value=!0}catch(t){console.error("Erreur lors de l'√©dition de l'√©v√©nement:",t),x.value="Erreur lors du chargement des donn√©es de l'√©v√©nement"}},D=async s=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cet √©v√©nement ?")){u.value=!0,x.value=null;try{await q.deleteEvent(s),await y(),h.open({message:"‚úÖ √âv√©nement supprim√© avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(t){const l=t.message||"Erreur lors de la suppression de l'√©v√©nement";x.value=l,console.error("Erreur:",t),h.open({message:`‚ùå ${l}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}}},p=()=>{c.value=!1,v.value=null,k.value=null,$.value=null,i.value={title:"",startDate:"",startTime:"",location:"",description:"",image:"",type:"conference",registrationRequired:!1,endDate:"",endTime:"",address:"",content:""}},a=s=>s?new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A";return Y(()=>{y()}),(s,t)=>(r(),d("div",xe,[e("div",fe,[t[17]||(t[17]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion des √âv√©nements"),e("p",{class:"text-gray-600 mt-1"},"Cr√©ez et g√©rez les √©v√©nements du centre")],-1)),e("button",{onClick:t[0]||(t[0]=l=>{c.value=!0,v.value=null}),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...t[16]||(t[16]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nouvel √©v√©nement",-1)])])]),x.value?(r(),d("div",ye,[e("div",he,[t[18]||(t[18]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(x.value),1)]),x.value.includes("serveur")||x.value.includes("connecter")?(r(),d("button",{key:0,onClick:y,class:"mt-3 text-sm text-red-600 hover:text-red-800 underline"}," R√©essayer ")):f("",!0)])):f("",!0),c.value?(r(),d("div",we,[e("h3",$e,o(v.value?"Modifier l'√©v√©nement":"Nouvel √©v√©nement"),1),e("form",{onSubmit:K(A,["prevent"]),class:"space-y-6",novalidate:""},[e("div",ke,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),j(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.value.title=l),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de l'√©v√©nement"},null,512),[[S,i.value.title]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de d√©but *",-1)),j(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>i.value.startDate=l),type:"date",required:"",min:new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:t[3]||(t[3]=l=>i.value.startDate=l.target.value)},null,40,_e),[[S,i.value.startDate]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Heure de d√©but *",-1)),j(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>i.value.startTime=l),type:"time",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:t[5]||(t[5]=l=>i.value.startTime=l.target.value)},null,544),[[S,i.value.startTime]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type *",-1)),j(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>i.value.type=l),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[22]||(t[22]=[U('<option value="conference">Conf√©rence</option><option value="workshop">Atelier</option><option value="seminar">S√©minaire</option><option value="webinar">Webinaire</option><option value="other">Autre</option>',5)])],512),[[B,i.value.type]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Lieu *",-1)),j(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>i.value.location=l),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Lieu de l'√©v√©nement"},null,512),[[S,i.value.location]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image",-1)),e("input",{onChange:P,type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),t[27]||(t[27]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),$.value?(r(),d("div",Ce,[e("img",{src:$.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,De)])):v.value&&i.value.image?(r(),d("div",Ee,[e("img",{src:i.value.image,alt:"Image actuelle",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,Ae),t[25]||(t[25]=e("p",{class:"text-xs text-gray-500 mt-1"},"Image actuelle",-1))])):f("",!0)])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description *",-1)),j(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=l=>i.value.description=l),required:"",rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Description de l'√©v√©nement..."},null,512),[[S,i.value.description]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contenu d√©taill√©",-1)),j(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>i.value.content=l),rows:"6",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Contenu d√©taill√© de l'√©v√©nement..."},null,512),[[S,i.value.content]])]),e("div",Re,[e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de fin",-1)),j(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>i.value.endDate=l),type:"date",min:i.value.startDate||new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:t[11]||(t[11]=l=>i.value.endDate=l.target.value)},null,40,je),[[S,i.value.endDate]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Heure de fin",-1)),j(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>i.value.endTime=l),type:"time",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:t[13]||(t[13]=l=>i.value.endTime=l.target.value)},null,544),[[S,i.value.endTime]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse compl√®te",-1)),j(e("input",{"onUpdate:modelValue":t[14]||(t[14]=l=>i.value.address=l),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Adresse compl√®te..."},null,512),[[S,i.value.address]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Inscription requise",-1)),e("div",Te,[e("label",Se,[j(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>i.value.registrationRequired=l),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[de,i.value.registrationRequired]]),t[33]||(t[33]=e("span",{class:"text-sm text-gray-700"},"Oui",-1))])])])]),e("div",Pe,[e("button",{type:"submit",disabled:u.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[u.value?(r(),d("i",Fe)):f("",!0),e("span",null,o(u.value?"Enregistrement...":v.value?"Modifier":"Cr√©er"),1)],8,Ne),e("button",{type:"button",onClick:p,disabled:u.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,Ve)])],32)])):f("",!0),e("div",ze,[u.value&&m.value.length===0?(r(),d("div",Ie,[...t[35]||(t[35]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des √©v√©nements...",-1)])])):(r(),d("div",Le,[e("table",Me,[t[39]||(t[39]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Titre"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Type"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Lieu"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Ue,[(r(!0),d(L,null,M(m.value,l=>(r(),d("tr",{key:l.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Ge,[e("div",qe,o(l.title),1),e("div",Oe,o(l.description?.substring(0,50))+"...",1)]),e("td",Be,[e("div",null,o(a(l.startDate)),1),e("div",Je,o(l.startTime),1)]),e("td",Ye,[e("span",He,o(l.type),1)]),e("td",Qe,o(l.location),1),e("td",We,[e("div",Ke,[e("button",{onClick:n=>R(l),disabled:u.value,class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50",title:"Modifier"},[...t[36]||(t[36]=[e("i",{class:"fas fa-edit"},null,-1)])],8,Xe),e("button",{onClick:n=>D(l.id),disabled:u.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...t[37]||(t[37]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Ze)])])]))),128)),m.value.length===0&&!u.value?(r(),d("tr",et,[...t[38]||(t[38]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"},[e("i",{class:"fas fa-calendar-times text-4xl mb-3 text-gray-300"}),e("p",null,"Aucun √©v√©nement pour le moment")],-1)])])):f("",!0)])])]))])]))}}),st={class:"space-y-6"},lt={class:"bg-gradient-to-r from-blue-600 via-indigo-600 to-blue-700 rounded-2xl shadow-xl overflow-hidden"},at={class:"p-4 sm:p-6 lg:p-8"},ot={class:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 lg:gap-6"},rt={class:"flex items-center gap-2 sm:gap-4 flex-shrink-0"},nt={class:"bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 sm:px-4 border border-white/20"},it={class:"text-xl sm:text-2xl font-bold text-white"},dt={class:"bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 sm:px-4 border border-white/20"},ut={class:"text-xl sm:text-2xl font-bold text-yellow-300"},ct={class:"mt-4 sm:mt-6 flex flex-col sm:flex-row items-stretch sm:items-end gap-3"},pt={class:"flex-1 min-w-0"},gt={class:"relative"},vt=["value"],mt={class:"flex-1 min-w-0 sm:max-w-[200px]"},bt={class:"relative"},xt={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},ft={class:"flex items-center gap-2"},yt={key:1,class:"text-center py-12"},ht={key:2,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},wt={class:"overflow-x-auto"},$t={class:"w-full min-w-[800px]"},kt={class:"bg-white divide-y divide-gray-100"},_t={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Ct={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Dt={class:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold text-xs sm:text-sm shadow-md flex-shrink-0"},Et={class:"min-w-0 flex-1"},At={class:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate text-sm sm:text-base"},Rt={key:0,class:"text-xs text-gray-500 mt-0.5 truncate"},jt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 min-w-0"},Tt={class:"space-y-1"},St={class:"flex items-center gap-1.5 sm:gap-2 text-gray-700 min-w-0"},Pt={class:"text-xs sm:text-sm truncate"},Nt={key:0,class:"flex items-center gap-1.5 sm:gap-2 text-gray-600"},Ft={class:"text-xs truncate"},Vt={key:1,class:"text-xs text-gray-400"},zt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 hidden md:table-cell min-w-0"},It={class:"flex items-center gap-1.5 sm:gap-2 min-w-0"},Lt={class:"text-xs sm:text-sm text-gray-700 truncate"},Mt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 min-w-0"},Ut=["onMouseenter"],Gt={class:"inline-flex items-center gap-1.5 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 bg-blue-50 rounded-lg border border-blue-200 max-w-full cursor-help"},qt={class:"text-xs sm:text-sm font-medium text-blue-700 truncate"},Ot={key:0,class:"absolute z-[100] bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-xl whitespace-normal max-w-xs text-center pointer-events-none",style:{"min-width":"150px"}},Bt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Jt={class:"flex justify-center"},Yt={class:"hidden sm:inline"},Ht={class:"sm:hidden"},Qt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 hidden lg:table-cell"},Wt={class:"flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-600 whitespace-nowrap"},Kt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Xt={class:"flex items-center justify-center gap-1 sm:gap-1.5 flex-wrap"},Zt=["onClick","disabled"],es=["onClick","disabled"],ts=["onClick"],ss=["onClick","disabled"],ls={key:0},as={class:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},os={class:"p-6 border-b border-gray-200"},rs={class:"flex items-center justify-between"},ns={class:"p-6 space-y-4"},is={class:"text-gray-900 font-semibold"},ds={class:"text-gray-900"},us={key:0},cs={class:"text-gray-900"},ps={key:1},gs={class:"text-gray-900"},vs={key:2},ms={class:"text-gray-900"},bs={class:"text-gray-900"},xs={key:3},fs={class:"text-gray-900"},ys={class:"text-gray-900"},ne=5e3,hs=J({__name:"DashboardEventRegistrations",setup(T){const h=re.useToast(),c=b([]),v=b([]),m=b(!1),u=b(!1),x=b(null),k=b(""),$=b(""),i=b(null),y=b(null),P=V(()=>c.value.filter(s=>s.status==="pending").length),A=b(null),w=async(s=!1)=>{if(!(!s&&A.value&&Date.now()-A.value<ne&&v.value.length>0))try{const t=await q.getEvents({limit:100});v.value=t.data,A.value=Date.now()}catch(t){console.error("Erreur lors du chargement des √©v√©nements:",t)}},g=async(s=!1)=>{if(!(!s&&!k.value&&!$.value&&A.value&&Date.now()-A.value<ne&&c.value.length>0)&&!m.value){m.value=!0,x.value=null;try{const t=await q.getAllRegistrations({eventId:k.value||void 0,status:$.value||void 0,limit:100});c.value=t.data,A.value=Date.now()}catch(t){console.error("Erreur lors du chargement des inscriptions:",t),x.value=t.message||"Erreur lors du chargement des inscriptions",c.value=[]}finally{m.value=!1}}},C=s=>s?v.value.find(l=>l.id==s)?.title||`√âv√©nement #${s}`:"N/A",E=(s,t)=>s?s.length<=t?s:s.substring(0,t)+"...":"-",R=async(s,t)=>{if(confirm(`√ätes-vous s√ªr de vouloir ${t==="confirmed"?"confirmer":"annuler"} cette inscription ?`)){u.value=!0,x.value=null;try{await q.updateRegistrationStatus(s,t),await g(!0);const l={confirmed:"confirm√©e",cancelled:"annul√©e",pending:"mise en attente"};h.open({message:`‚úÖ Inscription ${l[t]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(l){console.error("Erreur lors de la mise √† jour:",l);const n=l.message||"Erreur lors de la mise √† jour";x.value=n,h.open({message:`‚ùå ${n}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}}},D=async s=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette inscription ?")){u.value=!0,x.value=null;try{await q.deleteRegistration(s),await g(!0),h.open({message:"‚úÖ Inscription supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t);const l=t.message||"Erreur lors de la suppression";x.value=l,h.open({message:`‚ùå ${l}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}}},p=s=>{i.value=s},a=s=>{if(!s)return"-";try{const t=new Date(s);return isNaN(t.getTime())?s:t.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}};return Y(async()=>{await Promise.all([w(),g()])}),(s,t)=>(r(),d("div",st,[e("div",lt,[e("div",at,[e("div",ot,[t[9]||(t[9]=U('<div class="flex items-center gap-3 sm:gap-4 min-w-0 flex-1"><div class="w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg flex-shrink-0"><i class="fas fa-user-check text-white text-xl sm:text-2xl"></i></div><div class="min-w-0 flex-1"><h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-white mb-1 truncate">Inscriptions aux √âv√©nements</h2><p class="text-blue-100 text-xs sm:text-sm font-medium truncate">G√©rez et suivez toutes les inscriptions</p></div></div>',1)),e("div",rt,[e("div",nt,[t[7]||(t[7]=e("div",{class:"text-xs text-blue-100 font-medium mb-0.5"},"Total",-1)),e("div",it,o(c.value.length),1)]),e("div",dt,[t[8]||(t[8]=e("div",{class:"text-xs text-blue-100 font-medium mb-0.5"},"En attente",-1)),e("div",ut,o(P.value),1)])])]),e("div",ct,[e("div",pt,[t[12]||(t[12]=e("label",{class:"block text-xs font-semibold text-blue-100 mb-2"},"Filtrer par √©v√©nement",-1)),e("div",gt,[t[11]||(t[11]=e("i",{class:"fas fa-calendar-alt absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-200 text-sm z-10"},null,-1)),j(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>k.value=l),onChange:t[1]||(t[1]=()=>g(!0)),class:"w-full pl-10 pr-4 py-2.5 bg-white/90 backdrop-blur-sm border border-white/30 rounded-xl text-gray-900 font-medium text-sm focus:ring-2 focus:ring-white/50 focus:border-white transition-all shadow-sm appearance-none"},[t[10]||(t[10]=e("option",{value:""},"Tous les √©v√©nements",-1)),(r(!0),d(L,null,M(v.value,l=>(r(),d("option",{key:l.id,value:l.id},o(E(l.title,30)),9,vt))),128))],544),[[B,k.value]])])]),e("div",mt,[t[15]||(t[15]=e("label",{class:"block text-xs font-semibold text-blue-100 mb-2"},"Filtrer par statut",-1)),e("div",bt,[t[14]||(t[14]=e("i",{class:"fas fa-filter absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-200 text-sm z-10"},null,-1)),j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>$.value=l),onChange:t[3]||(t[3]=()=>g(!0)),class:"w-full pl-10 pr-4 py-2.5 bg-white/90 backdrop-blur-sm border border-white/30 rounded-xl text-gray-900 font-medium text-sm focus:ring-2 focus:ring-white/50 focus:border-white transition-all shadow-sm appearance-none"},[...t[13]||(t[13]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"pending"},"En attente",-1),e("option",{value:"confirmed"},"Confirm√©",-1),e("option",{value:"cancelled"},"Annul√©",-1)])],544),[[B,$.value]])])])])])]),x.value?(r(),d("div",xt,[e("div",ft,[t[16]||(t[16]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(x.value),1)])])):f("",!0),m.value?(r(),d("div",yt,[...t[17]||(t[17]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des inscriptions...",-1)])])):(r(),d("div",ht,[e("div",wt,[e("table",$t,[t[29]||(t[29]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-indigo-600"},[e("tr",null,[e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-user text-xs sm:text-sm"}),e("span",{class:"hidden sm:inline"},"Participant"),e("span",{class:"sm:hidden"},"Part.")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-envelope text-xs sm:text-sm"}),e("span",null,"Contact")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap hidden md:table-cell"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-building text-xs sm:text-sm"}),e("span",null,"Organisation")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-calendar-alt text-xs sm:text-sm"}),e("span",{class:"hidden lg:inline"},"√âv√©nement"),e("span",{class:"lg:hidden"},"√âv√©n.")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center justify-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-info-circle text-xs sm:text-sm"}),e("span",null,"Statut")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap hidden lg:table-cell"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-clock text-xs sm:text-sm"}),e("span",null,"Date")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center justify-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-cog text-xs sm:text-sm"}),e("span",{class:"hidden sm:inline"},"Actions")])])])],-1)),e("tbody",kt,[(r(!0),d(L,null,M(c.value,(l,n)=>(r(),d("tr",{key:l.id,class:I(["hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 transition-all duration-200 group",{"bg-gray-50/50":n%2===1}])},[e("td",_t,[e("div",Ct,[e("div",Dt,o((l.firstName?.[0]||"")+(l.lastName?.[0]||"")),1),e("div",Et,[e("div",At,o(l.firstName)+" "+o(l.lastName),1),l.position?(r(),d("div",Rt,o(l.position),1)):f("",!0)])])]),e("td",jt,[e("div",Tt,[e("div",St,[t[18]||(t[18]=e("i",{class:"fas fa-envelope text-xs text-gray-400 flex-shrink-0"},null,-1)),e("span",Pt,o(l.email),1)]),l.phone?(r(),d("div",Nt,[t[19]||(t[19]=e("i",{class:"fas fa-phone text-xs text-gray-400 flex-shrink-0"},null,-1)),e("span",Ft,o(l.phone),1)])):(r(),d("div",Vt,"-"))])]),e("td",zt,[e("div",It,[t[20]||(t[20]=e("i",{class:"fas fa-building text-gray-400 text-xs sm:text-sm flex-shrink-0"},null,-1)),e("span",Lt,o(l.organization||"-"),1)])]),e("td",Mt,[e("div",{class:"relative inline-block",onMouseenter:_=>y.value=l.eventId,onMouseleave:t[4]||(t[4]=_=>y.value=null)},[e("div",Gt,[t[21]||(t[21]=e("i",{class:"fas fa-calendar-alt text-blue-600 text-xs flex-shrink-0"},null,-1)),e("span",qt,o(E(C(l.eventId),16)),1)]),y.value===l.eventId&&C(l.eventId).length>16?(r(),d("div",Ot,[F(o(C(l.eventId))+" ",1),t[22]||(t[22]=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1"},[e("div",{class:"border-4 border-transparent border-t-gray-900"})],-1))])):f("",!0)],40,Ut)]),e("td",Bt,[e("div",Jt,[e("span",{class:I(["px-2 sm:px-3 py-1 sm:py-1.5 rounded-full text-xs font-bold shadow-sm inline-flex items-center gap-1 sm:gap-1.5 whitespace-nowrap",l.status==="confirmed"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":l.status==="cancelled"?"bg-gradient-to-r from-red-500 to-rose-500 text-white":"bg-gradient-to-r from-yellow-400 to-amber-500 text-white"])},[e("i",{class:I(["fas text-xs flex-shrink-0",l.status==="confirmed"?"fa-check-circle":l.status==="cancelled"?"fa-times-circle":"fa-clock"])},null,2),e("span",Yt,o(l.status==="confirmed"?"Confirm√©":l.status==="cancelled"?"Annul√©":"En attente"),1),e("span",Ht,o(l.status==="confirmed"?"OK":l.status==="cancelled"?"Ann.":"Att."),1)],2)])]),e("td",Qt,[e("div",Wt,[t[23]||(t[23]=e("i",{class:"fas fa-clock text-gray-400 text-xs flex-shrink-0"},null,-1)),e("span",null,o(a(l.createdAt)),1)])]),e("td",Kt,[e("div",Xt,[l.status!=="confirmed"?(r(),d("button",{key:0,onClick:_=>R(l.id,"confirmed"),disabled:u.value,class:"p-2 sm:p-2.5 text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Confirmer"},[...t[24]||(t[24]=[e("i",{class:"fas fa-check text-xs sm:text-sm"},null,-1)])],8,Zt)):f("",!0),l.status!=="cancelled"?(r(),d("button",{key:1,onClick:_=>R(l.id,"cancelled"),disabled:u.value,class:"p-2 sm:p-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Annuler"},[...t[25]||(t[25]=[e("i",{class:"fas fa-times text-xs sm:text-sm"},null,-1)])],8,es)):f("",!0),e("button",{onClick:_=>p(l),class:"p-2 sm:p-2.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-110 hover:shadow-md",title:"Voir les d√©tails"},[...t[26]||(t[26]=[e("i",{class:"fas fa-eye text-xs sm:text-sm"},null,-1)])],8,ts),e("button",{onClick:_=>D(l.id),disabled:u.value,class:"p-2 sm:p-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Supprimer"},[...t[27]||(t[27]=[e("i",{class:"fas fa-trash text-xs sm:text-sm"},null,-1)])],8,ss)])])],2))),128)),c.value.length===0?(r(),d("tr",ls,[...t[28]||(t[28]=[e("td",{colspan:"7",class:"px-6 py-16 text-center"},[e("div",{class:"flex flex-col items-center gap-3"},[e("div",{class:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center"},[e("i",{class:"fas fa-inbox text-2xl text-gray-400"})]),e("p",{class:"text-gray-500 font-medium"},"Aucune inscription trouv√©e"),e("p",{class:"text-sm text-gray-400"},"Les inscriptions appara√Ætront ici")])],-1)])])):f("",!0)])])])])),i.value?(r(),d("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[6]||(t[6]=K(l=>i.value=null,["self"]))},[e("div",as,[e("div",os,[e("div",rs,[t[31]||(t[31]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de l'inscription",-1)),e("button",{onClick:t[5]||(t[5]=l=>i.value=null),class:"p-2 text-gray-400 hover:text-gray-600 rounded-lg transition-colors"},[...t[30]||(t[30]=[e("i",{class:"fas fa-times"},null,-1)])])])]),e("div",ns,[e("div",null,[t[32]||(t[32]=e("label",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("p",is,o(i.value.firstName)+" "+o(i.value.lastName),1)]),e("div",null,[t[33]||(t[33]=e("label",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("p",ds,o(i.value.email),1)]),i.value.phone?(r(),d("div",us,[t[34]||(t[34]=e("label",{class:"text-sm font-medium text-gray-600"},"T√©l√©phone",-1)),e("p",cs,o(i.value.phone),1)])):f("",!0),i.value.organization?(r(),d("div",ps,[t[35]||(t[35]=e("label",{class:"text-sm font-medium text-gray-600"},"Organisation",-1)),e("p",gs,o(i.value.organization),1)])):f("",!0),i.value.position?(r(),d("div",vs,[t[36]||(t[36]=e("label",{class:"text-sm font-medium text-gray-600"},"Poste",-1)),e("p",ms,o(i.value.position),1)])):f("",!0),e("div",null,[t[37]||(t[37]=e("label",{class:"text-sm font-medium text-gray-600"},"√âv√©nement",-1)),e("p",bs,o(C(i.value.eventId)),1)]),e("div",null,[t[38]||(t[38]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("span",{class:I(["inline-block px-3 py-1 rounded-full text-xs font-semibold",i.value.status==="confirmed"?"bg-green-100 text-green-800":i.value.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},o(i.value.status==="confirmed"?"Confirm√©":i.value.status==="cancelled"?"Annul√©":"En attente"),3)]),i.value.notes?(r(),d("div",xs,[t[39]||(t[39]=e("label",{class:"text-sm font-medium text-gray-600"},"Notes",-1)),e("p",fs,o(i.value.notes),1)])):f("",!0),e("div",null,[t[40]||(t[40]=e("label",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("p",ys,o(a(i.value.createdAt)),1)])])])])):f("",!0)]))}}),ws={class:"space-y-6"},$s={class:"flex items-center justify-between"},ks={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4"},_s={class:"flex items-center gap-2"},Cs={key:1,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},Ds={class:"text-xl font-bold text-gray-900 mb-6"},Es={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},As={key:0,class:"mt-3"},Rs=["src"],js={key:1,class:"mt-3"},Ts=["src"],Ss={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ps={key:0,class:"mt-3"},Ns=["src"],Fs={key:1,class:"mt-3"},Vs=["src"],zs={class:"flex gap-4"},Is=["disabled"],Ls={key:0},Ms={key:1},Us=["disabled"],Gs={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},qs={class:"overflow-x-auto"},Os={class:"w-full"},Bs={class:"divide-y divide-gray-200"},Js={key:0},Ys={class:"px-6 py-4"},Hs={class:"font-medium text-gray-900"},Qs={class:"px-6 py-4"},Ws={class:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium"},Ks={class:"px-6 py-4 text-gray-600"},Xs={class:"px-6 py-4"},Zs={class:"flex items-center justify-center gap-2"},el=["onClick","disabled"],tl=["onClick","disabled"],sl={key:1},ll=J({__name:"DashboardActualites",setup(T){const h=b(!1),c=b(null),v=b([]),m=b(null),u=b(null),x=b(null),k=b(null),$=b(!1),i=b(null),y=b({title:"",category:"",publishDate:"",summary:"",content:"",image:"",author:"Admin",authorPhoto:"",readTime:5}),P=b(""),A=b(""),w=b(""),g=l=>{const n=l.target;if(n.files&&n.files[0]){m.value=n.files[0];const _=new FileReader;_.onload=z=>{u.value=z.target?.result},_.readAsDataURL(m.value)}},C=l=>{const n=l.target;if(n.files&&n.files[0]){x.value=n.files[0];const _=new FileReader;_.onload=z=>{k.value=z.target?.result},_.readAsDataURL(x.value)}},E=async()=>{$.value=!0,i.value=null;try{console.log("üîÑ Chargement des actualit√©s...");const l=await Z.getActualities({limit:100});console.log("‚úÖ R√©ponse re√ßue:",l),l&&l.data?(console.log(`üìä ${l.data.length} actualit√©(s) charg√©e(s)`),v.value=l.data):(console.warn("‚ö†Ô∏è Aucune donn√©e dans la r√©ponse:",l),v.value=[],i.value="Aucune donn√©e re√ßue du serveur")}catch(l){console.error("‚ùå Erreur compl√®te lors du chargement:",l),console.error("D√©tails:",{message:l.message,status:l.status,errors:l.errors,stack:l.stack}),l.status===500?i.value="Erreur serveur. V√©rifiez que le backend est d√©marr√© et que la base de donn√©es est accessible.":l.status===404?i.value="Endpoint non trouv√©. V√©rifiez la configuration de l'API.":l.status===0||l.message?.includes("fetch")||l.message?.includes("Failed to fetch")?i.value="Impossible de se connecter au serveur. V√©rifiez que le backend est accessible.":i.value=l.message||(l.errors?JSON.stringify(l.errors):"Erreur lors du chargement des actualit√©s"),v.value=[]}finally{$.value=!1}},R=async()=>{$.value=!0,i.value=null;try{const l=P.value.split(`
`).map(N=>N.trim()).filter(N=>N.length>0),n=A.value.split(`
`).map(N=>N.trim()).filter(N=>N.length>0),_=w.value.split(",").map(N=>N.trim()).filter(N=>N.length>0),z={title:y.value.title.trim(),summary:y.value.summary.trim(),content:y.value.content.trim(),category:y.value.category.trim(),publishDate:y.value.publishDate,author:y.value.author.trim(),readTime:y.value.readTime,status:"published",image:y.value.image||"",learningPoints:l,keyPoints:n,tags:_};c.value?await Z.updateActuality(c.value.id,z,m.value||void 0,x.value||void 0):await Z.createActuality(z,m.value||void 0,x.value||void 0),await E(),s()}catch(l){if(console.error("Erreur lors de la sauvegarde:",l),i.value=l.message||"Erreur lors de la sauvegarde",l.errors){const n=Object.values(l.errors).flat().join(", ");i.value=`Erreurs de validation: ${n}`}}finally{$.value=!1}},D=l=>{if(!l||typeof l!="string")return"";const n=l.trim();if(!n)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n;const _=new Date(n);if(isNaN(_.getTime())){const G=n.split("-");if(G.length===3){const O=parseInt(G[0],10),Q=parseInt(G[1],10),te=parseInt(G[2],10);if(!isNaN(O)&&!isNaN(Q)&&!isNaN(te)){const oe=new Date(O,Q-1,te);if(oe.getFullYear()===O&&oe.getMonth()===Q-1&&oe.getDate()===te)return`${O}-${String(Q).padStart(2,"0")}-${String(te).padStart(2,"0")}`}}return""}const z=_.getFullYear(),N=String(_.getMonth()+1).padStart(2,"0"),H=String(_.getDate()).padStart(2,"0");return`${z}-${N}-${H}`}catch(_){return console.warn("Erreur lors de la normalisation de la date:",l,_),""}},p=l=>{try{c.value=l,y.value={title:l.title||"",category:l.category||"",publishDate:D(l.publishDate),summary:l.summary||"",content:l.content||"",image:l.image||"",author:l.author||"Admin",authorPhoto:l.authorPhoto||"",readTime:l.readTime||5},P.value=l.learningPoints?l.learningPoints.join(`
`):"",A.value=l.keyPoints?l.keyPoints.join(`
`):"",w.value=l.tags?l.tags.join(", "):"",m.value=null,u.value=l.image||null,x.value=null,k.value=l.authorPhoto||null,h.value=!0}catch(n){console.error("Erreur lors de l'√©dition de l'actualit√©:",n),i.value="Erreur lors du chargement des donn√©es de l'actualit√©"}},a=async l=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette actualit√© ?")){$.value=!0,i.value=null;try{await Z.deleteActuality(l),await E()}catch(n){console.error("Erreur lors de la suppression:",n),i.value=n.message||"Erreur lors de la suppression"}finally{$.value=!1}}},s=()=>{h.value=!1,c.value=null,m.value=null,u.value=null,x.value=null,k.value=null,P.value="",A.value="",w.value="",y.value={title:"",category:"",publishDate:"",summary:"",content:"",image:"",author:"Admin",authorPhoto:"",readTime:5},i.value=null},t=l=>l?new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A";return Y(()=>{E()}),(l,n)=>(r(),d("div",ws,[e("div",$s,[n[11]||(n[11]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion des Actualit√©s"),e("p",{class:"text-gray-600 mt-1"},"Cr√©ez et g√©rez les actualit√©s du centre")],-1)),e("button",{onClick:n[0]||(n[0]=_=>{h.value=!0,c.value=null}),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...n[10]||(n[10]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nouvelle actualit√©",-1)])])]),i.value?(r(),d("div",ks,[e("div",_s,[n[12]||(n[12]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(i.value),1)]),i.value.includes("serveur")||i.value.includes("connecter")?(r(),d("button",{key:0,onClick:E,class:"mt-3 text-sm text-red-600 hover:text-red-800 underline"}," R√©essayer ")):f("",!0)])):f("",!0),h.value?(r(),d("div",Cs,[e("h3",Ds,o(c.value?"Modifier l'actualit√©":"Nouvelle actualit√©"),1),e("form",{onSubmit:K(R,["prevent"]),class:"space-y-6"},[e("div",Es,[e("div",null,[n[13]||(n[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),j(e("input",{"onUpdate:modelValue":n[1]||(n[1]=_=>y.value.title=_),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de l'actualit√©"},null,512),[[S,y.value.title]])]),e("div",null,[n[15]||(n[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cat√©gorie *",-1)),j(e("select",{"onUpdate:modelValue":n[2]||(n[2]=_=>y.value.category=_),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...n[14]||(n[14]=[U('<option value="">S√©lectionnez...</option><option value="Recherche">Recherche</option><option value="Formation">Formation</option><option value="Partenariat">Partenariat</option><option value="√âv√©nement">√âv√©nement</option>',5)])],512),[[B,y.value.category]])]),e("div",null,[n[17]||(n[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image",-1)),e("input",{onChange:g,type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),n[18]||(n[18]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),u.value?(r(),d("div",As,[e("img",{src:u.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,Rs)])):c.value&&y.value.image?(r(),d("div",js,[e("img",{src:y.value.image,alt:"Image actuelle",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,Ts),n[16]||(n[16]=e("p",{class:"text-xs text-gray-500 mt-1"},"Image actuelle",-1))])):f("",!0)]),e("div",null,[n[19]||(n[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de publication *",-1)),j(e("input",{"onUpdate:modelValue":n[3]||(n[3]=_=>y.value.publishDate=_),type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[S,y.value.publishDate]])])]),e("div",null,[n[20]||(n[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"R√©sum√© *",-1)),j(e("textarea",{"onUpdate:modelValue":n[4]||(n[4]=_=>y.value.summary=_),required:"",rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"R√©sum√© de l'actualit√©..."},null,512),[[S,y.value.summary]])]),e("div",null,[n[21]||(n[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contenu *",-1)),j(e("textarea",{"onUpdate:modelValue":n[5]||(n[5]=_=>y.value.content=_),required:"",rows:"6",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Contenu complet de l'actualit√©..."},null,512),[[S,y.value.content]])]),e("div",null,[n[22]||(n[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ce que vous apprendrez",-1)),n[23]||(n[23]=e("p",{class:"text-xs text-gray-500 mb-2"},"Ajoutez un point par ligne",-1)),j(e("textarea",{"onUpdate:modelValue":n[6]||(n[6]=_=>P.value=_),rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:`Les derni√®res tendances en mati√®re de financement des PME
Comment pr√©parer un dossier de financement convaincant
Les diff√©rentes sources de financement disponibles
Les erreurs √† √©viter lors de la recherche de financement`},null,512),[[S,P.value]])]),e("div",null,[n[24]||(n[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Points cl√©s √† retenir",-1)),n[25]||(n[25]=e("p",{class:"text-xs text-gray-500 mb-2"},"Ajoutez un point par ligne",-1)),j(e("textarea",{"onUpdate:modelValue":n[7]||(n[7]=_=>A.value=_),rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:`Comprendre les m√©canismes de financement adapt√©s aux PME
Identifier les opportunit√©s de croissance et de d√©veloppement
Optimiser la gestion financi√®re de votre entreprise
Acc√©der aux ressources et programmes disponibles`},null,512),[[S,A.value]])]),e("div",null,[n[26]||(n[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mots-cl√©s (tags)",-1)),n[27]||(n[27]=e("p",{class:"text-xs text-gray-500 mb-2"},"S√©parez les tags par des virgules",-1)),j(e("input",{"onUpdate:modelValue":n[8]||(n[8]=_=>w.value=_),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Formation, PME, Financement, RDC"},null,512),[[S,w.value]])]),e("div",Ss,[e("div",null,[n[28]||(n[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Auteur *",-1)),j(e("input",{"onUpdate:modelValue":n[9]||(n[9]=_=>y.value.author=_),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Nom de l'auteur"},null,512),[[S,y.value.author]]),n[29]||(n[29]=e("p",{class:"text-xs text-gray-500 mt-1"},"Nom de la personne qui publie l'actualit√©",-1))]),e("div",null,[n[31]||(n[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Photo de l'auteur",-1)),e("input",{onChange:C,type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),n[32]||(n[32]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),k.value?(r(),d("div",Ps,[e("img",{src:k.value,alt:"Preview auteur",class:"w-24 h-24 object-cover rounded-full border border-gray-200"},null,8,Ns)])):c.value&&y.value.authorPhoto?(r(),d("div",Fs,[e("img",{src:y.value.authorPhoto,alt:"Photo auteur actuelle",class:"w-24 h-24 object-cover rounded-full border border-gray-200"},null,8,Vs),n[30]||(n[30]=e("p",{class:"text-xs text-gray-500 mt-1"},"Photo actuelle",-1))])):f("",!0)])]),e("div",zs,[e("button",{type:"submit",disabled:$.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},[$.value?(r(),d("span",Ls,"Enregistrement...")):(r(),d("span",Ms,o(c.value?"Modifier":"Cr√©er"),1))],8,Is),e("button",{type:"button",onClick:s,disabled:$.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,Us)])],32)])):f("",!0),e("div",Gs,[e("div",qs,[e("table",Os,[n[37]||(n[37]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Titre"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Cat√©gorie"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Bs,[$.value&&v.value.length===0?(r(),d("tr",Js,[...n[33]||(n[33]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Chargement... ",-1)])])):f("",!0),(r(!0),d(L,null,M(v.value,_=>(r(),d("tr",{key:_.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Ys,[e("div",Hs,o(_.title),1)]),e("td",Qs,[e("span",Ws,o(_.category),1)]),e("td",Ks,o(t(_.publishDate)),1),e("td",Xs,[e("div",Zs,[e("button",{onClick:z=>p(_),disabled:$.value,class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...n[34]||(n[34]=[e("i",{class:"fas fa-edit"},null,-1)])],8,el),e("button",{onClick:z=>a(_.id),disabled:$.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...n[35]||(n[35]=[e("i",{class:"fas fa-trash"},null,-1)])],8,tl)])])]))),128)),!$.value&&v.value.length===0?(r(),d("tr",sl,[...n[36]||(n[36]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Aucune actualit√© pour le moment ",-1)])])):f("",!0)])])])])]))}}),al={class:"space-y-6"},ol={class:"flex items-center justify-between"},rl={key:0,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},nl={key:0,class:"mt-3"},il=["src"],dl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ul={class:"relative"},cl={id:"category-list"},pl=["value"],gl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},vl={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},ml={class:"flex items-center gap-2"},bl={class:"flex gap-4"},xl=["disabled"],fl={key:0,class:"fas fa-spinner fa-spin"},yl=["disabled"],hl={key:1,class:"text-center py-12"},wl={key:2,class:"text-center py-12"},$l={class:"text-gray-600 mb-6"},kl={key:3,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},_l={class:"aspect-square overflow-hidden"},Cl=["src","alt"],Dl={class:"p-4"},El={class:"font-medium text-gray-900 mb-1"},Al={class:"text-sm text-gray-500"},Rl={key:0,class:"text-xs text-gray-400 mt-1"},jl={class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"},Tl=["onClick","disabled"],Sl={key:0,class:"col-span-full text-center py-12 text-gray-500"},Pl=5e3,Nl=J({__name:"DashboardGallery",setup(T){const h=re.useToast(),c=b(!1),v=b([]),m=b(null),u=b(null),x=b(!1),k=b(!1),$=b(null),i=b([]),y=b({title:"",description:"",category:"",date:new Date().toISOString().split("T")[0],author:"Admin"}),P=a=>{const s=a.target;if(s.files&&s.files[0]){const t=s.files[0];if(t.size>2*1024*1024){$.value="Le fichier est trop volumineux. Taille maximale: 2MB",s.value="";return}m.value=t,$.value=null;const l=new FileReader;l.onload=n=>{u.value=n.target?.result},l.readAsDataURL(m.value)}},A=b(null),w=async(a=!1)=>{if(!(!a&&A.value&&Date.now()-A.value<Pl&&v.value.length>0)&&!x.value){x.value=!0,$.value=null;try{const s=await X.getPhotos({limit:100});v.value=s.data,A.value=Date.now()}catch(s){console.error("Erreur lors du chargement des photos:",s),$.value=s.message||"Erreur lors du chargement de la galerie",v.value=[]}finally{x.value=!1}}},g=async()=>{try{const s=(await X.getCategories()).map(n=>n.name||n.id),t=["√âv√©nements","√âquipe","Installations","Collaborations","Formations","Conf√©rences","Ateliers","R√©unions","C√©r√©monies","Activit√©s","Projets","Partenariats"],l=new Set([...t,...s]);i.value=Array.from(l).sort(),i.value.length===0&&(i.value=t)}catch(a){console.error("Erreur lors du chargement des cat√©gories:",a),i.value=["√âv√©nements","√âquipe","Installations","Collaborations","Formations","Conf√©rences","Ateliers","R√©unions","C√©r√©monies","Activit√©s","Projets","Partenariats"]}},C=async()=>{if(!m.value){$.value="Veuillez s√©lectionner une image",h.open({message:"‚ö†Ô∏è Veuillez s√©lectionner une image",type:"warning",position:"top-right",duration:4e3});return}if(!y.value.title||!y.value.category){$.value="Veuillez remplir tous les champs obligatoires",h.open({message:"‚ö†Ô∏è Veuillez remplir tous les champs obligatoires",type:"warning",position:"top-right",duration:4e3});return}k.value=!0,$.value=null;try{const a=await X.uploadPhoto(m.value,{title:y.value.title,description:y.value.description||"",category:y.value.category,date:y.value.date,author:y.value.author});await w(!0),p(),h.open({message:"‚úÖ Photo ajout√©e √† la galerie avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(a){console.error("Erreur lors de l'ajout de la photo:",a);const s=a.message||"Erreur lors de l'ajout de la photo";$.value=s,h.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{k.value=!1}},E=async a=>{if(a&&confirm("√ätes-vous s√ªr de vouloir supprimer cette photo ?")){k.value=!0,$.value=null;try{await X.deletePhoto(a),await w(!0),h.open({message:"‚úÖ Photo supprim√©e de la galerie avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(s){console.error("Erreur lors de la suppression de la photo:",s);const t=s.message||"Erreur lors de la suppression de la photo";$.value=t,h.open({message:`‚ùå ${t}`,type:"error",position:"top-right",duration:6e3})}finally{k.value=!1}}},R=a=>a&&X.getImageUrl(a)||"https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",D=a=>{if(!a)return"";try{const s=new Date(a);return isNaN(s.getTime())?a:s.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}catch{return a}},p=()=>{c.value=!1,m.value=null,u.value=null,$.value=null,y.value={title:"",description:"",category:"",date:new Date().toISOString().split("T")[0],author:"Admin"}};return Y(async()=>{await Promise.all([g(),w()])}),(a,s)=>(r(),d("div",al,[e("div",ol,[s[9]||(s[9]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion de la Galerie"),e("p",{class:"text-gray-600 mt-1"},"Ajoutez et g√©rez les photos de la galerie")],-1)),e("button",{onClick:s[0]||(s[0]=t=>c.value=!0),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...s[8]||(s[8]=[e("i",{class:"fas fa-upload"},null,-1),e("span",null,"Ajouter des photos",-1)])])]),c.value?(r(),d("div",rl,[s[19]||(s[19]=e("h3",{class:"text-xl font-bold text-gray-900 mb-6"},"Ajouter une photo",-1)),e("form",{onSubmit:K(C,["prevent"]),class:"space-y-6"},[e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image *",-1)),e("input",{onChange:P,type:"file",accept:"image/*",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),s[11]||(s[11]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),u.value?(r(),d("div",nl,[e("img",{src:u.value,alt:"Preview",class:"w-48 h-48 object-cover rounded-lg border border-gray-200"},null,8,il)])):f("",!0)]),e("div",dl,[e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),j(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>y.value.title=t),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de la photo"},null,512),[[S,y.value.title]])]),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cat√©gorie *",-1)),e("div",ul,[j(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>y.value.category=t),type:"text",list:"category-list",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Tapez ou s√©lectionnez une cat√©gorie...",required:""},null,512),[[S,y.value.category]]),e("datalist",cl,[(r(!0),d(L,null,M(i.value,t=>(r(),d("option",{key:t,value:t},o(t),9,pl))),128))])]),s[14]||(s[14]=e("p",{class:"text-xs text-gray-500 mt-1"},"Exemples: √âv√©nements, √âquipe, Installations, Collaborations, Formations, etc.",-1))])]),e("div",null,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),j(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=t=>y.value.description=t),rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Description de la photo (optionnel)"},null,512),[[S,y.value.description]])]),e("div",gl,[e("div",null,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date *",-1)),j(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>y.value.date=t),type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[S,y.value.date]])]),e("div",null,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Auteur *",-1)),j(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>y.value.author=t),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Nom de l'auteur"},null,512),[[S,y.value.author]])])]),$.value?(r(),d("div",vl,[e("div",ml,[s[18]||(s[18]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o($.value),1)])])):f("",!0),e("div",bl,[e("button",{type:"submit",disabled:k.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[k.value?(r(),d("i",fl)):f("",!0),e("span",null,o(k.value?"Ajout en cours...":"Ajouter"),1)],8,xl),e("button",{type:"button",onClick:p,disabled:k.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50"}," Annuler ",8,yl)])],32)])):f("",!0),x.value&&v.value.length===0?(r(),d("div",hl,[...s[20]||(s[20]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement de la galerie...",-1)])])):$.value&&v.value.length===0?(r(),d("div",wl,[s[21]||(s[21]=e("i",{class:"fas fa-exclamation-triangle text-4xl text-red-600 mb-4"},null,-1)),s[22]||(s[22]=e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Erreur",-1)),e("p",$l,o($.value),1),e("button",{onClick:s[6]||(s[6]=()=>w()),class:"bg-blue-500 hover:bg-blue-600 text-white font-medium px-6 py-3 rounded-lg transition-colors"}," R√©essayer ")])):(r(),d("div",kl,[(r(!0),d(L,null,M(v.value,t=>(r(),d("div",{key:t.id,class:"group relative bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300"},[e("div",_l,[e("img",{src:R(t.image),alt:t.title||"Photo",class:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:s[7]||(s[7]=l=>{l.target.src="https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"})},null,40,Cl)]),e("div",Dl,[e("h3",El,o(t.title||"Sans titre"),1),e("p",Al,o(t.category||"Non cat√©goris√©"),1),t.date?(r(),d("p",Rl,o(D(t.date)),1)):f("",!0)]),e("div",jl,[e("button",{onClick:l=>E(t.id),class:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",disabled:k.value},[...s[23]||(s[23]=[e("i",{class:"fas fa-trash text-sm"},null,-1)])],8,Tl)])]))),128)),!x.value&&v.value.length===0?(r(),d("div",Sl,[...s[24]||(s[24]=[e("i",{class:"fas fa-images text-4xl text-gray-300 mb-4"},null,-1),e("p",null,"Aucune photo dans la galerie",-1)])])):f("",!0)]))]))}}),Fl={class:"space-y-6"},Vl={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},zl={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Il={class:"flex items-center justify-between"},Ll={class:"text-2xl font-bold text-gray-900"},Ml={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Ul={class:"flex items-center justify-between"},Gl={class:"text-2xl font-bold text-gray-900"},ql={key:0,class:"text-center py-12"},Ol={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},Bl={class:"flex items-center gap-2"},Jl={key:2,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Yl={class:"p-4 border-b border-gray-200 flex items-center justify-between"},Hl={class:"overflow-x-auto"},Ql={class:"w-full"},Wl={class:"divide-y divide-gray-200"},Kl={class:"px-6 py-4"},Xl={class:"font-medium text-gray-900"},Zl={class:"px-6 py-4 text-gray-600"},ea={class:"px-6 py-4 text-center"},ta={class:"px-6 py-4"},sa={class:"flex items-center justify-center gap-2"},la=["onClick"],aa={key:0},oa=J({__name:"DashboardNewsletter",setup(T){const h=b(""),c=b([]),v=b(!1),m=b(null),u=V(()=>h.value?c.value.filter(w=>w.email.toLowerCase().includes(h.value.toLowerCase())):c.value),x=V(()=>{const w=new Date,g=new Date(w.getFullYear(),w.getMonth(),1);return c.value.filter(C=>{const E=C.subscribedAt||C.createdAt;return E&&new Date(E)>=g}).length}),k=async()=>{v.value=!0,m.value=null;try{const w=await ae.getAllSubscribers({limit:100,search:h.value||void 0});c.value=w.data,console.log("üìß Newsletter Subscribers charg√©s:",c.value.length)}catch(w){console.error("Erreur lors du chargement des abonn√©s:",w),m.value=w.message||"Erreur lors du chargement des abonn√©s",c.value=[]}finally{v.value=!1}},$=async w=>{if(w&&confirm("√ätes-vous s√ªr de vouloir supprimer cet abonn√© ?"))try{await ae.deleteSubscriber(w),await k()}catch(g){console.error("Erreur lors de la suppression:",g),alert("Erreur lors de la suppression: "+(g.message||"Erreur inconnue"))}},i=()=>{const w=c.value.map(R=>R.email).join(`
`),g=new Blob([w],{type:"text/csv"}),C=window.URL.createObjectURL(g),E=document.createElement("a");E.href=C,E.download="newsletter-subscribers.csv",E.click()},y=w=>w?new Date(w).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A",P=w=>({active:"Actif",unsubscribed:"D√©sabonn√©",pending:"En attente"})[w]||w,A=w=>({active:"bg-green-100 text-green-700",unsubscribed:"bg-red-100 text-red-700",pending:"bg-yellow-100 text-yellow-700"})[w]||"bg-gray-100 text-gray-700";return Y(()=>{k()}),(w,g)=>(r(),d("div",Fl,[g[12]||(g[12]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Abonn√©s Newsletter"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les abonnements √† la newsletter")],-1)),e("div",Vl,[e("div",zl,[e("div",Il,[e("div",null,[g[1]||(g[1]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total abonn√©s",-1)),e("p",Ll,o(c.value.length),1)]),g[2]||(g[2]=e("div",{class:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-users text-blue-600 text-xl"})],-1))])]),e("div",Ml,[e("div",Ul,[e("div",null,[g[3]||(g[3]=e("p",{class:"text-sm text-gray-600 mb-1"},"Ce mois",-1)),e("p",Gl,o(x.value),1)]),g[4]||(g[4]=e("div",{class:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-arrow-up text-green-600 text-xl"})],-1))])]),g[5]||(g[5]=U('<div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600 mb-1">Taux d&#39;ouverture</p><p class="text-2xl font-bold text-gray-900">42%</p></div><div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center"><i class="fas fa-chart-line text-purple-600 text-xl"></i></div></div></div>',1))]),v.value?(r(),d("div",ql,[...g[6]||(g[6]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des abonn√©s...",-1)])])):m.value?(r(),d("div",Ol,[e("div",Bl,[g[7]||(g[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(m.value),1)])])):(r(),d("div",Jl,[e("div",Yl,[j(e("input",{"onUpdate:modelValue":g[0]||(g[0]=C=>h.value=C),type:"text",placeholder:"Rechercher un email...",onInput:k,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[S,h.value]]),e("button",{onClick:i,class:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[...g[8]||(g[8]=[e("i",{class:"fas fa-download"},null,-1),e("span",null,"Exporter",-1)])])]),e("div",Hl,[e("table",Ql,[g[11]||(g[11]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Email"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date d'inscription"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Statut"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Wl,[(r(!0),d(L,null,M(u.value,C=>(r(),d("tr",{key:C.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Kl,[e("div",Xl,o(C.email),1)]),e("td",Zl,o(y(C.subscribedAt||C.createdAt)),1),e("td",ea,[e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",A(C.status)])},o(P(C.status)),3)]),e("td",ta,[e("div",sa,[e("button",{onClick:E=>$(C.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[...g[9]||(g[9]=[e("i",{class:"fas fa-trash"},null,-1)])],8,la)])])]))),128)),u.value.length===0?(r(),d("tr",aa,[...g[10]||(g[10]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Aucun abonn√© trouv√© ",-1)])])):f("",!0)])])])]))]))}}),ra={class:"space-y-6"},na={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},ia={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},da={class:"text-2xl font-bold text-gray-900"},ua={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ca={class:"text-2xl font-bold text-yellow-600"},pa={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ga={class:"text-2xl font-bold text-green-600"},va={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ma={class:"text-2xl font-bold text-blue-600"},ba={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},xa={class:"flex items-center gap-2"},fa={key:1,class:"text-center py-12"},ya={key:2,class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},ha={key:3,class:"space-y-4"},wa={class:"flex items-start justify-between mb-4"},$a={class:"flex-1"},ka={class:"flex items-center gap-3 mb-2"},_a={class:"text-lg font-bold text-gray-900"},Ca={class:"text-gray-600 mb-1"},Da={class:"text-gray-600 mb-1"},Ea={key:0,class:"text-gray-600 mb-1"},Aa={class:"text-gray-600"},Ra={class:"flex gap-2"},ja=["onClick","disabled"],Ta=["onClick","disabled"],Sa=["onClick"],Pa=["onClick","disabled"],Na={class:"bg-gray-50 rounded-lg p-4"},Fa={class:"text-sm text-gray-700"},Va={class:"text-sm text-gray-700 mt-2"},za={class:"text-sm text-gray-700 mt-2"},Ia={key:0,class:"text-center py-12 text-gray-500"},La={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Ma={class:"flex items-center justify-between mb-6"},Ua={class:"space-y-4"},Ga={class:"text-gray-900"},qa={class:"text-gray-600 text-sm"},Oa={key:0,class:"text-gray-600 text-sm"},Ba={class:"text-gray-900"},Ja={class:"text-gray-600 text-sm"},Ya={class:"text-gray-900 font-semibold"},Ha={class:"text-gray-900 mt-2 whitespace-pre-wrap"},Qa={class:"text-gray-900"},Wa={class:"text-gray-900"},Ka=J({__name:"DashboardFinancing",setup(T){const h=b(""),c=b(""),v=b([]),m=b(null),u=b(!1),x=b(null),k=b(!1),$=V(()=>{let p=v.value;if(c.value&&(p=p.filter(a=>a.status===c.value)),h.value){const a=h.value.toLowerCase();p=p.filter(s=>(s.contactFirstName+" "+s.contactLastName).toLowerCase().includes(a)||s.contactEmail.toLowerCase().includes(a)||s.companyName.toLowerCase().includes(a)||s.projectTitle.toLowerCase().includes(a))}return p}),i=V(()=>v.value.filter(p=>p.status==="submitted"||p.status==="under-review").length),y=V(()=>v.value.filter(p=>p.status==="approved"||p.status==="rejected").length),P=V(()=>v.value.filter(p=>{const a=new Date(p.createdAt||""),s=new Date;return s.setDate(s.getDate()-7),a>=s}).length),A=async()=>{u.value=!0,x.value=null;try{const p=await ee.getRequests({status:c.value||void 0,search:h.value||void 0,limit:100});v.value=p.data}catch(p){console.error("Erreur lors du chargement des demandes:",p),x.value=p.message||"Erreur lors du chargement des demandes",v.value=[]}finally{u.value=!1}},w=p=>{m.value=p},g=async p=>{if(p&&confirm("√ätes-vous s√ªr de vouloir supprimer cette demande ?")){k.value=!0,x.value=null;try{await ee.deleteRequest(p),await A()}catch(a){console.error("Erreur lors de la suppression:",a);const s=a.message||"Erreur lors de la suppression";x.value=s,alert(`Erreur: ${s}`)}finally{k.value=!1}}},C=async(p,a)=>{if(p.id){k.value=!0,x.value=null;try{await ee.updateRequestStatus(p.id,a),await A()}catch(s){console.error("Erreur lors de la mise √† jour:",s);const t=s.message||s.errors?.status?.[0]||"Erreur lors de la mise √† jour du statut";x.value=t,alert(`Erreur: ${t}`)}finally{k.value=!1}}},E=p=>({draft:"Brouillon",submitted:"Soumise","under-review":"En r√©vision",approved:"Approuv√©e",rejected:"Refus√©e","on-hold":"En attente"})[p]||p,R=p=>({draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700","under-review":"bg-blue-100 text-blue-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700","on-hold":"bg-orange-100 text-orange-700"})[p]||"bg-gray-100 text-gray-700",D=p=>p?new Date(p).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return Y(()=>{A()}),(p,a)=>(r(),d("div",ra,[a[29]||(a[29]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Demandes de Financement"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les demandes de financement re√ßues")],-1)),e("div",na,[e("div",ia,[a[4]||(a[4]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",da,o(v.value.length),1)]),e("div",ua,[a[5]||(a[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",ca,o(i.value),1)]),e("div",pa,[a[6]||(a[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"Trait√©es",-1)),e("p",ga,o(y.value),1)]),e("div",va,[a[7]||(a[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Nouvelles",-1)),e("p",ma,o(P.value),1)])]),x.value?(r(),d("div",ba,[e("div",xa,[a[8]||(a[8]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(x.value),1)])])):f("",!0),u.value?(r(),d("div",fa,[...a[9]||(a[9]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des demandes...",-1)])])):(r(),d("div",ya,[j(e("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),onChange:A,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...a[10]||(a[10]=[U('<option value="">Tous les statuts</option><option value="submitted">Soumise</option><option value="under-review">En r√©vision</option><option value="approved">Approuv√©e</option><option value="rejected">Refus√©e</option><option value="on-hold">En attente</option>',6)])],544),[[B,c.value]]),j(e("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>h.value=s),onInput:A,type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[S,h.value]])])),u.value?f("",!0):(r(),d("div",ha,[(r(!0),d(L,null,M($.value,s=>(r(),d("div",{key:s.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",wa,[e("div",$a,[e("div",ka,[e("h3",_a,o(s.contactFirstName)+" "+o(s.contactLastName),1),e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",R(s.status)])},o(E(s.status)),3)]),e("p",Ca,[a[11]||(a[11]=e("i",{class:"fas fa-building mr-2"},null,-1)),F(o(s.companyName),1)]),e("p",Da,[a[12]||(a[12]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(o(s.contactEmail),1)]),s.contactPhone?(r(),d("p",Ea,[a[13]||(a[13]=e("i",{class:"fas fa-phone mr-2"},null,-1)),F(o(s.contactPhone),1)])):f("",!0),e("p",Aa,[a[14]||(a[14]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(o(D(s.createdAt)),1)])]),e("div",Ra,[s.status!=="approved"?(r(),d("button",{key:0,onClick:t=>C(s,"approved"),disabled:k.value,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Approuver"},[...a[15]||(a[15]=[e("i",{class:"fas fa-check"},null,-1)])],8,ja)):f("",!0),s.status!=="rejected"?(r(),d("button",{key:1,onClick:t=>C(s,"rejected"),disabled:k.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Rejeter"},[...a[16]||(a[16]=[e("i",{class:"fas fa-times"},null,-1)])],8,Ta)):f("",!0),e("button",{onClick:t=>w(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Voir les d√©tails"},[...a[17]||(a[17]=[e("i",{class:"fas fa-eye"},null,-1)])],8,Sa),e("button",{onClick:t=>g(s.id),disabled:k.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...a[18]||(a[18]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Pa)])]),e("div",Na,[e("p",Fa,[a[19]||(a[19]=e("strong",null,"Projet:",-1)),F(" "+o(s.projectTitle),1)]),e("p",Va,[a[20]||(a[20]=e("strong",null,"Description:",-1)),F(" "+o(s.projectDescription?.substring(0,200))+o(s.projectDescription&&s.projectDescription.length>200?"...":""),1)]),e("p",za,[a[21]||(a[21]=e("strong",null,"Montant demand√©:",-1)),F(" "+o(s.requestedAmount)+" "+o(s.currency),1)])])]))),128)),$.value.length===0?(r(),d("div",Ia," Aucune demande trouv√©e ")):f("",!0)])),m.value?(r(),d("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:a[3]||(a[3]=K(s=>m.value=null,["self"]))},[e("div",La,[e("div",Ma,[a[23]||(a[23]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de la demande",-1)),e("button",{onClick:a[2]||(a[2]=s=>m.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...a[22]||(a[22]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",Ua,[e("div",null,[a[24]||(a[24]=e("label",{class:"text-sm font-medium text-gray-600"},"Contact",-1)),e("p",Ga,o(m.value.contactFirstName)+" "+o(m.value.contactLastName),1),e("p",qa,o(m.value.contactEmail),1),m.value.contactPhone?(r(),d("p",Oa,o(m.value.contactPhone),1)):f("",!0)]),e("div",null,[a[25]||(a[25]=e("label",{class:"text-sm font-medium text-gray-600"},"Entreprise",-1)),e("p",Ba,o(m.value.companyName),1),e("p",Ja,o(m.value.address)+", "+o(m.value.city)+", "+o(m.value.country),1)]),e("div",null,[a[26]||(a[26]=e("label",{class:"text-sm font-medium text-gray-600"},"Projet",-1)),e("p",Ya,o(m.value.projectTitle),1),e("p",Ha,o(m.value.projectDescription),1)]),e("div",null,[a[27]||(a[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Montant demand√©",-1)),e("p",Qa,o(m.value.requestedAmount)+" "+o(m.value.currency),1)]),e("div",null,[a[28]||(a[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Date",-1)),e("p",Wa,o(D(m.value.createdAt)),1)])])])])):f("",!0)]))}}),Xa={class:"space-y-6"},Za={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},eo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},to={class:"text-2xl font-bold text-gray-900"},so={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},lo={class:"text-2xl font-bold text-yellow-600"},ao={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},oo={class:"text-2xl font-bold text-green-600"},ro={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},no={class:"text-2xl font-bold text-blue-600"},io={class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},uo={key:0,class:"text-center py-12"},co={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},po={class:"flex items-center gap-2"},go={key:2,class:"space-y-4"},vo={class:"flex items-start justify-between mb-4"},mo={class:"flex-1"},bo={class:"flex items-center gap-3 mb-2"},xo={class:"text-lg font-bold text-gray-900"},fo={class:"text-gray-600 mb-1"},yo={key:0,class:"text-gray-600 mb-1"},ho={class:"text-gray-600 mb-1"},wo={class:"text-gray-600"},$o={class:"flex gap-2"},ko=["onClick"],_o=["onClick"],Co=["onClick"],Do={key:0,class:"bg-gray-50 rounded-lg p-4"},Eo={class:"text-sm text-gray-700"},Ao={key:0,class:"text-center py-12 text-gray-500"},Ro={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},jo={class:"flex items-center justify-between mb-6"},To={class:"space-y-4"},So={class:"text-gray-900"},Po={class:"text-gray-900"},No={key:0},Fo={class:"text-gray-900"},Vo={class:"text-gray-900"},zo={key:1},Io={class:"text-gray-900 whitespace-pre-wrap"},Lo={class:"text-gray-900"},Mo={class:"text-gray-900"},Uo=J({__name:"DashboardTraining",setup(T){const h=b(""),c=b(""),v=b(""),m=b([]),u=b(null),x=b(!1),k=b(null),$=V(()=>{let a=m.value;if(c.value&&(a=a.filter(s=>s.status===c.value)),v.value&&(a=a.filter(s=>s.program===v.value)),h.value){const s=h.value.toLowerCase();a=a.filter(t=>t.name.toLowerCase().includes(s)||t.email.toLowerCase().includes(s))}return a}),i=V(()=>m.value.filter(a=>a.status==="pending").length),y=V(()=>m.value.filter(a=>a.status==="confirmed").length),P=V(()=>m.value.filter(a=>{const s=new Date(a.registrationDate||""),t=new Date;return t.setDate(t.getDate()-7),s>=t}).length),A=async()=>{x.value=!0,k.value=null;try{const a=await le.getRegistrations({status:c.value||void 0,program:v.value||void 0,search:h.value||void 0,limit:100});m.value=a.data,console.log("üìö Training Registrations charg√©es:",m.value.length)}catch(a){console.error("Erreur lors du chargement des inscriptions:",a),k.value=a.message||"Erreur lors du chargement des inscriptions",m.value=[]}finally{x.value=!1}},w=a=>{u.value=a},g=async a=>{if(!a.id)return;const s=a.status==="pending"?"confirmed":a.status;try{await le.updateRegistration(a.id,{status:s}),await A()}catch(t){console.error("Erreur lors de la mise √† jour du statut:",t),alert("Erreur lors de la mise √† jour du statut: "+(t.message||"Erreur inconnue"))}},C=async a=>{if(a&&confirm("√ätes-vous s√ªr de vouloir supprimer cette inscription ?"))try{await le.deleteRegistration(a),await A()}catch(s){console.error("Erreur lors de la suppression:",s),alert("Erreur lors de la suppression: "+(s.message||"Erreur inconnue"))}},E=a=>({pending:"En attente",confirmed:"Confirm√©e",cancelled:"Annul√©e",completed:"Termin√©e"})[a]||a,R=a=>({pending:"bg-yellow-100 text-yellow-700",confirmed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",completed:"bg-blue-100 text-blue-700"})[a]||"bg-gray-100 text-gray-700",D=a=>({training1:"Formation en Gestion d'Entreprise",training2:"Accompagnement Personnalis√©",training3:"Formation en Entrepreneuriat",training4:"R√©seautage et Partenariats"})[a]||a,p=a=>a?new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return ue([c,v],()=>{A()}),Y(()=>{A()}),(a,s)=>(r(),d("div",Xa,[s[30]||(s[30]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Inscriptions aux Formations"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les inscriptions aux formations d'entrepreneurs")],-1)),e("div",Za,[e("div",eo,[s[5]||(s[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",to,o(m.value.length),1)]),e("div",so,[s[6]||(s[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",lo,o(i.value),1)]),e("div",ao,[s[7]||(s[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Confirm√©es",-1)),e("p",oo,o(y.value),1)]),e("div",ro,[s[8]||(s[8]=e("p",{class:"text-sm text-gray-600 mb-1"},"Nouvelles",-1)),e("p",no,o(P.value),1)])]),e("div",io,[j(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>c.value=t),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...s[9]||(s[9]=[U('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="confirmed">Confirm√©e</option><option value="cancelled">Annul√©e</option><option value="completed">Termin√©e</option>',5)])],512),[[B,c.value]]),j(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>v.value=t),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...s[10]||(s[10]=[U('<option value="">Tous les programmes</option><option value="training1">Formation en Gestion d&#39;Entreprise</option><option value="training2">Accompagnement Personnalis√©</option><option value="training3">Formation en Entrepreneuriat</option><option value="training4">R√©seautage et Partenariats</option>',5)])],512),[[B,v.value]]),j(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>h.value=t),type:"text",placeholder:"Rechercher...",onInput:A,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[S,h.value]])]),x.value?(r(),d("div",uo,[...s[11]||(s[11]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des inscriptions...",-1)])])):k.value?(r(),d("div",co,[e("div",po,[s[12]||(s[12]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(k.value),1)])])):(r(),d("div",go,[(r(!0),d(L,null,M($.value,t=>(r(),d("div",{key:t.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",vo,[e("div",mo,[e("div",bo,[e("h3",xo,o(t.name),1),e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",R(t.status)])},o(E(t.status)),3)]),e("p",fo,[s[13]||(s[13]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(o(t.email),1)]),t.phone?(r(),d("p",yo,[s[14]||(s[14]=e("i",{class:"fas fa-phone mr-2"},null,-1)),F(o(t.phone),1)])):f("",!0),e("p",ho,[s[15]||(s[15]=e("i",{class:"fas fa-graduation-cap mr-2"},null,-1)),F(o(D(t.program)),1)]),e("p",wo,[s[16]||(s[16]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(o(p(t.registrationDate)),1)])]),e("div",$o,[e("button",{onClick:l=>w(t),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[...s[17]||(s[17]=[e("i",{class:"fas fa-eye"},null,-1)])],8,ko),e("button",{onClick:l=>g(t),class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"},[...s[18]||(s[18]=[e("i",{class:"fas fa-check"},null,-1)])],8,_o),e("button",{onClick:l=>C(t.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[...s[19]||(s[19]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Co)])]),t.message?(r(),d("div",Do,[e("p",Eo,[s[20]||(s[20]=e("strong",null,"Message:",-1)),F(" "+o(t.message),1)])])):f("",!0)]))),128)),$.value.length===0?(r(),d("div",Ao," Aucune inscription trouv√©e ")):f("",!0)])),u.value?(r(),d("div",{key:3,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:s[4]||(s[4]=K(t=>u.value=null,["self"]))},[e("div",Ro,[e("div",jo,[s[22]||(s[22]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de l'inscription",-1)),e("button",{onClick:s[3]||(s[3]=t=>u.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...s[21]||(s[21]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",To,[e("div",null,[s[23]||(s[23]=e("label",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("p",So,o(u.value.name),1)]),e("div",null,[s[24]||(s[24]=e("label",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("p",Po,o(u.value.email),1)]),u.value.phone?(r(),d("div",No,[s[25]||(s[25]=e("label",{class:"text-sm font-medium text-gray-600"},"T√©l√©phone",-1)),e("p",Fo,o(u.value.phone),1)])):f("",!0),e("div",null,[s[26]||(s[26]=e("label",{class:"text-sm font-medium text-gray-600"},"Programme",-1)),e("p",Vo,o(D(u.value.program)),1)]),u.value.message?(r(),d("div",zo,[s[27]||(s[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Message",-1)),e("p",Io,o(u.value.message),1)])):f("",!0),e("div",null,[s[28]||(s[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("p",Lo,o(p(u.value.registrationDate)),1)]),e("div",null,[s[29]||(s[29]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("p",Mo,o(E(u.value.status)),1)])])])])):f("",!0)]))}}),Go={class:"space-y-6"},qo={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},Oo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Bo={class:"text-2xl font-bold text-gray-900"},Jo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Yo={class:"text-2xl font-bold text-yellow-600"},Ho={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Qo={class:"text-2xl font-bold text-green-600"},Wo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Ko={class:"text-2xl font-bold text-blue-600"},Xo={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},Zo={class:"flex items-center gap-2"},er={key:1,class:"text-center py-12"},tr={key:2,class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},sr={key:3,class:"space-y-4"},lr={class:"flex items-start justify-between mb-4"},ar={class:"flex-1"},or={class:"flex items-center gap-3 mb-2"},rr={class:"text-lg font-bold text-gray-900"},nr={class:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium"},ir={class:"text-gray-600 mb-1"},dr={class:"text-gray-600 mb-1"},ur={key:0,class:"text-gray-600 mb-1"},cr={class:"text-gray-600"},pr={class:"flex gap-2"},gr=["onClick","disabled"],vr=["onClick","disabled"],mr=["onClick","disabled"],br=["onClick"],xr=["onClick","disabled"],fr={class:"bg-gray-50 rounded-lg p-4"},yr={class:"text-sm text-gray-700 mb-2"},hr={class:"text-sm text-gray-700 mb-2"},wr={class:"text-sm text-gray-700"},$r={key:0,class:"text-center py-12 text-gray-500"},kr={class:"bg-white rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto"},_r={class:"flex items-center justify-between mb-6"},Cr={class:"space-y-4"},Dr={class:"text-gray-900 font-semibold"},Er={class:"text-gray-900"},Ar={class:"text-gray-900"},Rr={class:"text-gray-900"},jr={class:"text-gray-900 whitespace-pre-wrap"},Tr={key:0},Sr={class:"text-gray-900"},Pr={class:"text-gray-900"},Nr={class:"text-gray-600 text-sm"},Fr={key:0,class:"text-gray-600 text-sm"},Vr={key:1,class:"text-gray-600 text-sm"},zr={key:1},Ir={class:"text-gray-900 whitespace-pre-wrap"},Lr={class:"text-gray-900"},Mr={class:"text-gray-900"},Ur=J({__name:"DashboardPublications",setup(T){const h=b(""),c=b(""),v=b(""),m=b([]),u=b(null),x=b(!1),k=b(null),$=b(!1),i=V(()=>{let s=m.value;if(c.value&&(s=s.filter(t=>t.status===c.value)),v.value&&(s=s.filter(t=>t.type===v.value)),h.value){const t=h.value.toLowerCase();s=s.filter(l=>l.name.toLowerCase().includes(t)||l.email.toLowerCase().includes(t)||l.title.toLowerCase().includes(t))}return s}),y=V(()=>m.value.filter(s=>s.status==="pending").length),P=V(()=>m.value.filter(s=>s.status==="accepted").length),A=V(()=>m.value.filter(s=>s.status==="published").length),w=async()=>{x.value=!0,k.value=null;try{const s=await se.getRequests({status:c.value||void 0,type:v.value||void 0,search:h.value||void 0,limit:100});m.value=s.data}catch(s){console.error("Erreur lors du chargement des demandes:",s),k.value=s.message||"Erreur lors du chargement des demandes",m.value=[]}finally{x.value=!1}},g=s=>{u.value=s},C=async(s,t)=>{if(s.id){$.value=!0,k.value=null;try{await se.updateRequestStatus(s.id,t),await w()}catch(l){console.error("Erreur lors de la mise √† jour:",l);const n=l.message||l.errors?.status?.[0]||"Erreur lors de la mise √† jour du statut";k.value=n,alert(`Erreur: ${n}`)}finally{$.value=!1}}},E=async s=>{if(s&&confirm("√ätes-vous s√ªr de vouloir supprimer cette demande ?")){$.value=!0,k.value=null;try{await se.deleteRequest(s),await w()}catch(t){console.error("Erreur lors de la suppression:",t);const l=t.message||"Erreur lors de la suppression";k.value=l,alert(`Erreur: ${l}`)}finally{$.value=!1}}},R=s=>({pending:"En attente","under-review":"En r√©vision",accepted:"Accept√©e",rejected:"Refus√©e",published:"Publi√©e"})[s]||s,D=s=>({pending:"bg-yellow-100 text-yellow-700","under-review":"bg-blue-100 text-blue-700",accepted:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",published:"bg-purple-100 text-purple-700"})[s]||"bg-gray-100 text-gray-700",p=s=>({article:"Article","research-paper":"Document de recherche",book:"Livre",report:"Rapport",other:"Autre"})[s]||s,a=s=>s?new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return Y(()=>{w()}),(s,t)=>(r(),d("div",Go,[t[37]||(t[37]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Demandes de Publication"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les demandes de publication d'articles")],-1)),e("div",qo,[e("div",Oo,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",Bo,o(m.value.length),1)]),e("div",Jo,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",Yo,o(y.value),1)]),e("div",Ho,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Accept√©es",-1)),e("p",Qo,o(P.value),1)]),e("div",Wo,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600 mb-1"},"Publi√©es",-1)),e("p",Ko,o(A.value),1)])]),k.value?(r(),d("div",Xo,[e("div",Zo,[t[9]||(t[9]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(k.value),1)])])):f("",!0),x.value?(r(),d("div",er,[...t[10]||(t[10]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des demandes...",-1)])])):(r(),d("div",tr,[j(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>c.value=l),onChange:w,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[11]||(t[11]=[U('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="under-review">En r√©vision</option><option value="accepted">Accept√©e</option><option value="rejected">Refus√©e</option><option value="published">Publi√©e</option>',6)])],544),[[B,c.value]]),j(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>v.value=l),onChange:w,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[12]||(t[12]=[U('<option value="">Tous les types</option><option value="article">Article</option><option value="research-paper">Document de recherche</option><option value="book">Livre</option><option value="report">Rapport</option><option value="other">Autre</option>',6)])],544),[[B,v.value]]),j(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>h.value=l),onInput:w,type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[S,h.value]])])),x.value?f("",!0):(r(),d("div",sr,[(r(!0),d(L,null,M(i.value,l=>(r(),d("div",{key:l.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",lr,[e("div",ar,[e("div",or,[e("h3",rr,o(l.title),1),e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",D(l.status)])},o(R(l.status)),3),e("span",nr,o(p(l.type)),1)]),e("p",ir,[t[13]||(t[13]=e("i",{class:"fas fa-user mr-2"},null,-1)),F(o(l.name),1)]),e("p",dr,[t[14]||(t[14]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(o(l.email),1)]),l.institution?(r(),d("p",ur,[t[15]||(t[15]=e("i",{class:"fas fa-university mr-2"},null,-1)),F(o(l.institution),1)])):f("",!0),e("p",cr,[t[16]||(t[16]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(o(a(l.submissionDate)),1)])]),e("div",pr,[l.status!=="accepted"?(r(),d("button",{key:0,onClick:n=>C(l,"accepted"),disabled:$.value,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Accepter"},[...t[17]||(t[17]=[e("i",{class:"fas fa-check"},null,-1)])],8,gr)):f("",!0),l.status!=="rejected"?(r(),d("button",{key:1,onClick:n=>C(l,"rejected"),disabled:$.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Rejeter"},[...t[18]||(t[18]=[e("i",{class:"fas fa-times"},null,-1)])],8,vr)):f("",!0),l.status==="accepted"?(r(),d("button",{key:2,onClick:n=>C(l,"published"),disabled:$.value,class:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors disabled:opacity-50",title:"Publier"},[...t[19]||(t[19]=[e("i",{class:"fas fa-check-double"},null,-1)])],8,mr)):f("",!0),e("button",{onClick:n=>g(l),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Voir les d√©tails"},[...t[20]||(t[20]=[e("i",{class:"fas fa-eye"},null,-1)])],8,br),e("button",{onClick:n=>E(l.id),disabled:$.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...t[21]||(t[21]=[e("i",{class:"fas fa-trash"},null,-1)])],8,xr)])]),e("div",fr,[e("p",yr,[t[22]||(t[22]=e("strong",null,"Auteurs:",-1)),F(" "+o(l.authors),1)]),e("p",hr,[t[23]||(t[23]=e("strong",null,"Domaines:",-1)),F(" "+o(l.domains.join(", ")),1)]),e("p",wr,[t[24]||(t[24]=e("strong",null,"R√©sum√©:",-1)),F(" "+o(l.abstract?.substring(0,200))+o(l.abstract&&l.abstract.length>200?"...":""),1)])])]))),128)),i.value.length===0?(r(),d("div",$r," Aucune demande trouv√©e ")):f("",!0)])),u.value?(r(),d("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t[4]||(t[4]=K(l=>u.value=null,["self"]))},[e("div",kr,[e("div",_r,[t[26]||(t[26]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de la demande",-1)),e("button",{onClick:t[3]||(t[3]=l=>u.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...t[25]||(t[25]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",Cr,[e("div",null,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Titre du travail",-1)),e("p",Dr,o(u.value.title),1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Auteurs",-1)),e("p",Er,o(u.value.authors),1)]),e("div",null,[t[29]||(t[29]=e("label",{class:"text-sm font-medium text-gray-600"},"Type",-1)),e("p",Ar,o(p(u.value.type)),1)]),e("div",null,[t[30]||(t[30]=e("label",{class:"text-sm font-medium text-gray-600"},"Domaines de recherche",-1)),e("p",Rr,o(u.value.domains.join(", ")),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"text-sm font-medium text-gray-600"},"R√©sum√©",-1)),e("p",jr,o(u.value.abstract),1)]),u.value.keywords?(r(),d("div",Tr,[t[32]||(t[32]=e("label",{class:"text-sm font-medium text-gray-600"},"Mots-cl√©s",-1)),e("p",Sr,o(u.value.keywords),1)])):f("",!0),e("div",null,[t[33]||(t[33]=e("label",{class:"text-sm font-medium text-gray-600"},"Auteur principal",-1)),e("p",Pr,o(u.value.name),1),e("p",Nr,o(u.value.email),1),u.value.institution?(r(),d("p",Fr,o(u.value.institution),1)):f("",!0),u.value.position?(r(),d("p",Vr,o(u.value.position),1)):f("",!0)]),u.value.message?(r(),d("div",zr,[t[34]||(t[34]=e("label",{class:"text-sm font-medium text-gray-600"},"Message compl√©mentaire",-1)),e("p",Ir,o(u.value.message),1)])):f("",!0),e("div",null,[t[35]||(t[35]=e("label",{class:"text-sm font-medium text-gray-600"},"Date de soumission",-1)),e("p",Lr,o(a(u.value.submissionDate)),1)]),e("div",null,[t[36]||(t[36]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("p",Mr,o(R(u.value.status)),1)])])])])):f("",!0)]))}}),Gr={class:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50/20"},qr={class:"flex"},Or={class:"h-full flex flex-col overflow-y-auto custom-scrollbar"},Br={class:"flex-1 p-4 space-y-1"},Jr=["onClick"],Yr={key:0,class:"absolute left-0 top-0 bottom-0 w-1 bg-white rounded-r-full"},Hr={class:"font-semibold text-sm tracking-wide flex-1 text-left"},Qr={class:"flex-1 ml-0 lg:ml-72 transition-all duration-500"},Wr={class:"sticky top-0 bg-white/80 backdrop-blur-xl border-b border-slate-200/80 shadow-sm z-30"},Kr={class:"px-4 sm:px-6 lg:px-8 py-5"},Xr={class:"flex items-center justify-between"},Zr={class:"flex items-center gap-4"},en={class:"text-2xl font-bold text-slate-900 tracking-tight"},tn={key:0,class:"p-4 sm:p-6 lg:p-8"},sn={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8"},ln={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8"},an={class:"relative"},on={class:"flex items-center justify-between mb-4"},rn={class:"text-3xl font-bold text-slate-900 mb-1.5 tracking-tight"},nn={class:"text-sm font-medium text-slate-600"},dn={class:"bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 mb-8"},un={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},cn=["onClick"],pn={class:"w-12 h-12 rounded-xl bg-blue-100 group-hover:bg-blue-600 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-3"},gn={class:"font-semibold text-slate-900 group-hover:text-blue-600 transition-colors"},vn={class:"p-4 sm:p-6 lg:p-8"},mn=J({__name:"DashboardView",setup(T){ve();const h=be(),c=b(!1),v=b("overview"),m=V(()=>h.menuItems),u=V(()=>h.statsWithChange),x=b([{id:"1",label:"Nouvel √©v√©nement",icon:"fas fa-plus-circle",section:"events"},{id:"2",label:"Nouvelle actualit√©",icon:"fas fa-plus-circle",section:"actualites"},{id:"3",label:"Ajouter photo",icon:"fas fa-plus-circle",section:"gallery"},{id:"4",label:"Voir messages",icon:"fas fa-envelope",section:"newsletter"}]),k=()=>{const R=m.value.find(D=>D.id===v.value);return R?R.label:"Dashboard"},$=async()=>{if(confirm("√ätes-vous s√ªr de vouloir vous d√©connecter ?"))try{await ge.logout()}catch(R){console.error("Erreur lors de la d√©connexion:",R)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("user"),window.location.href="/"}},i=()=>{window.innerWidth>=1024?c.value=!0:c.value=!1},y=R=>{const D=R.target;window.innerWidth<1024&&c.value&&!D.closest("aside")&&!D.closest("button")&&(c.value=!1)},{loadOverviewStats:P,loadNotificationCounts:A,refreshAll:w}=h;let g=null;const C=()=>{w()},E=()=>{P(!0)};return Y(async()=>{i(),window.addEventListener("resize",i),document.addEventListener("click",y),(async()=>{await P(),A().catch(D=>{console.warn("Erreur lors du chargement des notifications:",D)})})(),window.addEventListener("dashboard:update-notifications",C),window.addEventListener("dashboard:update-stats",E),g=window.setInterval(()=>{h.isCacheValid||w()},3e4)}),ce(()=>{window.removeEventListener("resize",i),document.removeEventListener("click",y),window.removeEventListener("dashboard:update-notifications",C),window.removeEventListener("dashboard:update-stats",E),g&&clearInterval(g)}),(R,D)=>(r(),d("div",Gr,[e("div",qr,[e("aside",{class:I(["fixed left-0 top-0 h-screen w-72 bg-gradient-to-b from-white to-slate-50/50 backdrop-blur-2xl border-r border-slate-200/80 shadow-2xl shadow-slate-900/5 z-40 transition-all duration-500 ease-out",{"-translate-x-full lg:translate-x-0":!c.value,"translate-x-0":c.value}])},[e("div",Or,[D[4]||(D[4]=U('<div class="p-6 pb-4 border-b border-slate-200/60 bg-gradient-to-r from-blue-600/5 to-indigo-600/5" data-v-b237463e><div class="flex items-center gap-3 mb-2" data-v-b237463e><div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-500/30" data-v-b237463e><i class="fas fa-chart-line text-white text-lg" data-v-b237463e></i></div><div data-v-b237463e><h2 class="text-xl font-bold text-slate-900 tracking-tight" data-v-b237463e>Dashboard</h2><p class="text-xs text-slate-500 font-medium" data-v-b237463e>CReFF-PME</p></div></div></div>',1)),e("nav",Br,[(r(!0),d(L,null,M(m.value,p=>(r(),d("button",{key:p.id,onClick:a=>{v.value=p.id,c.value=!1},class:"w-full group relative"},[e("div",{class:I(["flex items-center gap-3 px-4 py-3.5 rounded-xl transition-all duration-300 relative overflow-hidden",v.value===p.id?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/40 scale-[1.02]":"text-slate-700 hover:bg-slate-100/80 hover:text-blue-600 hover:translate-x-1"])},[v.value===p.id?(r(),d("div",Yr)):f("",!0),e("div",{class:I(["w-5 h-5 flex items-center justify-center transition-transform duration-300",v.value===p.id?"scale-110":"group-hover:scale-110"])},[e("i",{class:I([p.icon,"text-base"])},null,2)],2),e("span",Hr,o(p.label),1),p.badge?(r(),d("span",{key:1,class:I(["ml-auto px-2.5 py-1 rounded-full text-xs font-bold min-w-[24px] text-center transition-all duration-300",v.value===p.id?"bg-white/20 text-white backdrop-blur-sm":"bg-red-500 text-white shadow-md shadow-red-500/30 group-hover:scale-110"])},o(p.badge),3)):f("",!0)],2)],8,Jr))),128))]),e("div",{class:"p-4 pt-2 border-t border-slate-200/60 bg-gradient-to-t from-slate-50/50 to-transparent mt-auto"},[D[3]||(D[3]=U('<div class="mb-3 px-4" data-v-b237463e><div class="flex items-center gap-3 p-3 rounded-xl bg-slate-100/60 border border-slate-200/60" data-v-b237463e><div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-md" data-v-b237463e><i class="fas fa-user text-white text-sm" data-v-b237463e></i></div><div class="flex-1 min-w-0" data-v-b237463e><p class="text-sm font-semibold text-slate-900 truncate" data-v-b237463e>Administrateur</p><p class="text-xs text-slate-500 truncate" data-v-b237463e>creff.pme.uk@gmail.com</p></div></div></div>',1)),e("button",{onClick:$,class:"w-full flex items-center gap-3 px-4 py-3.5 rounded-xl text-slate-700 hover:bg-red-50 hover:text-red-600 transition-all duration-300 group border border-transparent hover:border-red-200 relative z-10"},[...D[2]||(D[2]=[e("div",{class:"w-5 h-5 flex items-center justify-center"},[e("i",{class:"fas fa-sign-out-alt text-base group-hover:translate-x-0.5 transition-transform"})],-1),e("span",{class:"font-semibold text-sm"},"D√©connexion",-1)])])])])],2),c.value?(r(),d("div",{key:0,onClick:D[0]||(D[0]=p=>c.value=!1),class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-30 lg:hidden transition-opacity duration-300"})):f("",!0),e("main",Qr,[e("header",Wr,[e("div",Kr,[e("div",Xr,[e("div",Zr,[e("button",{onClick:D[1]||(D[1]=p=>c.value=!c.value),class:"lg:hidden p-2.5 rounded-xl text-slate-700 hover:bg-slate-100 transition-all duration-200 hover:scale-105"},[...D[5]||(D[5]=[e("i",{class:"fas fa-bars text-lg"},null,-1)])]),e("div",null,[e("h1",en,o(k()),1),D[6]||(D[6]=e("p",{class:"text-sm text-slate-500 mt-0.5"},"Gestion et administration",-1))])]),D[7]||(D[7]=U('<div class="flex items-center gap-4" data-v-b237463e><button class="relative p-2.5 rounded-xl text-slate-600 hover:bg-slate-100 transition-all duration-200 hover:scale-105" data-v-b237463e><i class="fas fa-bell text-lg" data-v-b237463e></i><span class="absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white" data-v-b237463e></span></button><div class="hidden sm:flex items-center gap-3 px-4 py-2 rounded-xl bg-slate-50 border border-slate-200/60" data-v-b237463e><div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center" data-v-b237463e><i class="fas fa-user text-white text-xs" data-v-b237463e></i></div><div data-v-b237463e><p class="text-sm font-semibold text-slate-900" data-v-b237463e>Admin</p><p class="text-xs text-slate-500" data-v-b237463e>En ligne</p></div></div></div>',1))])])]),v.value==="overview"?(r(),d("div",tn,[pe(h).isLoading&&u.value.length===0?(r(),d("div",sn,[(r(),d(L,null,M(4,p=>e("div",{key:p,class:"group relative bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 animate-pulse"},[...D[8]||(D[8]=[U('<div class="flex items-center justify-between mb-4" data-v-b237463e><div class="w-14 h-14 rounded-2xl bg-gray-200" data-v-b237463e></div><div class="w-12 h-6 bg-gray-200 rounded-full" data-v-b237463e></div></div><div class="h-8 bg-gray-200 rounded mb-2" data-v-b237463e></div><div class="h-4 bg-gray-200 rounded w-2/3" data-v-b237463e></div>',3)])])),64))])):(r(),d("div",ln,[(r(!0),d(L,null,M(u.value,p=>(r(),d("div",{key:p.id,class:"group relative bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 hover:shadow-xl hover:shadow-slate-900/10 hover:-translate-y-1 transition-all duration-300 overflow-hidden"},[D[9]||(D[9]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-transparent to-blue-50/0 group-hover:to-blue-50/30 transition-all duration-300 pointer-events-none"},null,-1)),e("div",an,[e("div",on,[e("div",{class:I(["w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transition-transform duration-300 group-hover:scale-110 group-hover:rotate-3",p.bgColor])},[e("i",{class:I([p.icon,p.iconColor,"text-2xl"])},null,2)],2),e("span",{class:I(["text-xs font-bold px-2.5 py-1 rounded-full shadow-sm",p.badgeColor])},o(p.change),3)]),e("h3",rn,o(p.value),1),e("p",nn,o(p.label),1)])]))),128))])),e("div",dn,[D[10]||(D[10]=e("div",{class:"flex items-center gap-2 mb-6"},[e("div",{class:"w-1 h-6 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full"}),e("h3",{class:"text-xl font-bold text-slate-900"},"Actions rapides")],-1)),e("div",un,[(r(!0),d(L,null,M(x.value,p=>(r(),d("button",{key:p.id,onClick:a=>v.value=p.section,class:"group flex items-center gap-4 p-5 rounded-xl border-2 border-slate-200 hover:border-blue-500 hover:bg-gradient-to-br hover:from-blue-50 hover:to-indigo-50 transition-all duration-300 hover:shadow-lg hover:shadow-blue-500/10 hover:-translate-y-0.5"},[e("div",pn,[e("i",{class:I([p.icon,"text-blue-600 group-hover:text-white text-lg transition-colors"])},null,2)]),e("span",gn,o(p.label),1)],8,cn))),128))])])])):f("",!0),e("div",vn,[v.value==="events"?(r(),W(tt,{key:0})):f("",!0),v.value==="event-registrations"?(r(),W(hs,{key:1})):f("",!0),v.value==="actualites"?(r(),W(ll,{key:2})):f("",!0),v.value==="gallery"?(r(),W(Nl,{key:3})):f("",!0),v.value==="newsletter"?(r(),W(oa,{key:4})):f("",!0),v.value==="financing"?(r(),W(Ka,{key:5})):f("",!0),v.value==="training"?(r(),W(Uo,{key:6})):f("",!0),v.value==="publications"?(r(),W(Ur,{key:7})):f("",!0)])])])]))}}),fn=me(mn,[["__scopeId","data-v-b237463e"]]);export{fn as default};
