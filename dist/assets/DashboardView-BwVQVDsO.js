import{d as J,a as te,r as p,o as Y,c as n,f as e,l as v,t as o,w as W,m as D,v as N,n as B,D as q,G as oe,F as U,j as G,s as O,B as r,H as L,y as I,h as F,I as Z,J as X,K as ae,L as ee,M as re,O as se,b as ne,P as Q,A as ie,C as de}from"./index-BtSL8ZKs.js";import{t as le}from"./training-registration.service-CNpBE-xF.js";const ue={class:"space-y-6"},ce={class:"flex items-center justify-between"},pe={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4"},me={class:"flex items-center gap-2"},ge={key:1,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},ve={class:"text-xl font-bold text-gray-900 mb-6"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},be=["min"],fe={key:0,class:"mt-3"},ye=["src"],he={key:1,class:"mt-3"},we=["src"],$e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_e=["min"],ke={class:"flex items-center gap-3 mt-2"},Ce={class:"flex items-center gap-2 cursor-pointer"},Ee={class:"flex gap-4"},De=["disabled"],Ae={key:0,class:"fas fa-spinner fa-spin"},je=["disabled"],Re={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Te={key:0,class:"p-12 text-center"},Se={key:1,class:"overflow-x-auto"},Ne={class:"w-full"},Pe={class:"divide-y divide-gray-200"},Fe={class:"px-6 py-4"},Ve={class:"font-medium text-gray-900"},ze={class:"text-sm text-gray-500 mt-1"},Ie={class:"px-6 py-4 text-gray-600"},Le={class:"text-xs text-gray-500"},Me={class:"px-6 py-4"},Ue={class:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-700"},Ge={class:"px-6 py-4 text-gray-600"},qe={class:"px-6 py-4"},Oe={class:"flex items-center justify-center gap-2"},Be=["onClick","disabled"],Je=["onClick","disabled"],Ye={key:0},He=J({__name:"DashboardEvents",setup(H){const _=te.useToast(),b=p(!1),g=p(null),h=p([]),u=p(!1),d=p(null),x=p(null),m=p(null),i=p({title:"",startDate:"",startTime:"",location:"",description:"",image:"",type:"conference",registrationRequired:!1,endDate:"",endTime:"",address:"",content:""}),$=async()=>{u.value=!0,d.value=null;try{console.log("üîÑ Chargement des √©v√©nements...");const t=await O.getEvents();console.log("‚úÖ R√©ponse re√ßue:",t),t&&t.data?(console.log(`üìä ${t.data.length} √©v√©nement(s) charg√©(s)`),h.value=t.data):(console.warn("‚ö†Ô∏è Aucune donn√©e dans la r√©ponse:",t),h.value=[],d.value="Aucune donn√©e re√ßue du serveur")}catch(t){console.error("‚ùå Erreur compl√®te lors du chargement:",t),console.error("D√©tails:",{message:t.message,status:t.status,errors:t.errors,stack:t.stack}),t.status===500?d.value="Erreur serveur. V√©rifiez que le backend est d√©marr√© et que la base de donn√©es est accessible.":t.status===404?d.value="Endpoint non trouv√©. V√©rifiez la configuration de l'API.":t.status===0||t.message?.includes("fetch")||t.message?.includes("Failed to fetch")?d.value="Impossible de se connecter au serveur. V√©rifiez que le backend est accessible.":d.value=t.message||(t.errors?JSON.stringify(t.errors):"Erreur lors du chargement des √©v√©nements"),h.value=[]}finally{u.value=!1}},R=t=>{const s=t.target;if(s&&s.files&&s.files[0]){x.value=s.files[0];const a=new FileReader;a.onload=c=>{m.value=c.target?.result},a.readAsDataURL(x.value)}},T=async()=>{u.value=!0,d.value=null;try{const t=i.value.startDate?.trim()||"",s=i.value.startTime?.trim()||"";if(!t){d.value="Veuillez entrer une date de d√©but",u.value=!1;return}if(!A(t)){d.value="Veuillez entrer une date de d√©but valide (format YYYY-MM-DD)",u.value=!1;return}if(!s){d.value="Veuillez entrer une heure de d√©but",u.value=!1;return}if(!j(s)){d.value="Veuillez entrer une heure de d√©but valide (format HH:MM)",u.value=!1;return}if(i.value.endDate&&i.value.endDate.trim()!==""){if(!A(i.value.endDate)){d.value="Veuillez entrer une date de fin valide",u.value=!1;return}const M=new Date(i.value.startDate);if(new Date(i.value.endDate)<M){d.value="La date de fin doit √™tre post√©rieure √† la date de d√©but",u.value=!1;return}}if(i.value.endTime&&i.value.endTime.trim()!==""){if(!j(i.value.endTime)){d.value="Veuillez entrer une heure de fin valide (format HH:MM)",u.value=!1;return}if(i.value.endDate===i.value.startDate){const M=i.value.startTime.split(":").map(Number),z=i.value.endTime.split(":").map(Number),y=M[0]*60+M[1];if(z[0]*60+z[1]<=y){d.value="L'heure de fin doit √™tre post√©rieure √† l'heure de d√©but",u.value=!1;return}}}const a=w(t),c=f(s),S={title:i.value.title.trim(),description:i.value.description.trim(),type:i.value.type,status:"upcoming",startDate:a,startTime:c,location:i.value.location.trim(),registrationRequired:i.value.registrationRequired,image:i.value.image||""};i.value.content&&i.value.content.trim()!==""&&(S.content=i.value.content.trim()),i.value.endDate&&i.value.endDate.trim()!==""&&(S.endDate=w(i.value.endDate)),i.value.endTime&&i.value.endTime.trim()!==""&&(S.endTime=f(i.value.endTime)),i.value.address&&i.value.address.trim()!==""&&(S.address=i.value.address.trim()),g.value?(await O.updateEvent(g.value.id,S,x.value||void 0),_.open({message:"‚úÖ √âv√©nement modifi√© avec succ√®s !",type:"success",position:"top-right",duration:5e3})):(await O.createEvent(S,x.value||void 0),_.open({message:"‚úÖ √âv√©nement cr√©√© et publi√© avec succ√®s !",type:"success",position:"top-right",duration:5e3})),await $(),k(),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(t){console.error("Erreur compl√®te:",t);let s="Erreur lors de la sauvegarde de l'√©v√©nement. V√©rifiez la console pour plus de d√©tails.";t.errors?(s=`Erreurs de validation: ${Object.values(t.errors).flat().join(", ")}`,d.value=s):t.message?(s=t.message,d.value=t.message):d.value=s,_.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}},w=t=>{if(!t||typeof t!="string")return"";const s=t.trim();if(!s)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(s))return s;const a=new Date(s);if(isNaN(a.getTime())){const z=s.split("-");if(z.length===3){const y=parseInt(z[0],10),C=parseInt(z[1],10),E=parseInt(z[2],10);if(!isNaN(y)&&!isNaN(C)&&!isNaN(E)){const K=new Date(y,C-1,E);if(K.getFullYear()===y&&K.getMonth()===C-1&&K.getDate()===E)return`${y}-${String(C).padStart(2,"0")}-${String(E).padStart(2,"0")}`}}return""}const c=a.getFullYear(),S=String(a.getMonth()+1).padStart(2,"0"),M=String(a.getDate()).padStart(2,"0");return`${c}-${S}-${M}`}catch(a){return console.warn("Erreur lors de la normalisation de la date:",t,a),""}},f=t=>{if(!t||typeof t!="string")return"";const s=t.trim();if(!s)return"";try{if(/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(s)||/^([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/.test(s))return s.substring(0,5);const a=new Date(s);if(!isNaN(a.getTime())){const c=String(a.getHours()).padStart(2,"0"),S=String(a.getMinutes()).padStart(2,"0");return`${c}:${S}`}return""}catch(a){return console.warn("Erreur lors de la normalisation de l'heure:",t,a),""}},A=t=>{if(!t||typeof t!="string")return!1;const s=t.trim();if(!s)return!1;if(/^\d{4}-\d{2}-\d{2}$/.test(s)){const c=new Date(s);return!isNaN(c.getTime())}const a=new Date(s);return!isNaN(a.getTime())},j=t=>{if(!t||typeof t!="string")return!1;const s=t.trim();return s?/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(s):!1},V=t=>{try{g.value=t,i.value={title:t.title||"",startDate:w(t.startDate),startTime:f(t.startTime),location:t.location||"",description:t.description||"",image:t.image||"",type:t.type||"conference",registrationRequired:t.registrationRequired||!1,endDate:w(t.endDate),endTime:f(t.endTime),address:t.address||"",content:t.content||""},x.value=null,m.value=t.image||null,b.value=!0}catch(s){console.error("Erreur lors de l'√©dition de l'√©v√©nement:",s),d.value="Erreur lors du chargement des donn√©es de l'√©v√©nement"}},P=async t=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cet √©v√©nement ?")){u.value=!0,d.value=null;try{await O.deleteEvent(t),await $(),_.open({message:"‚úÖ √âv√©nement supprim√© avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(s){const a=s.message||"Erreur lors de la suppression de l'√©v√©nement";d.value=a,console.error("Erreur:",s),_.open({message:`‚ùå ${a}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}}},k=()=>{b.value=!1,g.value=null,x.value=null,m.value=null,i.value={title:"",startDate:"",startTime:"",location:"",description:"",image:"",type:"conference",registrationRequired:!1,endDate:"",endTime:"",address:"",content:""}},l=t=>t?new Date(t).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A";return Y(()=>{$()}),(t,s)=>(r(),n("div",ue,[e("div",ce,[s[18]||(s[18]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion des √âv√©nements"),e("p",{class:"text-gray-600 mt-1"},"Cr√©ez et g√©rez les √©v√©nements du centre")],-1)),e("button",{onClick:s[0]||(s[0]=a=>{b.value=!0,g.value=null}),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...s[17]||(s[17]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nouvel √©v√©nement",-1)])])]),d.value?(r(),n("div",pe,[e("div",me,[s[19]||(s[19]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(d.value),1)]),d.value.includes("serveur")||d.value.includes("connecter")?(r(),n("button",{key:0,onClick:$,class:"mt-3 text-sm text-red-600 hover:text-red-800 underline"}," R√©essayer ")):v("",!0)])):v("",!0),b.value?(r(),n("div",ge,[e("h3",ve,o(g.value?"Modifier l'√©v√©nement":"Nouvel √©v√©nement"),1),e("form",{onSubmit:W(T,["prevent"]),class:"space-y-6",novalidate:""},[e("div",xe,[e("div",null,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),D(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>i.value.title=a),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de l'√©v√©nement"},null,512),[[N,i.value.title]])]),e("div",null,[s[21]||(s[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de d√©but *",-1)),D(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>i.value.startDate=a),type:"date",required:"",min:new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[3]||(s[3]=a=>i.value.startDate=a.target.value)},null,40,be),[[N,i.value.startDate]])]),e("div",null,[s[22]||(s[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Heure de d√©but *",-1)),D(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>i.value.startTime=a),type:"time",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[5]||(s[5]=a=>i.value.startTime=a.target.value)},null,544),[[N,i.value.startTime]])]),e("div",null,[s[24]||(s[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type *",-1)),D(e("select",{"onUpdate:modelValue":s[6]||(s[6]=a=>i.value.type=a),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...s[23]||(s[23]=[q('<option value="conference">Conf√©rence</option><option value="workshop">Atelier</option><option value="seminar">S√©minaire</option><option value="webinar">Webinaire</option><option value="other">Autre</option>',5)])],512),[[B,i.value.type]])]),e("div",null,[s[25]||(s[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Lieu *",-1)),D(e("input",{"onUpdate:modelValue":s[7]||(s[7]=a=>i.value.location=a),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Lieu de l'√©v√©nement"},null,512),[[N,i.value.location]])]),e("div",null,[s[27]||(s[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image",-1)),e("input",{onChange:s[8]||(s[8]=a=>R(a)),type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),s[28]||(s[28]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),m.value?(r(),n("div",fe,[e("img",{src:m.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,ye)])):g.value&&i.value.image?(r(),n("div",he,[e("img",{src:i.value.image,alt:"Image actuelle",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,we),s[26]||(s[26]=e("p",{class:"text-xs text-gray-500 mt-1"},"Image actuelle",-1))])):v("",!0)])]),e("div",null,[s[29]||(s[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description *",-1)),D(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=a=>i.value.description=a),required:"",rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Description de l'√©v√©nement..."},null,512),[[N,i.value.description]])]),e("div",null,[s[30]||(s[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contenu d√©taill√©",-1)),D(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=a=>i.value.content=a),rows:"6",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Contenu d√©taill√© de l'√©v√©nement..."},null,512),[[N,i.value.content]])]),e("div",$e,[e("div",null,[s[31]||(s[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de fin",-1)),D(e("input",{"onUpdate:modelValue":s[11]||(s[11]=a=>i.value.endDate=a),type:"date",min:i.value.startDate||new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[12]||(s[12]=a=>i.value.endDate=a.target.value)},null,40,_e),[[N,i.value.endDate]])]),e("div",null,[s[32]||(s[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Heure de fin",-1)),D(e("input",{"onUpdate:modelValue":s[13]||(s[13]=a=>i.value.endTime=a),type:"time",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",onInput:s[14]||(s[14]=a=>i.value.endTime=a.target.value)},null,544),[[N,i.value.endTime]])]),e("div",null,[s[33]||(s[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse compl√®te",-1)),D(e("input",{"onUpdate:modelValue":s[15]||(s[15]=a=>i.value.address=a),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Adresse compl√®te..."},null,512),[[N,i.value.address]])]),e("div",null,[s[35]||(s[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Inscription requise",-1)),e("div",ke,[e("label",Ce,[D(e("input",{"onUpdate:modelValue":s[16]||(s[16]=a=>i.value.registrationRequired=a),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[oe,i.value.registrationRequired]]),s[34]||(s[34]=e("span",{class:"text-sm text-gray-700"},"Oui",-1))])])])]),e("div",Ee,[e("button",{type:"submit",disabled:u.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[u.value?(r(),n("i",Ae)):v("",!0),e("span",null,o(u.value?"Enregistrement...":g.value?"Modifier":"Cr√©er"),1)],8,De),e("button",{type:"button",onClick:k,disabled:u.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,je)])],32)])):v("",!0),e("div",Re,[u.value&&h.value.length===0?(r(),n("div",Te,[...s[36]||(s[36]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des √©v√©nements...",-1)])])):(r(),n("div",Se,[e("table",Ne,[s[40]||(s[40]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Titre"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Type"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Lieu"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Pe,[(r(!0),n(U,null,G(h.value,a=>(r(),n("tr",{key:a.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Fe,[e("div",Ve,o(a.title),1),e("div",ze,o(a.description?.substring(0,50))+"...",1)]),e("td",Ie,[e("div",null,o(l(a.startDate)),1),e("div",Le,o(a.startTime),1)]),e("td",Me,[e("span",Ue,o(a.type),1)]),e("td",Ge,o(a.location),1),e("td",qe,[e("div",Oe,[e("button",{onClick:c=>V(a),disabled:u.value,class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50",title:"Modifier"},[...s[37]||(s[37]=[e("i",{class:"fas fa-edit"},null,-1)])],8,Be),e("button",{onClick:c=>P(a.id),disabled:u.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...s[38]||(s[38]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Je)])])]))),128)),h.value.length===0&&!u.value?(r(),n("tr",Ye,[...s[39]||(s[39]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"},[e("i",{class:"fas fa-calendar-times text-4xl mb-3 text-gray-300"}),e("p",null,"Aucun √©v√©nement pour le moment")],-1)])])):v("",!0)])])]))])]))}}),Qe={class:"space-y-6"},We={class:"bg-gradient-to-r from-blue-600 via-indigo-600 to-blue-700 rounded-2xl shadow-xl overflow-hidden"},Ke={class:"p-4 sm:p-6 lg:p-8"},Xe={class:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 lg:gap-6"},Ze={class:"flex items-center gap-2 sm:gap-4 flex-shrink-0"},et={class:"bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 sm:px-4 border border-white/20"},tt={class:"text-xl sm:text-2xl font-bold text-white"},st={class:"bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 sm:px-4 border border-white/20"},lt={class:"text-xl sm:text-2xl font-bold text-yellow-300"},at={class:"mt-4 sm:mt-6 flex flex-col sm:flex-row items-stretch sm:items-end gap-3"},ot={class:"flex-1 min-w-0"},rt={class:"relative"},nt=["value"],it={class:"flex-1 min-w-0 sm:max-w-[200px]"},dt={class:"relative"},ut={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},ct={class:"flex items-center gap-2"},pt={key:1,class:"text-center py-12"},mt={key:2,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},gt={class:"overflow-x-auto"},vt={class:"w-full min-w-[800px]"},xt={class:"bg-white divide-y divide-gray-100"},bt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},ft={class:"flex items-center gap-2 sm:gap-3 min-w-0"},yt={class:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold text-xs sm:text-sm shadow-md flex-shrink-0"},ht={class:"min-w-0 flex-1"},wt={class:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate text-sm sm:text-base"},$t={key:0,class:"text-xs text-gray-500 mt-0.5 truncate"},_t={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 min-w-0"},kt={class:"space-y-1"},Ct={class:"flex items-center gap-1.5 sm:gap-2 text-gray-700 min-w-0"},Et={class:"text-xs sm:text-sm truncate"},Dt={key:0,class:"flex items-center gap-1.5 sm:gap-2 text-gray-600"},At={class:"text-xs truncate"},jt={key:1,class:"text-xs text-gray-400"},Rt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 hidden md:table-cell min-w-0"},Tt={class:"flex items-center gap-1.5 sm:gap-2 min-w-0"},St={class:"text-xs sm:text-sm text-gray-700 truncate"},Nt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 min-w-0"},Pt=["onMouseenter"],Ft={class:"inline-flex items-center gap-1.5 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 bg-blue-50 rounded-lg border border-blue-200 max-w-full cursor-help"},Vt={class:"text-xs sm:text-sm font-medium text-blue-700 truncate"},zt={key:0,class:"absolute z-[100] bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-xl whitespace-normal max-w-xs text-center pointer-events-none",style:{"min-width":"150px"}},It={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Lt={class:"flex justify-center"},Mt={class:"hidden sm:inline"},Ut={class:"sm:hidden"},Gt={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 hidden lg:table-cell"},qt={class:"flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-600 whitespace-nowrap"},Ot={class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4"},Bt={class:"flex items-center justify-center gap-1 sm:gap-1.5 flex-wrap"},Jt=["onClick","disabled"],Yt=["onClick","disabled"],Ht=["onClick"],Qt=["onClick","disabled"],Wt={key:0},Kt={class:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Xt={class:"p-6 border-b border-gray-200"},Zt={class:"flex items-center justify-between"},es={class:"p-6 space-y-4"},ts={class:"text-gray-900 font-semibold"},ss={class:"text-gray-900"},ls={key:0},as={class:"text-gray-900"},os={key:1},rs={class:"text-gray-900"},ns={key:2},is={class:"text-gray-900"},ds={class:"text-gray-900"},us={key:3},cs={class:"text-gray-900"},ps={class:"text-gray-900"},ms=J({__name:"DashboardEventRegistrations",setup(H){const _=te.useToast(),b=p([]),g=p([]),h=p(!1),u=p(!1),d=p(null),x=p(""),m=p(""),i=p(null),$=p(null),R=L(()=>b.value.filter(l=>l.status==="pending").length),T=async()=>{try{const l=await O.getEvents({limit:100});g.value=l.data}catch(l){console.error("Erreur lors du chargement des √©v√©nements:",l)}},w=async()=>{h.value=!0,d.value=null;try{const l=await O.getAllRegistrations({eventId:x.value||void 0,status:m.value||void 0,limit:100});b.value=l.data}catch(l){console.error("Erreur lors du chargement des inscriptions:",l),d.value=l.message||"Erreur lors du chargement des inscriptions",b.value=[]}finally{h.value=!1}},f=l=>l?g.value.find(s=>s.id==l)?.title||`√âv√©nement #${l}`:"N/A",A=(l,t)=>l?l.length<=t?l:l.substring(0,t)+"...":"-",j=async(l,t)=>{if(confirm(`√ätes-vous s√ªr de vouloir ${t==="confirmed"?"confirmer":"annuler"} cette inscription ?`)){u.value=!0,d.value=null;try{await O.updateRegistrationStatus(l,t),await w();const s={confirmed:"confirm√©e",cancelled:"annul√©e",pending:"mise en attente"};_.open({message:`‚úÖ Inscription ${s[t]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(s){console.error("Erreur lors de la mise √† jour:",s);const a=s.message||"Erreur lors de la mise √† jour";d.value=a,_.open({message:`‚ùå ${a}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}}},V=async l=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette inscription ?")){u.value=!0,d.value=null;try{await O.deleteRegistration(l),await w(),_.open({message:"‚úÖ Inscription supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t);const s=t.message||"Erreur lors de la suppression";d.value=s,_.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{u.value=!1}}},P=l=>{i.value=l},k=l=>{if(!l)return"-";try{const t=new Date(l);return isNaN(t.getTime())?l:t.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return l}};return Y(async()=>{await T(),await w()}),(l,t)=>(r(),n("div",Qe,[e("div",We,[e("div",Ke,[e("div",Xe,[t[7]||(t[7]=q('<div class="flex items-center gap-3 sm:gap-4 min-w-0 flex-1"><div class="w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg flex-shrink-0"><i class="fas fa-user-check text-white text-xl sm:text-2xl"></i></div><div class="min-w-0 flex-1"><h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-white mb-1 truncate">Inscriptions aux √âv√©nements</h2><p class="text-blue-100 text-xs sm:text-sm font-medium truncate">G√©rez et suivez toutes les inscriptions</p></div></div>',1)),e("div",Ze,[e("div",et,[t[5]||(t[5]=e("div",{class:"text-xs text-blue-100 font-medium mb-0.5"},"Total",-1)),e("div",tt,o(b.value.length),1)]),e("div",st,[t[6]||(t[6]=e("div",{class:"text-xs text-blue-100 font-medium mb-0.5"},"En attente",-1)),e("div",lt,o(R.value),1)])])]),e("div",at,[e("div",ot,[t[10]||(t[10]=e("label",{class:"block text-xs font-semibold text-blue-100 mb-2"},"Filtrer par √©v√©nement",-1)),e("div",rt,[t[9]||(t[9]=e("i",{class:"fas fa-calendar-alt absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-200 text-sm z-10"},null,-1)),D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>x.value=s),onChange:w,class:"w-full pl-10 pr-4 py-2.5 bg-white/90 backdrop-blur-sm border border-white/30 rounded-xl text-gray-900 font-medium text-sm focus:ring-2 focus:ring-white/50 focus:border-white transition-all shadow-sm appearance-none"},[t[8]||(t[8]=e("option",{value:""},"Tous les √©v√©nements",-1)),(r(!0),n(U,null,G(g.value,s=>(r(),n("option",{key:s.id,value:s.id},o(A(s.title,30)),9,nt))),128))],544),[[B,x.value]])])]),e("div",it,[t[13]||(t[13]=e("label",{class:"block text-xs font-semibold text-blue-100 mb-2"},"Filtrer par statut",-1)),e("div",dt,[t[12]||(t[12]=e("i",{class:"fas fa-filter absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-200 text-sm z-10"},null,-1)),D(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),onChange:w,class:"w-full pl-10 pr-4 py-2.5 bg-white/90 backdrop-blur-sm border border-white/30 rounded-xl text-gray-900 font-medium text-sm focus:ring-2 focus:ring-white/50 focus:border-white transition-all shadow-sm appearance-none"},[...t[11]||(t[11]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"pending"},"En attente",-1),e("option",{value:"confirmed"},"Confirm√©",-1),e("option",{value:"cancelled"},"Annul√©",-1)])],544),[[B,m.value]])])])])])]),d.value?(r(),n("div",ut,[e("div",ct,[t[14]||(t[14]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(d.value),1)])])):v("",!0),h.value?(r(),n("div",pt,[...t[15]||(t[15]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des inscriptions...",-1)])])):(r(),n("div",mt,[e("div",gt,[e("table",vt,[t[27]||(t[27]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-indigo-600"},[e("tr",null,[e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-user text-xs sm:text-sm"}),e("span",{class:"hidden sm:inline"},"Participant"),e("span",{class:"sm:hidden"},"Part.")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-envelope text-xs sm:text-sm"}),e("span",null,"Contact")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap hidden md:table-cell"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-building text-xs sm:text-sm"}),e("span",null,"Organisation")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-calendar-alt text-xs sm:text-sm"}),e("span",{class:"hidden lg:inline"},"√âv√©nement"),e("span",{class:"lg:hidden"},"√âv√©n.")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center justify-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-info-circle text-xs sm:text-sm"}),e("span",null,"Statut")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap hidden lg:table-cell"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-clock text-xs sm:text-sm"}),e("span",null,"Date")])]),e("th",{class:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-bold text-white uppercase tracking-wider whitespace-nowrap"},[e("div",{class:"flex items-center justify-center gap-1.5 sm:gap-2"},[e("i",{class:"fas fa-cog text-xs sm:text-sm"}),e("span",{class:"hidden sm:inline"},"Actions")])])])],-1)),e("tbody",xt,[(r(!0),n(U,null,G(b.value,(s,a)=>(r(),n("tr",{key:s.id,class:I(["hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 transition-all duration-200 group",{"bg-gray-50/50":a%2===1}])},[e("td",bt,[e("div",ft,[e("div",yt,o((s.firstName?.[0]||"")+(s.lastName?.[0]||"")),1),e("div",ht,[e("div",wt,o(s.firstName)+" "+o(s.lastName),1),s.position?(r(),n("div",$t,o(s.position),1)):v("",!0)])])]),e("td",_t,[e("div",kt,[e("div",Ct,[t[16]||(t[16]=e("i",{class:"fas fa-envelope text-xs text-gray-400 flex-shrink-0"},null,-1)),e("span",Et,o(s.email),1)]),s.phone?(r(),n("div",Dt,[t[17]||(t[17]=e("i",{class:"fas fa-phone text-xs text-gray-400 flex-shrink-0"},null,-1)),e("span",At,o(s.phone),1)])):(r(),n("div",jt,"-"))])]),e("td",Rt,[e("div",Tt,[t[18]||(t[18]=e("i",{class:"fas fa-building text-gray-400 text-xs sm:text-sm flex-shrink-0"},null,-1)),e("span",St,o(s.organization||"-"),1)])]),e("td",Nt,[e("div",{class:"relative inline-block",onMouseenter:c=>$.value=s.eventId,onMouseleave:t[2]||(t[2]=c=>$.value=null)},[e("div",Ft,[t[19]||(t[19]=e("i",{class:"fas fa-calendar-alt text-blue-600 text-xs flex-shrink-0"},null,-1)),e("span",Vt,o(A(f(s.eventId),16)),1)]),$.value===s.eventId&&f(s.eventId).length>16?(r(),n("div",zt,[F(o(f(s.eventId))+" ",1),t[20]||(t[20]=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1"},[e("div",{class:"border-4 border-transparent border-t-gray-900"})],-1))])):v("",!0)],40,Pt)]),e("td",It,[e("div",Lt,[e("span",{class:I(["px-2 sm:px-3 py-1 sm:py-1.5 rounded-full text-xs font-bold shadow-sm inline-flex items-center gap-1 sm:gap-1.5 whitespace-nowrap",s.status==="confirmed"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":s.status==="cancelled"?"bg-gradient-to-r from-red-500 to-rose-500 text-white":"bg-gradient-to-r from-yellow-400 to-amber-500 text-white"])},[e("i",{class:I(["fas text-xs flex-shrink-0",s.status==="confirmed"?"fa-check-circle":s.status==="cancelled"?"fa-times-circle":"fa-clock"])},null,2),e("span",Mt,o(s.status==="confirmed"?"Confirm√©":s.status==="cancelled"?"Annul√©":"En attente"),1),e("span",Ut,o(s.status==="confirmed"?"OK":s.status==="cancelled"?"Ann.":"Att."),1)],2)])]),e("td",Gt,[e("div",qt,[t[21]||(t[21]=e("i",{class:"fas fa-clock text-gray-400 text-xs flex-shrink-0"},null,-1)),e("span",null,o(k(s.createdAt)),1)])]),e("td",Ot,[e("div",Bt,[s.status!=="confirmed"?(r(),n("button",{key:0,onClick:c=>j(s.id,"confirmed"),disabled:u.value,class:"p-2 sm:p-2.5 text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Confirmer"},[...t[22]||(t[22]=[e("i",{class:"fas fa-check text-xs sm:text-sm"},null,-1)])],8,Jt)):v("",!0),s.status!=="cancelled"?(r(),n("button",{key:1,onClick:c=>j(s.id,"cancelled"),disabled:u.value,class:"p-2 sm:p-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Annuler"},[...t[23]||(t[23]=[e("i",{class:"fas fa-times text-xs sm:text-sm"},null,-1)])],8,Yt)):v("",!0),e("button",{onClick:c=>P(s),class:"p-2 sm:p-2.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-110 hover:shadow-md",title:"Voir les d√©tails"},[...t[24]||(t[24]=[e("i",{class:"fas fa-eye text-xs sm:text-sm"},null,-1)])],8,Ht),e("button",{onClick:c=>V(s.id),disabled:u.value,class:"p-2 sm:p-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 disabled:opacity-50 hover:scale-110 hover:shadow-md",title:"Supprimer"},[...t[25]||(t[25]=[e("i",{class:"fas fa-trash text-xs sm:text-sm"},null,-1)])],8,Qt)])])],2))),128)),b.value.length===0?(r(),n("tr",Wt,[...t[26]||(t[26]=[e("td",{colspan:"7",class:"px-6 py-16 text-center"},[e("div",{class:"flex flex-col items-center gap-3"},[e("div",{class:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center"},[e("i",{class:"fas fa-inbox text-2xl text-gray-400"})]),e("p",{class:"text-gray-500 font-medium"},"Aucune inscription trouv√©e"),e("p",{class:"text-sm text-gray-400"},"Les inscriptions appara√Ætront ici")])],-1)])])):v("",!0)])])])])),i.value?(r(),n("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[4]||(t[4]=W(s=>i.value=null,["self"]))},[e("div",Kt,[e("div",Xt,[e("div",Zt,[t[29]||(t[29]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de l'inscription",-1)),e("button",{onClick:t[3]||(t[3]=s=>i.value=null),class:"p-2 text-gray-400 hover:text-gray-600 rounded-lg transition-colors"},[...t[28]||(t[28]=[e("i",{class:"fas fa-times"},null,-1)])])])]),e("div",es,[e("div",null,[t[30]||(t[30]=e("label",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("p",ts,o(i.value.firstName)+" "+o(i.value.lastName),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("p",ss,o(i.value.email),1)]),i.value.phone?(r(),n("div",ls,[t[32]||(t[32]=e("label",{class:"text-sm font-medium text-gray-600"},"T√©l√©phone",-1)),e("p",as,o(i.value.phone),1)])):v("",!0),i.value.organization?(r(),n("div",os,[t[33]||(t[33]=e("label",{class:"text-sm font-medium text-gray-600"},"Organisation",-1)),e("p",rs,o(i.value.organization),1)])):v("",!0),i.value.position?(r(),n("div",ns,[t[34]||(t[34]=e("label",{class:"text-sm font-medium text-gray-600"},"Poste",-1)),e("p",is,o(i.value.position),1)])):v("",!0),e("div",null,[t[35]||(t[35]=e("label",{class:"text-sm font-medium text-gray-600"},"√âv√©nement",-1)),e("p",ds,o(f(i.value.eventId)),1)]),e("div",null,[t[36]||(t[36]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("span",{class:I(["inline-block px-3 py-1 rounded-full text-xs font-semibold",i.value.status==="confirmed"?"bg-green-100 text-green-800":i.value.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},o(i.value.status==="confirmed"?"Confirm√©":i.value.status==="cancelled"?"Annul√©":"En attente"),3)]),i.value.notes?(r(),n("div",us,[t[37]||(t[37]=e("label",{class:"text-sm font-medium text-gray-600"},"Notes",-1)),e("p",cs,o(i.value.notes),1)])):v("",!0),e("div",null,[t[38]||(t[38]=e("label",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("p",ps,o(k(i.value.createdAt)),1)])])])])):v("",!0)]))}}),gs={class:"space-y-6"},vs={class:"flex items-center justify-between"},xs={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4"},bs={class:"flex items-center gap-2"},fs={key:1,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},ys={class:"text-xl font-bold text-gray-900 mb-6"},hs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ws={key:0,class:"mt-3"},$s=["src"],_s={key:1,class:"mt-3"},ks=["src"],Cs={class:"flex gap-4"},Es=["disabled"],Ds={key:0},As={key:1},js=["disabled"],Rs={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Ts={class:"overflow-x-auto"},Ss={class:"w-full"},Ns={class:"divide-y divide-gray-200"},Ps={key:0},Fs={class:"px-6 py-4"},Vs={class:"font-medium text-gray-900"},zs={class:"px-6 py-4"},Is={class:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium"},Ls={class:"px-6 py-4 text-gray-600"},Ms={class:"px-6 py-4"},Us={class:"flex items-center justify-center gap-2"},Gs=["onClick","disabled"],qs=["onClick","disabled"],Os={key:1},Bs=J({__name:"DashboardActualites",setup(H){const _=p(!1),b=p(null),g=p([]),h=p(null),u=p(null),d=p(!1),x=p(null),m=p({title:"",category:"",publishDate:"",summary:"",content:"",image:"",author:"Admin",readTime:5}),i=p(""),$=p(""),R=p(""),T=l=>{const t=l.target;if(t.files&&t.files[0]){h.value=t.files[0];const s=new FileReader;s.onload=a=>{u.value=a.target?.result},s.readAsDataURL(h.value)}},w=async()=>{d.value=!0,x.value=null;try{console.log("üîÑ Chargement des actualit√©s...");const l=await Z.getActualities({limit:100});console.log("‚úÖ R√©ponse re√ßue:",l),l&&l.data?(console.log(`üìä ${l.data.length} actualit√©(s) charg√©e(s)`),g.value=l.data):(console.warn("‚ö†Ô∏è Aucune donn√©e dans la r√©ponse:",l),g.value=[],x.value="Aucune donn√©e re√ßue du serveur")}catch(l){console.error("‚ùå Erreur compl√®te lors du chargement:",l),console.error("D√©tails:",{message:l.message,status:l.status,errors:l.errors,stack:l.stack}),l.status===500?x.value="Erreur serveur. V√©rifiez que le backend est d√©marr√© et que la base de donn√©es est accessible.":l.status===404?x.value="Endpoint non trouv√©. V√©rifiez la configuration de l'API.":l.status===0||l.message?.includes("fetch")||l.message?.includes("Failed to fetch")?x.value="Impossible de se connecter au serveur. V√©rifiez que le backend est accessible.":x.value=l.message||(l.errors?JSON.stringify(l.errors):"Erreur lors du chargement des actualit√©s"),g.value=[]}finally{d.value=!1}},f=async()=>{d.value=!0,x.value=null;try{const l=i.value.split(`
`).map(c=>c.trim()).filter(c=>c.length>0),t=$.value.split(`
`).map(c=>c.trim()).filter(c=>c.length>0),s=R.value.split(",").map(c=>c.trim()).filter(c=>c.length>0),a={title:m.value.title.trim(),summary:m.value.summary.trim(),content:m.value.content.trim(),category:m.value.category.trim(),publishDate:m.value.publishDate,author:m.value.author.trim(),readTime:m.value.readTime,status:"published",image:m.value.image||"",learningPoints:l,keyPoints:t,tags:s};b.value?await Z.updateActuality(b.value.id,a,h.value||void 0):await Z.createActuality(a,h.value||void 0),await w(),P()}catch(l){if(console.error("Erreur lors de la sauvegarde:",l),x.value=l.message||"Erreur lors de la sauvegarde",l.errors){const t=Object.values(l.errors).flat().join(", ");x.value=`Erreurs de validation: ${t}`}}finally{d.value=!1}},A=l=>{if(!l||typeof l!="string")return"";const t=l.trim();if(!t)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const s=new Date(t);if(isNaN(s.getTime())){const M=t.split("-");if(M.length===3){const z=parseInt(M[0],10),y=parseInt(M[1],10),C=parseInt(M[2],10);if(!isNaN(z)&&!isNaN(y)&&!isNaN(C)){const E=new Date(z,y-1,C);if(E.getFullYear()===z&&E.getMonth()===y-1&&E.getDate()===C)return`${z}-${String(y).padStart(2,"0")}-${String(C).padStart(2,"0")}`}}return""}const a=s.getFullYear(),c=String(s.getMonth()+1).padStart(2,"0"),S=String(s.getDate()).padStart(2,"0");return`${a}-${c}-${S}`}catch(s){return console.warn("Erreur lors de la normalisation de la date:",l,s),""}},j=l=>{try{b.value=l,m.value={title:l.title||"",category:l.category||"",publishDate:A(l.publishDate),summary:l.summary||"",content:l.content||"",image:l.image||"",author:l.author||"Admin",readTime:l.readTime||5},i.value=l.learningPoints?l.learningPoints.join(`
`):"",$.value=l.keyPoints?l.keyPoints.join(`
`):"",R.value=l.tags?l.tags.join(", "):"",h.value=null,u.value=l.image||null,_.value=!0}catch(t){console.error("Erreur lors de l'√©dition de l'actualit√©:",t),x.value="Erreur lors du chargement des donn√©es de l'actualit√©"}},V=async l=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette actualit√© ?")){d.value=!0,x.value=null;try{await Z.deleteActuality(l),await w()}catch(t){console.error("Erreur lors de la suppression:",t),x.value=t.message||"Erreur lors de la suppression"}finally{d.value=!1}}},P=()=>{_.value=!1,b.value=null,h.value=null,u.value=null,i.value="",$.value="",R.value="",m.value={title:"",category:"",publishDate:"",summary:"",content:"",image:"",author:"Admin",readTime:5},x.value=null},k=l=>l?new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A";return Y(()=>{w()}),(l,t)=>(r(),n("div",gs,[e("div",vs,[t[10]||(t[10]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion des Actualit√©s"),e("p",{class:"text-gray-600 mt-1"},"Cr√©ez et g√©rez les actualit√©s du centre")],-1)),e("button",{onClick:t[0]||(t[0]=s=>{_.value=!0,b.value=null}),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...t[9]||(t[9]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nouvelle actualit√©",-1)])])]),x.value?(r(),n("div",xs,[e("div",bs,[t[11]||(t[11]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(x.value),1)]),x.value.includes("serveur")||x.value.includes("connecter")?(r(),n("button",{key:0,onClick:w,class:"mt-3 text-sm text-red-600 hover:text-red-800 underline"}," R√©essayer ")):v("",!0)])):v("",!0),_.value?(r(),n("div",fs,[e("h3",ys,o(b.value?"Modifier l'actualit√©":"Nouvelle actualit√©"),1),e("form",{onSubmit:W(f,["prevent"]),class:"space-y-6"},[e("div",hs,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>m.value.title=s),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de l'actualit√©"},null,512),[[N,m.value.title]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cat√©gorie *",-1)),D(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>m.value.category=s),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[13]||(t[13]=[q('<option value="">S√©lectionnez...</option><option value="Recherche">Recherche</option><option value="Formation">Formation</option><option value="Partenariat">Partenariat</option><option value="√âv√©nement">√âv√©nement</option>',5)])],512),[[B,m.value.category]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image",-1)),e("input",{onChange:T,type:"file",accept:"image/*",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),t[17]||(t[17]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),u.value?(r(),n("div",ws,[e("img",{src:u.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,$s)])):b.value&&m.value.image?(r(),n("div",_s,[e("img",{src:m.value.image,alt:"Image actuelle",class:"w-32 h-32 object-cover rounded-lg border border-gray-200"},null,8,ks),t[15]||(t[15]=e("p",{class:"text-xs text-gray-500 mt-1"},"Image actuelle",-1))])):v("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de publication *",-1)),D(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>m.value.publishDate=s),type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[N,m.value.publishDate]])])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"R√©sum√© *",-1)),D(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>m.value.summary=s),required:"",rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"R√©sum√© de l'actualit√©..."},null,512),[[N,m.value.summary]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contenu *",-1)),D(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>m.value.content=s),required:"",rows:"6",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Contenu complet de l'actualit√©..."},null,512),[[N,m.value.content]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ce que vous apprendrez",-1)),t[22]||(t[22]=e("p",{class:"text-xs text-gray-500 mb-2"},"Ajoutez un point par ligne",-1)),D(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.value=s),rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:`Les derni√®res tendances en mati√®re de financement des PME
Comment pr√©parer un dossier de financement convaincant
Les diff√©rentes sources de financement disponibles
Les erreurs √† √©viter lors de la recherche de financement`},null,512),[[N,i.value]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Points cl√©s √† retenir",-1)),t[24]||(t[24]=e("p",{class:"text-xs text-gray-500 mb-2"},"Ajoutez un point par ligne",-1)),D(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=s=>$.value=s),rows:"4",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:`Comprendre les m√©canismes de financement adapt√©s aux PME
Identifier les opportunit√©s de croissance et de d√©veloppement
Optimiser la gestion financi√®re de votre entreprise
Acc√©der aux ressources et programmes disponibles`},null,512),[[N,$.value]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mots-cl√©s (tags)",-1)),t[26]||(t[26]=e("p",{class:"text-xs text-gray-500 mb-2"},"S√©parez les tags par des virgules",-1)),D(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>R.value=s),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Formation, PME, Financement, RDC"},null,512),[[N,R.value]])]),e("div",Cs,[e("button",{type:"submit",disabled:d.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},[d.value?(r(),n("span",Ds,"Enregistrement...")):(r(),n("span",As,o(b.value?"Modifier":"Cr√©er"),1))],8,Es),e("button",{type:"button",onClick:P,disabled:d.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,js)])],32)])):v("",!0),e("div",Rs,[e("div",Ts,[e("table",Ss,[t[31]||(t[31]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Titre"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Cat√©gorie"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",Ns,[d.value&&g.value.length===0?(r(),n("tr",Ps,[...t[27]||(t[27]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Chargement... ",-1)])])):v("",!0),(r(!0),n(U,null,G(g.value,s=>(r(),n("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Fs,[e("div",Vs,o(s.title),1)]),e("td",zs,[e("span",Is,o(s.category),1)]),e("td",Ls,o(k(s.publishDate)),1),e("td",Ms,[e("div",Us,[e("button",{onClick:a=>j(s),disabled:d.value,class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...t[28]||(t[28]=[e("i",{class:"fas fa-edit"},null,-1)])],8,Gs),e("button",{onClick:a=>V(s.id),disabled:d.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...t[29]||(t[29]=[e("i",{class:"fas fa-trash"},null,-1)])],8,qs)])])]))),128)),!d.value&&g.value.length===0?(r(),n("tr",Os,[...t[30]||(t[30]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Aucune actualit√© pour le moment ",-1)])])):v("",!0)])])])])]))}}),Js={class:"space-y-6"},Ys={class:"flex items-center justify-between"},Hs={key:0,class:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100"},Qs={key:0,class:"mt-3"},Ws=["src"],Ks={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Xs={class:"relative"},Zs={id:"category-list"},el=["value"],tl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},sl={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},ll={class:"flex items-center gap-2"},al={class:"flex gap-4"},ol=["disabled"],rl={key:0,class:"fas fa-spinner fa-spin"},nl=["disabled"],il={key:1,class:"text-center py-12"},dl={key:2,class:"text-center py-12"},ul={class:"text-gray-600 mb-6"},cl={key:3,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},pl={class:"aspect-square overflow-hidden"},ml=["src","alt"],gl={class:"p-4"},vl={class:"font-medium text-gray-900 mb-1"},xl={class:"text-sm text-gray-500"},bl={key:0,class:"text-xs text-gray-400 mt-1"},fl={class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"},yl=["onClick","disabled"],hl={key:0,class:"col-span-full text-center py-12 text-gray-500"},wl=J({__name:"DashboardGallery",setup(H){const _=te.useToast(),b=p(!1),g=p([]),h=p(null),u=p(null),d=p(!1),x=p(!1),m=p(null),i=p([]),$=p({title:"",description:"",category:"",date:new Date().toISOString().split("T")[0],author:"Admin"}),R=k=>{const l=k.target;if(l.files&&l.files[0]){const t=l.files[0];if(t.size>2*1024*1024){m.value="Le fichier est trop volumineux. Taille maximale: 2MB",l.value="";return}h.value=t,m.value=null;const s=new FileReader;s.onload=a=>{u.value=a.target?.result},s.readAsDataURL(h.value)}},T=async()=>{d.value=!0,m.value=null;try{const k=await X.getPhotos({limit:100});g.value=k.data}catch(k){console.error("Erreur lors du chargement des photos:",k),m.value=k.message||"Erreur lors du chargement de la galerie",g.value=[]}finally{d.value=!1}},w=async()=>{try{const l=(await X.getCategories()).map(a=>a.name||a.id),t=["√âv√©nements","√âquipe","Installations","Collaborations","Formations","Conf√©rences","Ateliers","R√©unions","C√©r√©monies","Activit√©s","Projets","Partenariats"],s=new Set([...t,...l]);i.value=Array.from(s).sort(),i.value.length===0&&(i.value=t)}catch(k){console.error("Erreur lors du chargement des cat√©gories:",k),i.value=["√âv√©nements","√âquipe","Installations","Collaborations","Formations","Conf√©rences","Ateliers","R√©unions","C√©r√©monies","Activit√©s","Projets","Partenariats"]}},f=async()=>{if(!h.value){m.value="Veuillez s√©lectionner une image",_.open({message:"‚ö†Ô∏è Veuillez s√©lectionner une image",type:"warning",position:"top-right",duration:4e3});return}if(!$.value.title||!$.value.category){m.value="Veuillez remplir tous les champs obligatoires",_.open({message:"‚ö†Ô∏è Veuillez remplir tous les champs obligatoires",type:"warning",position:"top-right",duration:4e3});return}x.value=!0,m.value=null;try{const k=await X.uploadPhoto(h.value,{title:$.value.title,description:$.value.description||"",category:$.value.category,date:$.value.date,author:$.value.author});g.value.unshift(k),P(),_.open({message:"‚úÖ Photo ajout√©e √† la galerie avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(k){console.error("Erreur lors de l'ajout de la photo:",k);const l=k.message||"Erreur lors de l'ajout de la photo";m.value=l,_.open({message:`‚ùå ${l}`,type:"error",position:"top-right",duration:6e3})}finally{x.value=!1}},A=async k=>{if(k&&confirm("√ätes-vous s√ªr de vouloir supprimer cette photo ?")){x.value=!0,m.value=null;try{await X.deletePhoto(k),g.value=g.value.filter(l=>l.id!==k),_.open({message:"‚úÖ Photo supprim√©e de la galerie avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-stats"))}catch(l){console.error("Erreur lors de la suppression de la photo:",l);const t=l.message||"Erreur lors de la suppression de la photo";m.value=t,_.open({message:`‚ùå ${t}`,type:"error",position:"top-right",duration:6e3})}finally{x.value=!1}}},j=k=>k&&X.getImageUrl(k)||"https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",V=k=>{if(!k)return"";try{const l=new Date(k);return isNaN(l.getTime())?k:l.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}catch{return k}},P=()=>{b.value=!1,h.value=null,u.value=null,m.value=null,$.value={title:"",description:"",category:"",date:new Date().toISOString().split("T")[0],author:"Admin"}};return Y(async()=>{await w(),await T()}),(k,l)=>(r(),n("div",Js,[e("div",Ys,[l[8]||(l[8]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Gestion de la Galerie"),e("p",{class:"text-gray-600 mt-1"},"Ajoutez et g√©rez les photos de la galerie")],-1)),e("button",{onClick:l[0]||(l[0]=t=>b.value=!0),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"},[...l[7]||(l[7]=[e("i",{class:"fas fa-upload"},null,-1),e("span",null,"Ajouter des photos",-1)])])]),b.value?(r(),n("div",Hs,[l[18]||(l[18]=e("h3",{class:"text-xl font-bold text-gray-900 mb-6"},"Ajouter une photo",-1)),e("form",{onSubmit:W(f,["prevent"]),class:"space-y-6"},[e("div",null,[l[9]||(l[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Image *",-1)),e("input",{onChange:R,type:"file",accept:"image/*",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,32),l[10]||(l[10]=e("p",{class:"text-xs text-gray-500 mt-1"},"Formats accept√©s: JPEG, PNG, JPG, GIF (max 2MB)",-1)),u.value?(r(),n("div",Qs,[e("img",{src:u.value,alt:"Preview",class:"w-48 h-48 object-cover rounded-lg border border-gray-200"},null,8,Ws)])):v("",!0)]),e("div",Ks,[e("div",null,[l[11]||(l[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Titre *",-1)),D(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>$.value.title=t),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Titre de la photo"},null,512),[[N,$.value.title]])]),e("div",null,[l[12]||(l[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cat√©gorie *",-1)),e("div",Xs,[D(e("input",{"onUpdate:modelValue":l[2]||(l[2]=t=>$.value.category=t),type:"text",list:"category-list",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Tapez ou s√©lectionnez une cat√©gorie...",required:""},null,512),[[N,$.value.category]]),e("datalist",Zs,[(r(!0),n(U,null,G(i.value,t=>(r(),n("option",{key:t,value:t},o(t),9,el))),128))])]),l[13]||(l[13]=e("p",{class:"text-xs text-gray-500 mt-1"},"Exemples: √âv√©nements, √âquipe, Installations, Collaborations, Formations, etc.",-1))])]),e("div",null,[l[14]||(l[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),D(e("textarea",{"onUpdate:modelValue":l[3]||(l[3]=t=>$.value.description=t),rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",placeholder:"Description de la photo (optionnel)"},null,512),[[N,$.value.description]])]),e("div",tl,[e("div",null,[l[15]||(l[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date *",-1)),D(e("input",{"onUpdate:modelValue":l[4]||(l[4]=t=>$.value.date=t),type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[N,$.value.date]])]),e("div",null,[l[16]||(l[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Auteur *",-1)),D(e("input",{"onUpdate:modelValue":l[5]||(l[5]=t=>$.value.author=t),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Nom de l'auteur"},null,512),[[N,$.value.author]])])]),m.value?(r(),n("div",sl,[e("div",ll,[l[17]||(l[17]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(m.value),1)])])):v("",!0),e("div",al,[e("button",{type:"submit",disabled:x.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[x.value?(r(),n("i",rl)):v("",!0),e("span",null,o(x.value?"Ajout en cours...":"Ajouter"),1)],8,ol),e("button",{type:"button",onClick:P,disabled:x.value,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 disabled:opacity-50"}," Annuler ",8,nl)])],32)])):v("",!0),d.value&&g.value.length===0?(r(),n("div",il,[...l[19]||(l[19]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement de la galerie...",-1)])])):m.value&&g.value.length===0?(r(),n("div",dl,[l[20]||(l[20]=e("i",{class:"fas fa-exclamation-triangle text-4xl text-red-600 mb-4"},null,-1)),l[21]||(l[21]=e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Erreur",-1)),e("p",ul,o(m.value),1),e("button",{onClick:T,class:"bg-blue-500 hover:bg-blue-600 text-white font-medium px-6 py-3 rounded-lg transition-colors"}," R√©essayer ")])):(r(),n("div",cl,[(r(!0),n(U,null,G(g.value,t=>(r(),n("div",{key:t.id,class:"group relative bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300"},[e("div",pl,[e("img",{src:j(t.image),alt:t.title||"Photo",class:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:l[6]||(l[6]=s=>{s.target.src="https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"})},null,40,ml)]),e("div",gl,[e("h3",vl,o(t.title||"Sans titre"),1),e("p",xl,o(t.category||"Non cat√©goris√©"),1),t.date?(r(),n("p",bl,o(V(t.date)),1)):v("",!0)]),e("div",fl,[e("button",{onClick:s=>A(t.id),class:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",disabled:x.value},[...l[22]||(l[22]=[e("i",{class:"fas fa-trash text-sm"},null,-1)])],8,yl)])]))),128)),!d.value&&g.value.length===0?(r(),n("div",hl,[...l[23]||(l[23]=[e("i",{class:"fas fa-images text-4xl text-gray-300 mb-4"},null,-1),e("p",null,"Aucune photo dans la galerie",-1)])])):v("",!0)]))]))}}),$l={class:"space-y-6"},_l={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},kl={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Cl={class:"flex items-center justify-between"},El={class:"text-2xl font-bold text-gray-900"},Dl={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Al={class:"flex items-center justify-between"},jl={class:"text-2xl font-bold text-gray-900"},Rl={key:0,class:"text-center py-12"},Tl={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},Sl={class:"flex items-center gap-2"},Nl={key:2,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},Pl={class:"p-4 border-b border-gray-200 flex items-center justify-between"},Fl={class:"overflow-x-auto"},Vl={class:"w-full"},zl={class:"divide-y divide-gray-200"},Il={class:"px-6 py-4"},Ll={class:"font-medium text-gray-900"},Ml={class:"px-6 py-4 text-gray-600"},Ul={class:"px-6 py-4 text-center"},Gl={class:"px-6 py-4"},ql={class:"flex items-center justify-center gap-2"},Ol=["onClick"],Bl={key:0},Jl=J({__name:"DashboardNewsletter",setup(H){const _=p(""),b=p([]),g=p(!1),h=p(null),u=L(()=>_.value?b.value.filter(w=>w.email.toLowerCase().includes(_.value.toLowerCase())):b.value),d=L(()=>{const w=new Date,f=new Date(w.getFullYear(),w.getMonth(),1);return b.value.filter(A=>{const j=A.subscribedAt||A.createdAt;return j&&new Date(j)>=f}).length}),x=async()=>{g.value=!0,h.value=null;try{const w=await ae.getAllSubscribers({limit:100,search:_.value||void 0});b.value=w.data,console.log("üìß Newsletter Subscribers charg√©s:",b.value.length)}catch(w){console.error("Erreur lors du chargement des abonn√©s:",w),h.value=w.message||"Erreur lors du chargement des abonn√©s",b.value=[]}finally{g.value=!1}},m=async w=>{if(w&&confirm("√ätes-vous s√ªr de vouloir supprimer cet abonn√© ?"))try{await ae.deleteSubscriber(w),await x(),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(f){console.error("Erreur lors de la suppression:",f),alert("Erreur lors de la suppression: "+(f.message||"Erreur inconnue"))}},i=()=>{const w=b.value.map(V=>V.email).join(`
`),f=new Blob([w],{type:"text/csv"}),A=window.URL.createObjectURL(f),j=document.createElement("a");j.href=A,j.download="newsletter-subscribers.csv",j.click()},$=w=>w?new Date(w).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A",R=w=>({active:"Actif",unsubscribed:"D√©sabonn√©",pending:"En attente"})[w]||w,T=w=>({active:"bg-green-100 text-green-700",unsubscribed:"bg-red-100 text-red-700",pending:"bg-yellow-100 text-yellow-700"})[w]||"bg-gray-100 text-gray-700";return Y(()=>{x()}),(w,f)=>(r(),n("div",$l,[f[12]||(f[12]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Abonn√©s Newsletter"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les abonnements √† la newsletter")],-1)),e("div",_l,[e("div",kl,[e("div",Cl,[e("div",null,[f[1]||(f[1]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total abonn√©s",-1)),e("p",El,o(b.value.length),1)]),f[2]||(f[2]=e("div",{class:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-users text-blue-600 text-xl"})],-1))])]),e("div",Dl,[e("div",Al,[e("div",null,[f[3]||(f[3]=e("p",{class:"text-sm text-gray-600 mb-1"},"Ce mois",-1)),e("p",jl,o(d.value),1)]),f[4]||(f[4]=e("div",{class:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-arrow-up text-green-600 text-xl"})],-1))])]),f[5]||(f[5]=q('<div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600 mb-1">Taux d&#39;ouverture</p><p class="text-2xl font-bold text-gray-900">42%</p></div><div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center"><i class="fas fa-chart-line text-purple-600 text-xl"></i></div></div></div>',1))]),g.value?(r(),n("div",Rl,[...f[6]||(f[6]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des abonn√©s...",-1)])])):h.value?(r(),n("div",Tl,[e("div",Sl,[f[7]||(f[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(h.value),1)])])):(r(),n("div",Nl,[e("div",Pl,[D(e("input",{"onUpdate:modelValue":f[0]||(f[0]=A=>_.value=A),type:"text",placeholder:"Rechercher un email...",onInput:x,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[N,_.value]]),e("button",{onClick:i,class:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[...f[8]||(f[8]=[e("i",{class:"fas fa-download"},null,-1),e("span",null,"Exporter",-1)])])]),e("div",Fl,[e("table",Vl,[f[11]||(f[11]=e("thead",{class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Email"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold"},"Date d'inscription"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Statut"),e("th",{class:"px-6 py-4 text-center text-sm font-semibold"},"Actions")])],-1)),e("tbody",zl,[(r(!0),n(U,null,G(u.value,A=>(r(),n("tr",{key:A.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Il,[e("div",Ll,o(A.email),1)]),e("td",Ml,o($(A.subscribedAt||A.createdAt)),1),e("td",Ul,[e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",T(A.status)])},o(R(A.status)),3)]),e("td",Gl,[e("div",ql,[e("button",{onClick:j=>m(A.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[...f[9]||(f[9]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Ol)])])]))),128)),u.value.length===0?(r(),n("tr",Bl,[...f[10]||(f[10]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," Aucun abonn√© trouv√© ",-1)])])):v("",!0)])])])]))]))}}),Yl={class:"space-y-6"},Hl={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},Ql={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Wl={class:"text-2xl font-bold text-gray-900"},Kl={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Xl={class:"text-2xl font-bold text-yellow-600"},Zl={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},ea={class:"text-2xl font-bold text-green-600"},ta={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},sa={class:"text-2xl font-bold text-blue-600"},la={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},aa={class:"flex items-center gap-2"},oa={key:1,class:"text-center py-12"},ra={key:2,class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},na={key:3,class:"space-y-4"},ia={class:"flex items-start justify-between mb-4"},da={class:"flex-1"},ua={class:"flex items-center gap-3 mb-2"},ca={class:"text-lg font-bold text-gray-900"},pa={class:"text-gray-600 mb-1"},ma={class:"text-gray-600 mb-1"},ga={key:0,class:"text-gray-600 mb-1"},va={class:"text-gray-600"},xa={class:"flex gap-2"},ba=["onClick","disabled"],fa=["onClick","disabled"],ya=["onClick"],ha=["onClick","disabled"],wa={class:"bg-gray-50 rounded-lg p-4"},$a={class:"text-sm text-gray-700"},_a={class:"text-sm text-gray-700 mt-2"},ka={class:"text-sm text-gray-700 mt-2"},Ca={key:0,class:"text-center py-12 text-gray-500"},Ea={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Da={class:"flex items-center justify-between mb-6"},Aa={class:"space-y-4"},ja={class:"text-gray-900"},Ra={class:"text-gray-600 text-sm"},Ta={key:0,class:"text-gray-600 text-sm"},Sa={class:"text-gray-900"},Na={class:"text-gray-600 text-sm"},Pa={class:"text-gray-900 font-semibold"},Fa={class:"text-gray-900 mt-2 whitespace-pre-wrap"},Va={class:"text-gray-900"},za={class:"text-gray-900"},Ia=J({__name:"DashboardFinancing",setup(H){const _=te.useToast(),b=p(""),g=p(""),h=p([]),u=p(null),d=p(!1),x=p(null),m=p(!1),i=L(()=>{let l=h.value;if(g.value&&(l=l.filter(t=>t.status===g.value)),b.value){const t=b.value.toLowerCase();l=l.filter(s=>(s.contactFirstName+" "+s.contactLastName).toLowerCase().includes(t)||s.contactEmail.toLowerCase().includes(t)||s.companyName.toLowerCase().includes(t)||s.projectTitle.toLowerCase().includes(t))}return l}),$=L(()=>h.value.filter(l=>l.status==="submitted"||l.status==="under-review").length),R=L(()=>h.value.filter(l=>l.status==="approved"||l.status==="rejected").length),T=L(()=>h.value.filter(l=>{const t=new Date(l.createdAt||""),s=new Date;return s.setDate(s.getDate()-7),t>=s}).length),w=async()=>{d.value=!0,x.value=null;try{const l=await ee.getRequests({status:g.value||void 0,search:b.value||void 0,limit:100});h.value=l.data}catch(l){console.error("Erreur lors du chargement des demandes:",l),x.value=l.message||"Erreur lors du chargement des demandes",h.value=[]}finally{d.value=!1}},f=l=>{u.value=l},A=async l=>{if(l&&confirm("√ätes-vous s√ªr de vouloir supprimer cette demande ?")){m.value=!0,x.value=null;try{await ee.deleteRequest(l),await w(),_.open({message:"‚úÖ Demande de financement supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t);const s=t.message||"Erreur lors de la suppression";x.value=s,_.open({message:`‚ùå ${s}`,type:"error",position:"top-right",duration:6e3})}finally{m.value=!1}}},j=async(l,t)=>{if(l.id){m.value=!0,x.value=null;try{await ee.updateRequestStatus(l.id,t),await w();const s={approved:"approuv√©e",rejected:"refus√©e","under-review":"mise en r√©vision","on-hold":"mise en attente"};_.open({message:`‚úÖ Demande ${s[t]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(s){console.error("Erreur lors de la mise √† jour:",s);const a=s.message||s.errors?.status?.[0]||"Erreur lors de la mise √† jour du statut";x.value=a,_.open({message:`‚ùå ${a}`,type:"error",position:"top-right",duration:6e3})}finally{m.value=!1}}},V=l=>({draft:"Brouillon",submitted:"Soumise","under-review":"En r√©vision",approved:"Approuv√©e",rejected:"Refus√©e","on-hold":"En attente"})[l]||l,P=l=>({draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700","under-review":"bg-blue-100 text-blue-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700","on-hold":"bg-orange-100 text-orange-700"})[l]||"bg-gray-100 text-gray-700",k=l=>l?new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return Y(()=>{w()}),(l,t)=>(r(),n("div",Yl,[t[29]||(t[29]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Demandes de Financement"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les demandes de financement re√ßues")],-1)),e("div",Hl,[e("div",Ql,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",Wl,o(h.value.length),1)]),e("div",Kl,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",Xl,o($.value),1)]),e("div",Zl,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"Trait√©es",-1)),e("p",ea,o(R.value),1)]),e("div",ta,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Nouvelles",-1)),e("p",sa,o(T.value),1)])]),x.value?(r(),n("div",la,[e("div",aa,[t[8]||(t[8]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(x.value),1)])])):v("",!0),d.value?(r(),n("div",oa,[...t[9]||(t[9]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des demandes...",-1)])])):(r(),n("div",ra,[D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),onChange:w,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[10]||(t[10]=[q('<option value="">Tous les statuts</option><option value="submitted">Soumise</option><option value="under-review">En r√©vision</option><option value="approved">Approuv√©e</option><option value="rejected">Refus√©e</option><option value="on-hold">En attente</option>',6)])],544),[[B,g.value]]),D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>b.value=s),onInput:w,type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[N,b.value]])])),d.value?v("",!0):(r(),n("div",na,[(r(!0),n(U,null,G(i.value,s=>(r(),n("div",{key:s.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",ia,[e("div",da,[e("div",ua,[e("h3",ca,o(s.contactFirstName)+" "+o(s.contactLastName),1),e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",P(s.status)])},o(V(s.status)),3)]),e("p",pa,[t[11]||(t[11]=e("i",{class:"fas fa-building mr-2"},null,-1)),F(o(s.companyName),1)]),e("p",ma,[t[12]||(t[12]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(o(s.contactEmail),1)]),s.contactPhone?(r(),n("p",ga,[t[13]||(t[13]=e("i",{class:"fas fa-phone mr-2"},null,-1)),F(o(s.contactPhone),1)])):v("",!0),e("p",va,[t[14]||(t[14]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(o(k(s.createdAt)),1)])]),e("div",xa,[s.status!=="approved"?(r(),n("button",{key:0,onClick:a=>j(s,"approved"),disabled:m.value,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Approuver"},[...t[15]||(t[15]=[e("i",{class:"fas fa-check"},null,-1)])],8,ba)):v("",!0),s.status!=="rejected"?(r(),n("button",{key:1,onClick:a=>j(s,"rejected"),disabled:m.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Rejeter"},[...t[16]||(t[16]=[e("i",{class:"fas fa-times"},null,-1)])],8,fa)):v("",!0),e("button",{onClick:a=>f(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Voir les d√©tails"},[...t[17]||(t[17]=[e("i",{class:"fas fa-eye"},null,-1)])],8,ya),e("button",{onClick:a=>A(s.id),disabled:m.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...t[18]||(t[18]=[e("i",{class:"fas fa-trash"},null,-1)])],8,ha)])]),e("div",wa,[e("p",$a,[t[19]||(t[19]=e("strong",null,"Projet:",-1)),F(" "+o(s.projectTitle),1)]),e("p",_a,[t[20]||(t[20]=e("strong",null,"Description:",-1)),F(" "+o(s.projectDescription?.substring(0,200))+o(s.projectDescription&&s.projectDescription.length>200?"...":""),1)]),e("p",ka,[t[21]||(t[21]=e("strong",null,"Montant demand√©:",-1)),F(" "+o(s.requestedAmount)+" "+o(s.currency),1)])])]))),128)),i.value.length===0?(r(),n("div",Ca," Aucune demande trouv√©e ")):v("",!0)])),u.value?(r(),n("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t[3]||(t[3]=W(s=>u.value=null,["self"]))},[e("div",Ea,[e("div",Da,[t[23]||(t[23]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de la demande",-1)),e("button",{onClick:t[2]||(t[2]=s=>u.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...t[22]||(t[22]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",Aa,[e("div",null,[t[24]||(t[24]=e("label",{class:"text-sm font-medium text-gray-600"},"Contact",-1)),e("p",ja,o(u.value.contactFirstName)+" "+o(u.value.contactLastName),1),e("p",Ra,o(u.value.contactEmail),1),u.value.contactPhone?(r(),n("p",Ta,o(u.value.contactPhone),1)):v("",!0)]),e("div",null,[t[25]||(t[25]=e("label",{class:"text-sm font-medium text-gray-600"},"Entreprise",-1)),e("p",Sa,o(u.value.companyName),1),e("p",Na,o(u.value.address)+", "+o(u.value.city)+", "+o(u.value.country),1)]),e("div",null,[t[26]||(t[26]=e("label",{class:"text-sm font-medium text-gray-600"},"Projet",-1)),e("p",Pa,o(u.value.projectTitle),1),e("p",Fa,o(u.value.projectDescription),1)]),e("div",null,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Montant demand√©",-1)),e("p",Va,o(u.value.requestedAmount)+" "+o(u.value.currency),1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Date",-1)),e("p",za,o(k(u.value.createdAt)),1)])])])])):v("",!0)]))}}),La={class:"space-y-6"},Ma={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},Ua={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Ga={class:"text-2xl font-bold text-gray-900"},qa={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Oa={class:"text-2xl font-bold text-yellow-600"},Ba={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Ja={class:"text-2xl font-bold text-green-600"},Ya={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Ha={class:"text-2xl font-bold text-blue-600"},Qa={class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},Wa={key:0,class:"text-center py-12"},Ka={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},Xa={class:"flex items-center gap-2"},Za={key:2,class:"space-y-4"},eo={class:"flex items-start justify-between mb-4"},to={class:"flex-1"},so={class:"flex items-center gap-3 mb-2"},lo={class:"text-lg font-bold text-gray-900"},ao={class:"text-gray-600 mb-1"},oo={key:0,class:"text-gray-600 mb-1"},ro={class:"text-gray-600 mb-1"},no={class:"text-gray-600"},io={class:"flex gap-2"},uo=["onClick"],co=["onClick"],po=["onClick"],mo={key:0,class:"bg-gray-50 rounded-lg p-4"},go={class:"text-sm text-gray-700"},vo={key:0,class:"text-center py-12 text-gray-500"},xo={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},bo={class:"flex items-center justify-between mb-6"},fo={class:"space-y-4"},yo={class:"text-gray-900"},ho={class:"text-gray-900"},wo={key:0},$o={class:"text-gray-900"},_o={class:"text-gray-900"},ko={key:1},Co={class:"text-gray-900 whitespace-pre-wrap"},Eo={class:"text-gray-900"},Do={class:"text-gray-900"},Ao=J({__name:"DashboardTraining",setup(H){const _=p(""),b=p(""),g=p(""),h=p([]),u=p(null),d=p(!1),x=p(null),m=L(()=>{let l=h.value;if(b.value&&(l=l.filter(t=>t.status===b.value)),g.value&&(l=l.filter(t=>t.program===g.value)),_.value){const t=_.value.toLowerCase();l=l.filter(s=>s.name.toLowerCase().includes(t)||s.email.toLowerCase().includes(t))}return l}),i=L(()=>h.value.filter(l=>l.status==="pending").length),$=L(()=>h.value.filter(l=>l.status==="confirmed").length),R=L(()=>h.value.filter(l=>{const t=new Date(l.registrationDate||""),s=new Date;return s.setDate(s.getDate()-7),t>=s}).length),T=async()=>{d.value=!0,x.value=null;try{const l=await le.getRegistrations({status:b.value||void 0,program:g.value||void 0,search:_.value||void 0,limit:100});h.value=l.data,console.log("üìö Training Registrations charg√©es:",h.value.length)}catch(l){console.error("Erreur lors du chargement des inscriptions:",l),x.value=l.message||"Erreur lors du chargement des inscriptions",h.value=[]}finally{d.value=!1}},w=l=>{u.value=l},f=async l=>{if(!l.id)return;const t=l.status==="pending"?"confirmed":l.status;try{await le.updateRegistration(l.id,{status:t}),await T(),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(s){console.error("Erreur lors de la mise √† jour du statut:",s),alert("Erreur lors de la mise √† jour du statut: "+(s.message||"Erreur inconnue"))}},A=async l=>{if(l&&confirm("√ätes-vous s√ªr de vouloir supprimer cette inscription ?"))try{await le.deleteRegistration(l),await T(),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(t){console.error("Erreur lors de la suppression:",t),alert("Erreur lors de la suppression: "+(t.message||"Erreur inconnue"))}},j=l=>({pending:"En attente",confirmed:"Confirm√©e",cancelled:"Annul√©e",completed:"Termin√©e"})[l]||l,V=l=>({pending:"bg-yellow-100 text-yellow-700",confirmed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",completed:"bg-blue-100 text-blue-700"})[l]||"bg-gray-100 text-gray-700",P=l=>({training1:"Formation en Gestion d'Entreprise",training2:"Accompagnement Personnalis√©",training3:"Formation en Entrepreneuriat",training4:"R√©seautage et Partenariats"})[l]||l,k=l=>l?new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return re([b,g],()=>{T()}),Y(()=>{T()}),(l,t)=>(r(),n("div",La,[t[30]||(t[30]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Inscriptions aux Formations"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les inscriptions aux formations d'entrepreneurs")],-1)),e("div",Ma,[e("div",Ua,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",Ga,o(h.value.length),1)]),e("div",qa,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",Oa,o(i.value),1)]),e("div",Ba,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"Confirm√©es",-1)),e("p",Ja,o($.value),1)]),e("div",Ya,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600 mb-1"},"Nouvelles",-1)),e("p",Ha,o(R.value),1)])]),e("div",Qa,[D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>b.value=s),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[9]||(t[9]=[q('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="confirmed">Confirm√©e</option><option value="cancelled">Annul√©e</option><option value="completed">Termin√©e</option>',5)])],512),[[B,b.value]]),D(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...t[10]||(t[10]=[q('<option value="">Tous les programmes</option><option value="training1">Formation en Gestion d&#39;Entreprise</option><option value="training2">Accompagnement Personnalis√©</option><option value="training3">Formation en Entrepreneuriat</option><option value="training4">R√©seautage et Partenariats</option>',5)])],512),[[B,g.value]]),D(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>_.value=s),type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,512),[[N,_.value]])]),d.value?(r(),n("div",Wa,[...t[11]||(t[11]=[e("i",{class:"fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des inscriptions...",-1)])])):x.value?(r(),n("div",Ka,[e("div",Xa,[t[12]||(t[12]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(x.value),1)])])):(r(),n("div",Za,[(r(!0),n(U,null,G(m.value,s=>(r(),n("div",{key:s.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",eo,[e("div",to,[e("div",so,[e("h3",lo,o(s.name),1),e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",V(s.status)])},o(j(s.status)),3)]),e("p",ao,[t[13]||(t[13]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(o(s.email),1)]),s.phone?(r(),n("p",oo,[t[14]||(t[14]=e("i",{class:"fas fa-phone mr-2"},null,-1)),F(o(s.phone),1)])):v("",!0),e("p",ro,[t[15]||(t[15]=e("i",{class:"fas fa-graduation-cap mr-2"},null,-1)),F(o(P(s.program)),1)]),e("p",no,[t[16]||(t[16]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(o(k(s.registrationDate)),1)])]),e("div",io,[e("button",{onClick:a=>w(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[...t[17]||(t[17]=[e("i",{class:"fas fa-eye"},null,-1)])],8,uo),e("button",{onClick:a=>f(s),class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"},[...t[18]||(t[18]=[e("i",{class:"fas fa-check"},null,-1)])],8,co),e("button",{onClick:a=>A(s.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[...t[19]||(t[19]=[e("i",{class:"fas fa-trash"},null,-1)])],8,po)])]),s.message?(r(),n("div",mo,[e("p",go,[t[20]||(t[20]=e("strong",null,"Message:",-1)),F(" "+o(s.message),1)])])):v("",!0)]))),128)),m.value.length===0?(r(),n("div",vo," Aucune inscription trouv√©e ")):v("",!0)])),u.value?(r(),n("div",{key:3,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t[4]||(t[4]=W(s=>u.value=null,["self"]))},[e("div",xo,[e("div",bo,[t[22]||(t[22]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de l'inscription",-1)),e("button",{onClick:t[3]||(t[3]=s=>u.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...t[21]||(t[21]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",fo,[e("div",null,[t[23]||(t[23]=e("label",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("p",yo,o(u.value.name),1)]),e("div",null,[t[24]||(t[24]=e("label",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("p",ho,o(u.value.email),1)]),u.value.phone?(r(),n("div",wo,[t[25]||(t[25]=e("label",{class:"text-sm font-medium text-gray-600"},"T√©l√©phone",-1)),e("p",$o,o(u.value.phone),1)])):v("",!0),e("div",null,[t[26]||(t[26]=e("label",{class:"text-sm font-medium text-gray-600"},"Programme",-1)),e("p",_o,o(P(u.value.program)),1)]),u.value.message?(r(),n("div",ko,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-gray-600"},"Message",-1)),e("p",Co,o(u.value.message),1)])):v("",!0),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("p",Eo,o(k(u.value.registrationDate)),1)]),e("div",null,[t[29]||(t[29]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("p",Do,o(j(u.value.status)),1)])])])])):v("",!0)]))}}),jo={class:"space-y-6"},Ro={class:"grid grid-cols-1 sm:grid-cols-4 gap-4"},To={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},So={class:"text-2xl font-bold text-gray-900"},No={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Po={class:"text-2xl font-bold text-yellow-600"},Fo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Vo={class:"text-2xl font-bold text-green-600"},zo={class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100"},Io={class:"text-2xl font-bold text-blue-600"},Lo={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl"},Mo={class:"flex items-center gap-2"},Uo={key:1,class:"text-center py-12"},Go={key:2,class:"bg-white rounded-xl p-4 shadow-lg border border-gray-100 flex items-center gap-4"},qo={key:3,class:"space-y-4"},Oo={class:"flex items-start justify-between mb-4"},Bo={class:"flex-1"},Jo={class:"flex items-center gap-3 mb-2"},Yo={class:"text-lg font-bold text-gray-900"},Ho={class:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium"},Qo={class:"text-gray-600 mb-1"},Wo={class:"text-gray-600 mb-1"},Ko={key:0,class:"text-gray-600 mb-1"},Xo={class:"text-gray-600"},Zo={class:"flex gap-2"},er=["onClick","disabled"],tr=["onClick","disabled"],sr=["onClick","disabled"],lr=["onClick"],ar=["onClick","disabled"],or={class:"bg-gray-50 rounded-lg p-4"},rr={class:"text-sm text-gray-700 mb-2"},nr={class:"text-sm text-gray-700 mb-2"},ir={class:"text-sm text-gray-700 mb-2"},dr={class:"flex gap-2 mt-3 pt-3 border-t border-gray-200"},ur=["href"],cr={key:1,class:"text-xs text-gray-500"},pr={key:0,class:"text-center py-12 text-gray-500"},mr={class:"bg-white rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto"},gr={class:"flex items-center justify-between mb-6"},vr={class:"space-y-4"},xr={class:"text-gray-900 font-semibold"},br={class:"text-gray-900"},fr={class:"text-gray-900"},yr={class:"text-gray-900"},hr={class:"text-gray-900 whitespace-pre-wrap"},wr={key:0},$r={class:"text-gray-900"},_r={class:"text-gray-900"},kr={class:"text-gray-600 text-sm"},Cr={key:0,class:"text-gray-600 text-sm"},Er={key:1,class:"text-gray-600 text-sm"},Dr={key:1},Ar={class:"text-gray-900 whitespace-pre-wrap"},jr={class:"text-gray-900"},Rr={class:"text-gray-900"},Tr={class:"border-t border-gray-200 pt-4 mt-4"},Sr={class:"space-y-3"},Nr=["href"],Pr={key:1,class:"text-sm text-gray-500"},Fr={key:0},Vr=["src","alt"],zr=["href"],Ir={key:1,class:"text-sm text-gray-500"},Lr=J({__name:"DashboardPublications",setup(H){const _=te.useToast(),b=p(""),g=p(""),h=p(""),u=p([]),d=p(null),x=p(!1),m=p(null),i=p(!1),$=L(()=>{let s=u.value;if(g.value&&(s=s.filter(a=>a.status===g.value)),h.value&&(s=s.filter(a=>a.type===h.value)),b.value){const a=b.value.toLowerCase();s=s.filter(c=>c.name.toLowerCase().includes(a)||c.email.toLowerCase().includes(a)||c.title.toLowerCase().includes(a))}return s}),R=L(()=>u.value.filter(s=>s.status==="pending").length),T=L(()=>u.value.filter(s=>s.status==="accepted").length),w=L(()=>u.value.filter(s=>s.status==="published").length),f=async()=>{x.value=!0,m.value=null;try{const s=await se.getRequests({status:g.value||void 0,type:h.value||void 0,search:b.value||void 0,limit:100});u.value=s.data}catch(s){console.error("Erreur lors du chargement des demandes:",s),m.value=s.message||"Erreur lors du chargement des demandes",u.value=[]}finally{x.value=!1}},A=s=>{d.value=s},j=async(s,a)=>{if(s.id){i.value=!0,m.value=null;try{await se.updateRequestStatus(s.id,a),await f();const c={accepted:"accept√©e",rejected:"refus√©e",published:"publi√©e"};_.open({message:`‚úÖ Demande ${c[a]||"mise √† jour"} avec succ√®s !`,type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(c){console.error("Erreur lors de la mise √† jour:",c);const S=c.message||c.errors?.status?.[0]||"Erreur lors de la mise √† jour du statut";m.value=S,_.open({message:`‚ùå ${S}`,type:"error",position:"top-right",duration:6e3})}finally{i.value=!1}}},V=async s=>{if(s&&confirm("√ätes-vous s√ªr de vouloir supprimer cette demande ?")){i.value=!0,m.value=null;try{await se.deleteRequest(s),await f(),_.open({message:"‚úÖ Demande de publication supprim√©e avec succ√®s !",type:"success",position:"top-right",duration:5e3}),window.dispatchEvent(new CustomEvent("dashboard:update-notifications"))}catch(a){console.error("Erreur lors de la suppression:",a);const c=a.message||"Erreur lors de la suppression";m.value=c,_.open({message:`‚ùå ${c}`,type:"error",position:"top-right",duration:6e3})}finally{i.value=!1}}},P=s=>({pending:"En attente","under-review":"En r√©vision",accepted:"Accept√©e",rejected:"Refus√©e",published:"Publi√©e"})[s]||s,k=s=>({pending:"bg-yellow-100 text-yellow-700","under-review":"bg-blue-100 text-blue-700",accepted:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",published:"bg-purple-100 text-purple-700"})[s]||"bg-gray-100 text-gray-700",l=s=>({article:"Article","research-paper":"Document de recherche",book:"Livre",report:"Rapport",other:"Autre"})[s]||s,t=s=>s?new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return Y(()=>{f()}),(s,a)=>(r(),n("div",jo,[a[44]||(a[44]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"Demandes de Publication"),e("p",{class:"text-gray-600 mt-1"},"G√©rez les demandes de publication d'articles")],-1)),e("div",Ro,[e("div",To,[a[6]||(a[6]=e("p",{class:"text-sm text-gray-600 mb-1"},"Total",-1)),e("p",So,o(u.value.length),1)]),e("div",No,[a[7]||(a[7]=e("p",{class:"text-sm text-gray-600 mb-1"},"En attente",-1)),e("p",Po,o(R.value),1)]),e("div",Fo,[a[8]||(a[8]=e("p",{class:"text-sm text-gray-600 mb-1"},"Accept√©es",-1)),e("p",Vo,o(T.value),1)]),e("div",zo,[a[9]||(a[9]=e("p",{class:"text-sm text-gray-600 mb-1"},"Publi√©es",-1)),e("p",Io,o(w.value),1)])]),m.value?(r(),n("div",Lo,[e("div",Mo,[a[10]||(a[10]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,o(m.value),1)])])):v("",!0),x.value?(r(),n("div",Uo,[...a[11]||(a[11]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des demandes...",-1)])])):(r(),n("div",Go,[D(e("select",{"onUpdate:modelValue":a[0]||(a[0]=c=>g.value=c),onChange:f,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...a[12]||(a[12]=[q('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="under-review">En r√©vision</option><option value="accepted">Accept√©e</option><option value="rejected">Refus√©e</option><option value="published">Publi√©e</option>',6)])],544),[[B,g.value]]),D(e("select",{"onUpdate:modelValue":a[1]||(a[1]=c=>h.value=c),onChange:f,class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},[...a[13]||(a[13]=[q('<option value="">Tous les types</option><option value="article">Article</option><option value="research-paper">Document de recherche</option><option value="book">Livre</option><option value="report">Rapport</option><option value="other">Autre</option>',6)])],544),[[B,h.value]]),D(e("input",{"onUpdate:modelValue":a[2]||(a[2]=c=>b.value=c),onInput:f,type:"text",placeholder:"Rechercher...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"},null,544),[[N,b.value]])])),x.value?v("",!0):(r(),n("div",qo,[(r(!0),n(U,null,G($.value,c=>(r(),n("div",{key:c.id,class:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"},[e("div",Oo,[e("div",Bo,[e("div",Jo,[e("h3",Yo,o(c.title),1),e("span",{class:I(["px-3 py-1 rounded-full text-xs font-medium",k(c.status)])},o(P(c.status)),3),e("span",Ho,o(l(c.type)),1)]),e("p",Qo,[a[14]||(a[14]=e("i",{class:"fas fa-user mr-2"},null,-1)),F(o(c.name),1)]),e("p",Wo,[a[15]||(a[15]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),F(o(c.email),1)]),c.institution?(r(),n("p",Ko,[a[16]||(a[16]=e("i",{class:"fas fa-university mr-2"},null,-1)),F(o(c.institution),1)])):v("",!0),e("p",Xo,[a[17]||(a[17]=e("i",{class:"fas fa-calendar mr-2"},null,-1)),F(o(t(c.submissionDate)),1)])]),e("div",Zo,[c.status!=="accepted"?(r(),n("button",{key:0,onClick:S=>j(c,"accepted"),disabled:i.value,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Accepter"},[...a[18]||(a[18]=[e("i",{class:"fas fa-check"},null,-1)])],8,er)):v("",!0),c.status!=="rejected"?(r(),n("button",{key:1,onClick:S=>j(c,"rejected"),disabled:i.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Rejeter"},[...a[19]||(a[19]=[e("i",{class:"fas fa-times"},null,-1)])],8,tr)):v("",!0),c.status==="accepted"?(r(),n("button",{key:2,onClick:S=>j(c,"published"),disabled:i.value,class:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors disabled:opacity-50",title:"Publier"},[...a[20]||(a[20]=[e("i",{class:"fas fa-check-double"},null,-1)])],8,sr)):v("",!0),e("button",{onClick:S=>A(c),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Voir les d√©tails"},[...a[21]||(a[21]=[e("i",{class:"fas fa-eye"},null,-1)])],8,lr),e("button",{onClick:S=>V(c.id),disabled:i.value,class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Supprimer"},[...a[22]||(a[22]=[e("i",{class:"fas fa-trash"},null,-1)])],8,ar)])]),e("div",or,[e("p",rr,[a[23]||(a[23]=e("strong",null,"Auteurs:",-1)),F(" "+o(c.authors),1)]),e("p",nr,[a[24]||(a[24]=e("strong",null,"Domaines:",-1)),F(" "+o(c.domains.join(", ")),1)]),e("p",ir,[a[25]||(a[25]=e("strong",null,"R√©sum√©:",-1)),F(" "+o(c.abstract?.substring(0,200))+o(c.abstract&&c.abstract.length>200?"...":""),1)]),e("div",dr,[c.documentFileUrl||c.document_file_url?(r(),n("a",{key:0,href:c.documentFileUrl||c.document_file_url,target:"_blank",class:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 transition-colors"},[...a[26]||(a[26]=[e("i",{class:"fas fa-file-pdf"},null,-1),e("span",null,"T√©l√©charger le document",-1)])],8,ur)):(r(),n("span",cr,"Aucun document"))])])]))),128)),$.value.length===0?(r(),n("div",pr," Aucune demande trouv√©e ")):v("",!0)])),d.value?(r(),n("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:a[5]||(a[5]=W(c=>d.value=null,["self"]))},[e("div",mr,[e("div",gr,[a[28]||(a[28]=e("h3",{class:"text-2xl font-bold text-gray-900"},"D√©tails de la demande",-1)),e("button",{onClick:a[3]||(a[3]=c=>d.value=null),class:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"},[...a[27]||(a[27]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",vr,[e("div",null,[a[29]||(a[29]=e("label",{class:"text-sm font-medium text-gray-600"},"Titre du travail",-1)),e("p",xr,o(d.value.title),1)]),e("div",null,[a[30]||(a[30]=e("label",{class:"text-sm font-medium text-gray-600"},"Auteurs",-1)),e("p",br,o(d.value.authors),1)]),e("div",null,[a[31]||(a[31]=e("label",{class:"text-sm font-medium text-gray-600"},"Type",-1)),e("p",fr,o(l(d.value.type)),1)]),e("div",null,[a[32]||(a[32]=e("label",{class:"text-sm font-medium text-gray-600"},"Domaines de recherche",-1)),e("p",yr,o(d.value.domains.join(", ")),1)]),e("div",null,[a[33]||(a[33]=e("label",{class:"text-sm font-medium text-gray-600"},"R√©sum√©",-1)),e("p",hr,o(d.value.abstract),1)]),d.value.keywords?(r(),n("div",wr,[a[34]||(a[34]=e("label",{class:"text-sm font-medium text-gray-600"},"Mots-cl√©s",-1)),e("p",$r,o(d.value.keywords),1)])):v("",!0),e("div",null,[a[35]||(a[35]=e("label",{class:"text-sm font-medium text-gray-600"},"Auteur principal",-1)),e("p",_r,o(d.value.name),1),e("p",kr,o(d.value.email),1),d.value.institution?(r(),n("p",Cr,o(d.value.institution),1)):v("",!0),d.value.position?(r(),n("p",Er,o(d.value.position),1)):v("",!0)]),d.value.message?(r(),n("div",Dr,[a[36]||(a[36]=e("label",{class:"text-sm font-medium text-gray-600"},"Message compl√©mentaire",-1)),e("p",Ar,o(d.value.message),1)])):v("",!0),e("div",null,[a[37]||(a[37]=e("label",{class:"text-sm font-medium text-gray-600"},"Date de soumission",-1)),e("p",jr,o(t(d.value.submissionDate)),1)]),e("div",null,[a[38]||(a[38]=e("label",{class:"text-sm font-medium text-gray-600"},"Statut",-1)),e("p",Rr,o(P(d.value.status)),1)]),e("div",Tr,[a[43]||(a[43]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Fichiers",-1)),e("div",Sr,[e("div",null,[a[40]||(a[40]=e("label",{class:"text-sm font-medium text-gray-600 mb-2 block"},"Document (PDF/Word)",-1)),d.value.documentFileUrl||d.value.document_file_url?(r(),n("a",{key:0,href:d.value.documentFileUrl||d.value.document_file_url,target:"_blank",class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors"},[...a[39]||(a[39]=[e("i",{class:"fas fa-file-pdf"},null,-1),e("span",null,"T√©l√©charger le document",-1),e("i",{class:"fas fa-external-link-alt text-xs"},null,-1)])],8,Nr)):(r(),n("p",Pr,"Aucun document disponible"))]),e("div",null,[a[42]||(a[42]=e("label",{class:"text-sm font-medium text-gray-600 mb-2 block"},"Image du document",-1)),d.value.documentImageUrl||d.value.document_image_url?(r(),n("div",Fr,[e("img",{src:d.value.documentImageUrl||d.value.document_image_url,alt:d.value.title,class:"max-w-md rounded-lg border border-gray-200 mb-2",onError:a[4]||(a[4]=c=>c.target.style.display="none")},null,40,Vr),e("a",{href:d.value.documentImageUrl||d.value.document_image_url,target:"_blank",class:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-600 text-white rounded-lg text-xs font-medium hover:bg-gray-700 transition-colors"},[...a[41]||(a[41]=[e("i",{class:"fas fa-download"},null,-1),e("span",null,"T√©l√©charger l'image",-1)])],8,zr)])):(r(),n("p",Ir,"Aucune image disponible"))])])])])])])):v("",!0)]))}}),Mr={class:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50/20"},Ur={class:"flex"},Gr={class:"h-full flex flex-col overflow-y-auto custom-scrollbar"},qr={class:"flex-1 p-4 space-y-1"},Or=["onClick"],Br={key:0,class:"absolute left-0 top-0 bottom-0 w-1 bg-white rounded-r-full"},Jr={class:"font-semibold text-sm tracking-wide flex-1 text-left"},Yr={class:"flex-1 ml-0 lg:ml-72 transition-all duration-500"},Hr={class:"sticky top-0 bg-white/80 backdrop-blur-xl border-b border-slate-200/80 shadow-sm z-30"},Qr={class:"px-4 sm:px-6 lg:px-8 py-5"},Wr={class:"flex items-center justify-between"},Kr={class:"flex items-center gap-4"},Xr={class:"text-2xl font-bold text-slate-900 tracking-tight"},Zr={key:0,class:"p-4 sm:p-6 lg:p-8"},en={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8"},tn={class:"relative"},sn={class:"flex items-center justify-between mb-4"},ln={class:"text-3xl font-bold text-slate-900 mb-1.5 tracking-tight"},an={class:"text-sm font-medium text-slate-600"},on={class:"bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 mb-8"},rn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},nn=["onClick"],dn={class:"w-12 h-12 rounded-xl bg-blue-100 group-hover:bg-blue-600 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-3"},un={class:"font-semibold text-slate-900 group-hover:text-blue-600 transition-colors"},cn={class:"p-4 sm:p-6 lg:p-8"},pn=J({__name:"DashboardView",setup(H){const _=ie(),b=p(!1),g=p("overview"),h=p(0),u=p(0),d=p(0),x=p(0),m=p(0),i=p(0),$=p(0),R=p(0),T=p(0),w=p(0),f=p(0),A=p(0),j=p(0),V=L(()=>[{id:"overview",label:"Vue d'ensemble",icon:"fas fa-home",badge:null},{id:"events",label:"√âv√©nements",icon:"fas fa-calendar-alt",badge:null},{id:"event-registrations",label:"Inscriptions √âv√©nements",icon:"fas fa-user-check",badge:m.value>0?m.value.toString():null},{id:"actualites",label:"Actualit√©s",icon:"fas fa-newspaper",badge:null},{id:"gallery",label:"Galerie",icon:"fas fa-images",badge:null},{id:"newsletter",label:"Newsletter",icon:"fas fa-envelope",badge:h.value>0?h.value.toString():null},{id:"financing",label:"Demandes Financement",icon:"fas fa-hand-holding-usd",badge:u.value>0?u.value.toString():null},{id:"training",label:"Inscriptions Formation",icon:"fas fa-user-graduate",badge:d.value>0?d.value.toString():null},{id:"publications",label:"Demandes Publication",icon:"fas fa-file-alt",badge:x.value>0?x.value.toString():null}]),P=(y,C)=>{if(C===0)return y>0?"+100%":"0%";const E=(y-C)/C*100;return`${E>=0?"+":""}${Math.round(E)}%`},k=L(()=>[{id:"events",label:"√âv√©nements",value:i.value.toString(),change:P(i.value,w.value),icon:"fas fa-calendar-alt",bgColor:"bg-gradient-to-br from-blue-100 to-blue-200",iconColor:"text-blue-600",badgeColor:i.value>=w.value?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"actualites",label:"Actualit√©s",value:$.value.toString(),change:P($.value,f.value),icon:"fas fa-newspaper",bgColor:"bg-gradient-to-br from-indigo-100 to-indigo-200",iconColor:"text-indigo-600",badgeColor:$.value>=f.value?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"messages",label:"Messages",value:T.value.toString(),change:P(T.value,j.value),icon:"fas fa-envelope",bgColor:"bg-gradient-to-br from-purple-100 to-purple-200",iconColor:"text-purple-600",badgeColor:T.value>=j.value?"bg-green-100 text-green-700":"bg-red-100 text-red-700"},{id:"photos",label:"Photos",value:R.value.toString(),change:P(R.value,A.value),icon:"fas fa-images",bgColor:"bg-gradient-to-br from-pink-100 to-pink-200",iconColor:"text-pink-600",badgeColor:R.value>=A.value?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}]),l=p([{id:"1",label:"Nouvel √©v√©nement",icon:"fas fa-plus-circle",section:"events"},{id:"2",label:"Nouvelle actualit√©",icon:"fas fa-plus-circle",section:"actualites"},{id:"3",label:"Ajouter photo",icon:"fas fa-plus-circle",section:"gallery"},{id:"4",label:"Voir messages",icon:"fas fa-envelope",section:"newsletter"}]),t=()=>{const y=V.value.find(C=>C.id===g.value);return y?y.label:"Dashboard"},s=()=>{_.push("/")},a=()=>{window.innerWidth>=1024?b.value=!0:b.value=!1},c=y=>{const C=y.target;window.innerWidth<1024&&b.value&&!C.closest("aside")&&!C.closest("button")&&(b.value=!1)},S=async()=>{try{w.value=i.value,f.value=$.value,A.value=R.value,j.value=T.value;try{const y=await O.getEvents({limit:1e3});i.value=y.pagination?.total||y.data.length}catch(y){console.error("Erreur lors du chargement des √©v√©nements:",y),i.value=0}try{const y=await Z.getActualities({limit:1e3});$.value=y.pagination?.total||y.data.length}catch(y){console.error("Erreur lors du chargement des actualit√©s:",y),$.value=0}try{const y=await X.getPhotos({limit:1e3});R.value=y.pagination?.total||y.data.length}catch(y){console.error("Erreur lors du chargement des photos:",y),R.value=0}try{const y=await ae.getAllSubscribers({limit:1e3});T.value=y.data.length}catch(y){console.error("Erreur lors du chargement des messages:",y),T.value=0}}catch(y){console.error("Erreur lors du chargement des stats:",y)}},M=async()=>{try{try{const y=await ae.getAllSubscribers({status:"active",limit:1e3});h.value=y.data.length}catch(y){console.error("Erreur lors du chargement des newsletters:",y),h.value=0}try{const y=await ee.getRequests({status:"submitted",limit:1e3}),C=await ee.getRequests({status:"under-review",limit:1e3});u.value=y.data.length+C.data.length}catch(y){console.error("Erreur lors du chargement des demandes de financement:",y),u.value=0}try{const y=await le.getRegistrations({status:"pending",limit:1e3});d.value=y.data.length}catch(y){console.error("Erreur lors du chargement des inscriptions aux formations:",y),d.value=0}try{const y=await se.getRequests({status:"pending",limit:1e3});x.value=y.data.length}catch(y){console.error("Erreur lors du chargement des demandes de publication:",y),x.value=0}try{const y=await O.getAllRegistrations({status:"pending",limit:1e3});m.value=y.data.length}catch(y){console.error("Erreur lors du chargement des inscriptions aux √©v√©nements:",y),m.value=0}}catch(y){console.error("Erreur lors du chargement des compteurs:",y)}};let z=null;return Y(async()=>{a(),window.addEventListener("resize",a),document.addEventListener("click",c),await S(),M(),window.addEventListener("dashboard:update-notifications",()=>{M(),S()}),window.addEventListener("dashboard:update-stats",S),z=window.setInterval(()=>{M(),S()},3e4)}),ne(()=>{window.removeEventListener("resize",a),document.removeEventListener("click",c),window.removeEventListener("dashboard:update-notifications",M),window.removeEventListener("dashboard:update-stats",S),z&&clearInterval(z)}),(y,C)=>(r(),n("div",Mr,[e("div",Ur,[e("aside",{class:I(["fixed left-0 top-0 h-screen w-72 bg-gradient-to-b from-white to-slate-50/50 backdrop-blur-2xl border-r border-slate-200/80 shadow-2xl shadow-slate-900/5 z-40 transition-all duration-500 ease-out",{"-translate-x-full lg:translate-x-0":!b.value,"translate-x-0":b.value}])},[e("div",Gr,[C[4]||(C[4]=q('<div class="p-6 pb-4 border-b border-slate-200/60 bg-gradient-to-r from-blue-600/5 to-indigo-600/5" data-v-75b56da7><div class="flex items-center gap-3 mb-2" data-v-75b56da7><div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-500/30" data-v-75b56da7><i class="fas fa-chart-line text-white text-lg" data-v-75b56da7></i></div><div data-v-75b56da7><h2 class="text-xl font-bold text-slate-900 tracking-tight" data-v-75b56da7>Dashboard</h2><p class="text-xs text-slate-500 font-medium" data-v-75b56da7>CReFF-PME</p></div></div></div>',1)),e("nav",qr,[(r(!0),n(U,null,G(V.value,E=>(r(),n("button",{key:E.id,onClick:K=>{g.value=E.id,b.value=!1},class:"w-full group relative"},[e("div",{class:I(["flex items-center gap-3 px-4 py-3.5 rounded-xl transition-all duration-300 relative overflow-hidden",g.value===E.id?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/40 scale-[1.02]":"text-slate-700 hover:bg-slate-100/80 hover:text-blue-600 hover:translate-x-1"])},[g.value===E.id?(r(),n("div",Br)):v("",!0),e("div",{class:I(["w-5 h-5 flex items-center justify-center transition-transform duration-300",g.value===E.id?"scale-110":"group-hover:scale-110"])},[e("i",{class:I([E.icon,"text-base"])},null,2)],2),e("span",Jr,o(E.label),1),E.badge?(r(),n("span",{key:1,class:I(["ml-auto px-2.5 py-1 rounded-full text-xs font-bold min-w-[24px] text-center transition-all duration-300",g.value===E.id?"bg-white/20 text-white backdrop-blur-sm":"bg-red-500 text-white shadow-md shadow-red-500/30 group-hover:scale-110"])},o(E.badge),3)):v("",!0)],2)],8,Or))),128))]),e("div",{class:"p-4 pt-2 border-t border-slate-200/60 bg-gradient-to-t from-slate-50/50 to-transparent"},[C[3]||(C[3]=q('<div class="mb-3 px-4" data-v-75b56da7><div class="flex items-center gap-3 p-3 rounded-xl bg-slate-100/60 border border-slate-200/60" data-v-75b56da7><div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-md" data-v-75b56da7><i class="fas fa-user text-white text-sm" data-v-75b56da7></i></div><div class="flex-1 min-w-0" data-v-75b56da7><p class="text-sm font-semibold text-slate-900 truncate" data-v-75b56da7>Administrateur</p><p class="text-xs text-slate-500 truncate" data-v-75b56da7>creff.pme.uk@gmail.com</p></div></div></div>',1)),e("button",{onClick:s,class:"w-full flex items-center gap-3 px-4 py-3.5 rounded-xl text-slate-700 hover:bg-red-50 hover:text-red-600 transition-all duration-300 group border border-transparent hover:border-red-200"},[...C[2]||(C[2]=[e("div",{class:"w-5 h-5 flex items-center justify-center"},[e("i",{class:"fas fa-sign-out-alt text-base group-hover:translate-x-0.5 transition-transform"})],-1),e("span",{class:"font-semibold text-sm"},"D√©connexion",-1)])])])])],2),b.value?(r(),n("div",{key:0,onClick:C[0]||(C[0]=E=>b.value=!1),class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-30 lg:hidden transition-opacity duration-300"})):v("",!0),e("main",Yr,[e("header",Hr,[e("div",Qr,[e("div",Wr,[e("div",Kr,[e("button",{onClick:C[1]||(C[1]=E=>b.value=!b.value),class:"lg:hidden p-2.5 rounded-xl text-slate-700 hover:bg-slate-100 transition-all duration-200 hover:scale-105"},[...C[5]||(C[5]=[e("i",{class:"fas fa-bars text-lg"},null,-1)])]),e("div",null,[e("h1",Xr,o(t()),1),C[6]||(C[6]=e("p",{class:"text-sm text-slate-500 mt-0.5"},"Gestion et administration",-1))])]),C[7]||(C[7]=q('<div class="flex items-center gap-4" data-v-75b56da7><button class="relative p-2.5 rounded-xl text-slate-600 hover:bg-slate-100 transition-all duration-200 hover:scale-105" data-v-75b56da7><i class="fas fa-bell text-lg" data-v-75b56da7></i><span class="absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white" data-v-75b56da7></span></button><div class="hidden sm:flex items-center gap-3 px-4 py-2 rounded-xl bg-slate-50 border border-slate-200/60" data-v-75b56da7><div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center" data-v-75b56da7><i class="fas fa-user text-white text-xs" data-v-75b56da7></i></div><div data-v-75b56da7><p class="text-sm font-semibold text-slate-900" data-v-75b56da7>Admin</p><p class="text-xs text-slate-500" data-v-75b56da7>En ligne</p></div></div></div>',1))])])]),g.value==="overview"?(r(),n("div",Zr,[e("div",en,[(r(!0),n(U,null,G(k.value,E=>(r(),n("div",{key:E.id,class:"group relative bg-white rounded-2xl p-6 shadow-lg shadow-slate-900/5 border border-slate-200/60 hover:shadow-xl hover:shadow-slate-900/10 hover:-translate-y-1 transition-all duration-300 overflow-hidden"},[C[8]||(C[8]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-transparent to-blue-50/0 group-hover:to-blue-50/30 transition-all duration-300 pointer-events-none"},null,-1)),e("div",tn,[e("div",sn,[e("div",{class:I(["w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transition-transform duration-300 group-hover:scale-110 group-hover:rotate-3",E.bgColor])},[e("i",{class:I([E.icon,E.iconColor,"text-2xl"])},null,2)],2),e("span",{class:I(["text-xs font-bold px-2.5 py-1 rounded-full shadow-sm",E.badgeColor])},o(E.change),3)]),e("h3",ln,o(E.value),1),e("p",an,o(E.label),1)])]))),128))]),e("div",on,[C[9]||(C[9]=e("div",{class:"flex items-center gap-2 mb-6"},[e("div",{class:"w-1 h-6 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full"}),e("h3",{class:"text-xl font-bold text-slate-900"},"Actions rapides")],-1)),e("div",rn,[(r(!0),n(U,null,G(l.value,E=>(r(),n("button",{key:E.id,onClick:K=>g.value=E.section,class:"group flex items-center gap-4 p-5 rounded-xl border-2 border-slate-200 hover:border-blue-500 hover:bg-gradient-to-br hover:from-blue-50 hover:to-indigo-50 transition-all duration-300 hover:shadow-lg hover:shadow-blue-500/10 hover:-translate-y-0.5"},[e("div",dn,[e("i",{class:I([E.icon,"text-blue-600 group-hover:text-white text-lg transition-colors"])},null,2)]),e("span",un,o(E.label),1)],8,nn))),128))])])])):v("",!0),e("div",cn,[g.value==="events"?(r(),Q(He,{key:0})):v("",!0),g.value==="event-registrations"?(r(),Q(ms,{key:1})):v("",!0),g.value==="actualites"?(r(),Q(Bs,{key:2})):v("",!0),g.value==="gallery"?(r(),Q(wl,{key:3})):v("",!0),g.value==="newsletter"?(r(),Q(Jl,{key:4})):v("",!0),g.value==="financing"?(r(),Q(Ia,{key:5})):v("",!0),g.value==="training"?(r(),Q(Ao,{key:6})):v("",!0),g.value==="publications"?(r(),Q(Lr,{key:7})):v("",!0)])])])]))}}),vn=de(pn,[["__scopeId","data-v-75b56da7"]]);export{vn as default};
